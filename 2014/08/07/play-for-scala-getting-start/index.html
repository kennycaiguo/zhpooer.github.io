
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  
    <title>Play for Scala-Getting Start | Poe&#39;s World</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=3, minimum-scale=1">
    
    <meta name="author" content="zhpooer">
    
    <meta name="description" content="What Play is
Play makes you more productive. Play is also a web framework whose HTTP interface is
simple, convenient, flexible, and powerful. Most imp">
    
    
    
    
    <link rel="alternative" href="/atom.xml" title="Poe&#39;s World" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/pacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/pacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>

  <body>
    <header>
      <div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.svg" alt="Poe&#39;s World" title="Poe&#39;s World"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="Poe&#39;s World">Poe&#39;s World</a></h1>
				<h2 class="blog-motto">竹杖芒鞋轻胜马，一蓑烟雨任平生</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">主页</a></li>
					
						<li><a href="/english-monthly">英语角</a></li>
					
						<li><a href="/about">关于</a></li>
					
						<li><a href="/archives">归档</a></li>
					
					<li>
					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="text" id="search" name="q" autocomplete="off" maxlength="20" placeholder="搜索" />
						<input type="hidden" name="q" value="site:zhpooer.github.io">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>

    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2014/08/07/play-for-scala-getting-start/" title="Play for Scala-Getting Start" itemprop="url">Play for Scala-Getting Start</a>
  </h1>
  <p class="article-author">By
    
      <a href="http://zhpooer.github.io" title="zhpooer">zhpooer</a>
    </p>
  <p class="article-time">
    <time datetime="2014-08-07T08:35:31.000Z" itemprop="datePublished">8月 7 2014</time>
    更新日期:<time datetime="2014-08-08T02:03:01.000Z" itemprop="dateModified">8月 8 2014</time>
    
  </p>
</header>
	<div class="article-content">
		
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">文章目录</strong>
		<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#what-play-is"><span class="toc-number">1.</span> <span class="toc-text">What Play is</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#hello-play"><span class="toc-number">2.</span> <span class="toc-text">Hello Play</span></a></li><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#add-an-html-page-template"><span class="toc-number">2.1.</span> <span class="toc-text">Add an HTML page template</span></a></li></ol><li class="toc-item toc-level-1"><a class="toc-link" href="#your-first-play-application"><span class="toc-number">3.</span> <span class="toc-text">Your first Play application</span></a></li><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#getting-started"><span class="toc-number">3.1.</span> <span class="toc-text">Getting started</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#adding-the-model"><span class="toc-number">3.2.</span> <span class="toc-text">Adding the model</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#product-list-page"><span class="toc-number">3.3.</span> <span class="toc-text">Product list page</span></a></li><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#layout-template"><span class="toc-number">3.3.1.</span> <span class="toc-text">Layout template</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#controller-action-method"><span class="toc-number">3.3.2.</span> <span class="toc-text">Controller action method</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#adding-a-routes-configuration"><span class="toc-number">3.3.3.</span> <span class="toc-text">Adding a routes configuration</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#replacing-the-welcome-page-with-a-redirect"><span class="toc-number">3.3.4.</span> <span class="toc-text">Replacing the welcome page with a redirect</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#checking-the-language-localizations"><span class="toc-number">3.3.5.</span> <span class="toc-text">Checking the language localizations</span></a></li></ol><li class="toc-item toc-level-2"><a class="toc-link" href="#details-page"><span class="toc-number">3.4.</span> <span class="toc-text">Details page</span></a></li><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#model-finder-method"><span class="toc-number">3.4.1.</span> <span class="toc-text">Model finder method</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#details-page-template"><span class="toc-number">3.4.2.</span> <span class="toc-text">Details page template</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#additional-message-localizations"><span class="toc-number">3.4.3.</span> <span class="toc-text">Additional message localizations</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#adding-a-parameter-to-a-controller-action"><span class="toc-number">3.4.4.</span> <span class="toc-text">Adding a parameter to a controller action</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#adding-a-parameter-to-a-route"><span class="toc-number">3.4.5.</span> <span class="toc-text">Adding a parameter to a route</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#generating-a-bar-code-image"><span class="toc-number">3.4.6.</span> <span class="toc-text">Generating a bar code image</span></a></li></ol><li class="toc-item toc-level-2"><a class="toc-link" href="#adding-a-new-product"><span class="toc-number">3.5.</span> <span class="toc-text">Adding a new product</span></a></li><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#additional-message-localizations"><span class="toc-number">3.5.1.</span> <span class="toc-text">Additional message localizations</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#form-object"><span class="toc-number">3.5.2.</span> <span class="toc-text">Form object</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#form-template"><span class="toc-number">3.5.3.</span> <span class="toc-text">Form template</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#saving-the-new-product"><span class="toc-number">3.5.4.</span> <span class="toc-text">Saving the new product</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#validating-the-user-input"><span class="toc-number">3.5.5.</span> <span class="toc-text">Validating the user input</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#adding-the-routes-for-saving-products"><span class="toc-number">3.5.6.</span> <span class="toc-text">Adding the routes for saving products</span></a></li></ol>
		</div>
		
		<h1 id="what-play-is">What Play is</h1>
<p>Play makes you more productive. Play is also a web framework whose HTTP interface is
simple, convenient, flexible, and powerful. Most importantly, Play improves on the
most popular non-Java web development languages and frameworks—PHP and Ruby
on Rails—by introducing the advantages of the Java Virtual Machine (JVM).</p>
<h1 id="hello-play">Hello Play</h1>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
</pre></td><td class="code"><pre><span class="keyword">play</span> new hello
<span class="keyword">play</span> run
</pre></td></tr></table></figure>

<p>Files in a new Play application</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="code"><pre><span class="preprocessor">.gitignore</span>
app/controllers/Application<span class="preprocessor">.scala</span>
app/views/index<span class="preprocessor">.scala</span><span class="preprocessor">.html</span>
app/views/main<span class="preprocessor">.scala</span><span class="preprocessor">.html</span>
conf/application<span class="preprocessor">.conf</span>
conf/routes
project/build<span class="preprocessor">.properties</span>
project/Build<span class="preprocessor">.scala</span>
project/plugins<span class="preprocessor">.sbt</span>
public/images/favicon<span class="preprocessor">.png</span>
public/javascripts/jquery-<span class="number">1.7</span><span class="number">.1</span><span class="preprocessor">.min</span><span class="preprocessor">.js</span>
public/stylesheets/main<span class="preprocessor">.css</span>
test/ApplicationSpec<span class="preprocessor">.scala</span>
test/IntegrationSpec<span class="preprocessor">.scala</span>
</pre></td></tr></table></figure>

<p><code>app/controllers/Application.scala</code></p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre><span class="function"><span class="keyword">def</span> </span>index = <span class="constant">Action</span> {
  <span class="constant">Ok</span>(<span class="string">"Hello world"</span>)
}
</pre></td></tr></table></figure>

<p><code>conf/routes</code></p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>GET / controllers<span class="preprocessor">.Application</span><span class="preprocessor">.index</span>()
</pre></td></tr></table></figure>

<p>也可以这样</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
</pre></td><td class="code"><pre><span class="function"><span class="keyword">def</span> </span>hello(<span class="symbol">name:</span> <span class="constant">String</span>) = <span class="constant">Action</span> {
  <span class="constant">Ok</span>(<span class="string">"Hello "</span> + name)
}

/<span class="regexp">/ 访问 http:/</span><span class="regexp">/localhost:9000/hello</span>?n=<span class="constant">Play</span>!
<span class="regexp">//</span> <span class="constant">GET</span> /hello controllers.<span class="constant">Application</span>.hello(<span class="symbol">n:</span> <span class="constant">String</span>)
</pre></td></tr></table></figure>

<h2 id="add-an-html-page-template">Add an HTML page template</h2>
<p><code>app/views/hello.scala.html</code></p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="code"><pre>@(name:String)
<span class="doctype">&lt;!doctype html&gt;</span>
<span class="tag">&lt;<span class="title">html</span>&gt;</span>
  <span class="tag">&lt;<span class="title">head</span>&gt;</span>
    <span class="tag">&lt;<span class="title">meta</span> <span class="attribute">charset</span>=<span class="value">"UTF-8"</span>&gt;</span>
    <span class="tag">&lt;<span class="title">title</span>&gt;</span>Hello<span class="tag">&lt;/<span class="title">title</span>&gt;</span>
  <span class="tag">&lt;/<span class="title">head</span>&gt;</span>
  <span class="tag">&lt;<span class="title">body</span>&gt;</span>
    <span class="tag">&lt;<span class="title">h1</span>&gt;</span>Hello <span class="tag">&lt;<span class="title">em</span>&gt;</span>@name<span class="tag">&lt;/<span class="title">em</span>&gt;</span><span class="tag">&lt;/<span class="title">h1</span>&gt;</span>
  <span class="tag">&lt;/<span class="title">body</span>&gt;</span>
<span class="tag">&lt;/<span class="title">html</span>&gt;</span>
</pre></td></tr></table></figure>

<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre>def hello(name: <span class="keyword">String</span>) = Action <span class="list">{
  Ok(views.html.hello(name))
}</span>
</pre></td></tr></table></figure>

<p><code>sbt console</code></p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>views<span class="preprocessor">.html</span><span class="preprocessor">.hello</span><span class="preprocessor">.render</span>(<span class="string">"Play!"</span>)
</pre></td></tr></table></figure>

<h1 id="your-first-play-application">Your first Play application</h1>
<p>We’ll start with a simple list of products, each of which has a name
and a description.
This is a prototype, with a small number of products, so there isn’t
any functionality for filtering, sorting, or paging the list.</p>
<pre><code>Paperclips Large
  Large Plain Pack of 1000
Zebra Paperclips
  Zebra Length 28mm Assorted 150 Pack
</code></pre><p>To make the product list page work, we’ll need a combination of the following:</p>
<ul>
<li>A view template—A template that generates HTML</li>
<li>A controller action—A Scala function that renders the view</li>
<li>Route configuration—Configuration to map the URL to the action</li>
<li>The model—Scala code that defines the product structure, and some test data</li>
</ul>
<h2 id="getting-started">Getting started</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre>play <span class="literal">new</span> products
rm products/<span class="keyword">public</span>/images/favicon<span class="built_in">.</span>png
rm products/<span class="keyword">public</span>/javascripts/jquery<span class="subst">-</span><span class="number">1.7</span><span class="number">.1</span><span class="built_in">.</span><span class="keyword">min</span><span class="built_in">.</span>js
</pre></td></tr></table></figure>

<p>copying <code>docs/assets/css/bootstrap.css</code> to our
application’s <code>public/stylesheets</code> directory.
Also copy <code>glyphicons-halflings-white.png</code> and <code>glyphicons-halflings.png</code> to
<code>public/img</code></p>
<p><code>main.css</code></p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="code"><pre><span class="tag">body</span> <span class="rules">{ <span class="rule"><span class="attribute">color</span>:<span class="value">black</span></span>; <span class="rule">}</span></span>
<span class="tag">body</span>, <span class="tag">p</span>, <span class="tag">label</span> <span class="rules">{ <span class="rule"><span class="attribute">font-size</span>:<span class="value"><span class="number">15</span>px</span></span>; <span class="rule">}</span></span>
<span class="class">.label</span> <span class="rules">{ <span class="rule"><span class="attribute">font-size</span>:<span class="value"><span class="number">13</span>px</span></span>; <span class="rule"><span class="attribute">line-height</span>:<span class="value"><span class="number">16</span>px</span></span>; <span class="rule">}</span></span>
<span class="class">.alert-info</span> <span class="rules">{ <span class="rule"><span class="attribute">border-color</span>:<span class="value">transparent</span></span>; <span class="rule"><span class="attribute">background-color</span>:<span class="value"><span class="hexcolor">#3A87AD</span></span></span>;
  <span class="rule"><span class="attribute">color</span>:<span class="value">white</span></span>; <span class="rule"><span class="attribute">font-weight</span>:<span class="value">bold</span></span>; <span class="rule">}</span></span>
<span class="tag">div</span><span class="class">.screenshot</span> <span class="rules">{ <span class="rule"><span class="attribute">width</span>:<span class="value"> <span class="number">800</span>px</span></span>; <span class="rule"><span class="attribute">margin</span>:<span class="value"><span class="number">20</span>px</span></span>; <span class="rule"><span class="attribute">background-color</span>:<span class="value"><span class="hexcolor">#D0E7EF</span></span></span>; <span class="rule">}</span></span>
<span class="class">.navbar-fixed-top</span> <span class="class">.navbar-inner</span> <span class="rules">{ <span class="rule"><span class="attribute">padding-left</span>:<span class="value"><span class="number">20</span>px</span></span>; <span class="rule">}</span></span>
<span class="class">.navbar</span> <span class="class">.nav</span> &gt; <span class="tag">li</span> &gt; <span class="tag">a</span> <span class="rules">{ <span class="rule"><span class="attribute">color</span>:<span class="value"><span class="hexcolor">#bbb</span></span></span>; <span class="rule">}</span></span>
<span class="class">.screenshot</span> &gt; <span class="class">.container</span> <span class="rules">{ <span class="rule"><span class="attribute">width</span>:<span class="value"> <span class="number">760</span>px</span></span>; <span class="rule"><span class="attribute">padding</span>:<span class="value"> <span class="number">20</span>px</span></span>; <span class="rule">}</span></span>
<span class="class">.navbar-fixed-top</span>, <span class="class">.navbar-fixed-bottom</span> <span class="rules">{ <span class="rule"><span class="attribute">position</span>:<span class="value">relative</span></span>; <span class="rule">}</span></span>
<span class="tag">h1</span> <span class="rules">{ <span class="rule"><span class="attribute">font-size</span>:<span class="value"><span class="number">125</span>%</span></span>; <span class="rule">}</span></span>
<span class="tag">table</span> <span class="rules">{ <span class="rule"><span class="attribute">border-collapse</span>:<span class="value"> collapse</span></span>; <span class="rule"><span class="attribute">width</span>:<span class="value"><span class="number">100</span>%</span></span>; <span class="rule">}</span></span>
<span class="tag">th</span>, <span class="tag">td</span> <span class="rules">{ <span class="rule"><span class="attribute">text-align</span>:<span class="value">left</span></span>; <span class="rule"><span class="attribute">padding</span>:<span class="value"> <span class="number">0.3</span>em <span class="number">0</span></span></span>;
  <span class="rule"><span class="attribute">border-bottom</span>:<span class="value"> <span class="number">1</span>px solid white</span></span>; <span class="rule">}</span></span>
<span class="tag">tr</span><span class="class">.odd</span> <span class="tag">td</span> <span class="rules">{ <span class="rule">}</span></span>
<span class="tag">form</span> <span class="rules">{ <span class="rule"><span class="attribute">float</span>:<span class="value">left</span></span>; <span class="rule"><span class="attribute">margin-right</span>:<span class="value"> <span class="number">1</span>em</span></span>; <span class="rule">}</span></span>
<span class="tag">legend</span> <span class="rules">{ <span class="rule"><span class="attribute">border</span>:<span class="value"> none</span></span>; <span class="rule">}</span></span>
<span class="tag">fieldset</span> &gt; <span class="tag">div</span> <span class="rules">{ <span class="rule"><span class="attribute">margin</span>:<span class="value"> <span class="number">12</span>px <span class="number">0</span></span></span>; <span class="rule">}</span></span>
<span class="class">.help-block</span> <span class="rules">{ <span class="rule"><span class="attribute">display</span>:<span class="value"> inline</span></span>; <span class="rule"><span class="attribute">vertical-align</span>:<span class="value"> middle</span></span>; <span class="rule">}</span></span>
<span class="class">.error</span> <span class="class">.help-block</span> <span class="rules">{ <span class="rule"><span class="attribute">display</span>:<span class="value"> none</span></span>; <span class="rule">}</span></span>
<span class="class">.error</span> <span class="class">.help-inline</span> <span class="rules">{ <span class="rule"><span class="attribute">padding-left</span>:<span class="value"> <span class="number">9</span>px</span></span>; <span class="rule"><span class="attribute">color</span>:<span class="value"> <span class="hexcolor">#B94A48</span></span></span>; <span class="rule">}</span></span>
<span class="tag">footer</span> <span class="rules">{ <span class="rule"><span class="attribute">clear</span>:<span class="value"> both</span></span>; <span class="rule"><span class="attribute">text-align</span>:<span class="value"> right</span></span>; <span class="rule">}</span></span>
<span class="tag">dl</span><span class="class">.products</span> <span class="rules">{ <span class="rule"><span class="attribute">margin-top</span>:<span class="value"> <span class="number">0</span></span></span>; <span class="rule">}</span></span>
<span class="tag">dt</span> <span class="rules">{ <span class="rule"><span class="attribute">clear</span>:<span class="value"> right</span></span>; <span class="rule">}</span></span>
<span class="class">.barcode</span> <span class="rules">{ <span class="rule"><span class="attribute">float</span>:<span class="value">right</span></span>; <span class="rule"><span class="attribute">margin-bottom</span>:<span class="value"> <span class="number">10</span>px</span></span>; <span class="rule"><span class="attribute">border</span>:<span class="value"> <span class="number">4</span>px solid white</span></span>; <span class="rule">}</span></span>
</pre></td></tr></table></figure>

<p><code>conf/application.conf</code></p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
</pre></td><td class="code"><pre><span class="preprocessor">#  Be sure to use a different secret for your production</span>
<span class="preprocessor">#environment and never check that into your source code repository.</span>
application.secret=<span class="string">"Wd5HkNoRKdJP[kZJ@OV;HGa^&lt;4tDvgSfqn2PJeJnx4l0s77NTl"</span>
<span class="preprocessor"># application.langs="en,es,fr,nl"</span>
application.langs=<span class="string">"en"</span>
</pre></td></tr></table></figure>

<p>If you later want to copy entries from the default <code>application.conf</code> file,
you can find it in <code>$PLAY_HOME/framework/skeletons/scalaskel/conf/.</code></p>
<p>We’ll define in a messages file for each language:</p>
<ul>
<li><code>conf/messages—Default</code> messages for all languages, for messages not localized
for a particular language</li>
<li><code>conf/messages.es—Spanish</code> (which is called Español in Spanish)</li>
<li><code>conf/messages.fr—French</code> (Français in French)</li>
<li><code>conf/messages.nl—Dutch</code> (Nederlands in Dutch)</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
</pre></td><td class="code"><pre><span class="comment"># conf/messages</span>
<span class="type">application</span>.<span class="property">name</span> = Product catalog
<span class="comment"># conf/messages.es</span>
<span class="type">application</span>.<span class="property">name</span> = Catálogo de productos
</pre></td></tr></table></figure>

<h2 id="adding-the-model">Adding the model</h2>
<p>We need to include three things in the example application’s model,</p>
<ul>
<li>A model class—The definition of the product and its attributes</li>
<li>A data access object (DAO)—Code that provides access to product data</li>
<li>Test data—A set of product objects</li>
</ul>
<p><code>app/models/Product.scala</code></p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="code"><pre><span class="keyword">package</span> models
<span class="class"><span class="keyword">case</span> <span class="keyword">class</span> <span class="title">Product</span><span class="params">(ean: Long, name: String, description: String)</span></span>

<span class="class"><span class="keyword">object</span> <span class="title">Product</span> {</span>
  <span class="keyword">var</span> products = Set(Product(<span class="number">5010255079763</span>L, <span class="string">"Paperclips Large"</span>,<span class="string">"Large Plain Pack of 1000"</span>),
    Product(<span class="number">5018206244666</span>L, <span class="string">"Giant Paperclips"</span>,<span class="string">"Giant Plain 51mm 100 pack"</span>),
    Product(<span class="number">5018306332812</span>L, <span class="string">"Paperclip Giant Plain"</span>,<span class="string">"Giant Plain Pack of 10000"</span>),
    Product(<span class="number">5018306312913</span>L, <span class="string">"No Tear Paper Clip"</span>,<span class="string">"No Tear Extra Large Pack of 1000"</span>),
    Product(<span class="number">5018206244611</span>L, <span class="string">"Zebra Paperclips"</span>,<span class="string">"Zebra Length 28mm Assorted 150 Pack"</span>)
  )
  <span class="keyword">def</span> findAll = products.toList.sortBy(_.ean)
}
</pre></td></tr></table></figure>

<h2 id="product-list-page">Product list page</h2>
<p><code>app/views/products/list.scala.html</code></p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="code"><pre><span class="xml"><span class="tag">&lt;!<span class="attribute">--</span> <span class="attribute">The</span> <span class="attribute">implicit</span> <span class="attribute">Lang</span> <span class="attribute">parameter</span> <span class="attribute">is</span> <span class="attribute">used</span> <span class="attribute">for</span> <span class="attribute">the</span> <span class="attribute">localized</span> <span class="attribute">message</span> <span class="attribute">--</span>&gt;</span>
<span class="comment">&lt;!-- lookup performed by the Messages object. --&gt;</span>
@(products: List[Product])(implicit lang: Lang)
@main(Messages("application.name")) {
  <span class="tag">&lt;<span class="title">dl</span> <span class="attribute">class</span>=<span class="value">"products"</span>&gt;</span>
  @for(product <span class="tag">&lt;<span class="title">-</span> <span class="attribute">products</span>) {
    &lt;<span class="attribute">dt</span>&gt;</span>@product.name<span class="tag">&lt;/<span class="title">dt</span>&gt;</span>
    <span class="tag">&lt;<span class="title">dd</span>&gt;</span>@product.description<span class="tag">&lt;/<span class="title">dd</span>&gt;</span>
  }
  <span class="tag">&lt;/<span class="title">dl</span>&gt;</span>
}</span>
</pre></td></tr></table></figure>

<h3 id="layout-template">Layout template</h3>
<p><code>app/views/main.scala.html</code></p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre></td><td class="code"><pre>@(title: String)(content: Html)(implicit lang: Lang)

<span class="doctype">&lt;!DOCTYPE html&gt;</span>
<span class="tag">&lt;<span class="title">html</span>&gt;</span>
  <span class="tag">&lt;<span class="title">head</span>&gt;</span>
    <span class="tag">&lt;<span class="title">title</span>&gt;</span>@title<span class="tag">&lt;/<span class="title">title</span>&gt;</span>
    <span class="tag">&lt;<span class="title">link</span> <span class="attribute">rel</span>=<span class="value">"stylesheet"</span> <span class="attribute">type</span>=<span class="value">"text/css"</span> <span class="attribute">media</span>=<span class="value">"screen"</span>
      <span class="attribute">href</span>=<span class="value">'@routes.Assets.at("stylesheets/bootstrap.css")'</span>&gt;</span>
    <span class="tag">&lt;<span class="title">link</span> <span class="attribute">rel</span>=<span class="value">"stylesheet"</span> <span class="attribute">media</span>=<span class="value">"screen"</span>
      <span class="attribute">href</span>=<span class="value">"@routes.Assets.at("</span><span class="value">stylesheets</span>/<span class="attribute">main.css</span>")"&gt;</span>
  <span class="tag">&lt;/<span class="title">head</span>&gt;</span>
  <span class="tag">&lt;<span class="title">body</span>&gt;</span>
    <span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"screenshot"</span>&gt;</span>
      <span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"navbar navbar-fixed-top"</span>&gt;</span>
        <span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"navbar-inner"</span>&gt;</span>
          <span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"container"</span>&gt;</span>
            <span class="tag">&lt;<span class="title">a</span> <span class="attribute">class</span>=<span class="value">"brand"</span> <span class="attribute">href</span>=<span class="value">"@routes.Application.index()"</span>&gt;</span>
              @Messages("application.name")
            <span class="tag">&lt;/<span class="title">a</span>&gt;</span>
          <span class="tag">&lt;/<span class="title">div</span>&gt;</span>
        <span class="tag">&lt;/<span class="title">div</span>&gt;</span>
      <span class="tag">&lt;/<span class="title">div</span>&gt;</span>
      <span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"container"</span>&gt;</span>@content<span class="tag">&lt;/<span class="title">div</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">div</span>&gt;</span>
  <span class="tag">&lt;/<span class="title">body</span>&gt;</span>
<span class="tag">&lt;/<span class="title">html</span>&gt;</span>
</pre></td></tr></table></figure>

<h3 id="controller-action-method">Controller action method</h3>
<p><code>app/controllers/Products.scala</code></p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="code"><pre><span class="keyword">package</span> controllers

<span class="keyword">import</span> play.api.mvc.{Action, Controller}
<span class="keyword">import</span> models.Product

<span class="class"><span class="keyword">object</span> <span class="title">Products</span> <span class="keyword">extends</span> <span class="title">Controller</span> {</span>
  <span class="keyword">def</span> list = Action { implicit request =&gt;
    <span class="keyword">val</span> products = Product.findAll
    Ok(views.html.products.list(products))
  }
}
</pre></td></tr></table></figure>

<h3 id="adding-a-routes-configuration">Adding a routes configuration</h3>
<p><code>conf/routes</code></p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
</pre></td><td class="code"><pre>GET / controllers.Application.index

GET /products controllers.Products.<span class="type">list</span>

GET /assets/*<span class="type">file</span> controllers.Assets.<span class="keyword">at</span>(path=<span class="string">"/public"</span>, <span class="type">file</span>)
</pre></td></tr></table></figure>

<h3 id="replacing-the-welcome-page-with-a-redirect">Replacing the welcome page with a redirect</h3>
<p><code>app/controllers/Application.scala</code></p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
</pre></td><td class="code"><pre><span class="keyword">package</span> controllers
<span class="keyword">import</span> play.api.mvc.{Action, Controller}

<span class="class"><span class="keyword">object</span> <span class="title">Application</span> <span class="keyword">extends</span> <span class="title">Controller</span> {</span>
  <span class="keyword">def</span> index = Action {
    Redirect(routes.Products.list())
  }
}
</pre></td></tr></table></figure>

<p>Delete <code>app/views/index.scala.html</code> template.</p>
<h3 id="checking-the-language-localizations">Checking the language localizations</h3>
<p><code>app/views/debug.scala.html</code></p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
</pre></td><td class="code"><pre>@()(implicit lang: Lang)

@import play<span class="preprocessor">.api</span><span class="preprocessor">.Play</span><span class="preprocessor">.current</span>

&lt;footer&gt;
  lang = @lang<span class="preprocessor">.code</span>,
  user = @current<span class="preprocessor">.configuration</span><span class="preprocessor">.getString</span>(<span class="string">"environment.user"</span>),
  date = @(new java<span class="preprocessor">.util</span><span class="preprocessor">.Date</span>()<span class="preprocessor">.format</span>(<span class="string">"yyyy-MM-dd HH:mm"</span>))
&lt;/footer&gt;
</pre></td></tr></table></figure>

<p><code>conf/application.conf</code></p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
</pre></td><td class="code"><pre><span class="comment"># USER is an environment variable</span>
environment.user=<span class="variable">${USER}</span>
</pre></td></tr></table></figure>

<p><code>app/views/main.scala.html</code></p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
</pre></td><td class="code"><pre>&lt;div <span class="keyword">class</span>=<span class="string">"container"</span>&gt;
<span class="keyword">@content</span>
<span class="keyword">@debug</span>()
&lt;/div&gt;
</pre></td></tr></table></figure>

<h2 id="details-page">Details page</h2>
<p>The page’s URL, for example <code>/products/5010255079763</code>, includes the EAN code,
which is also used to generate a bar code image</p>
<ul>
<li>A new finder method—To fetch one specific product</li>
<li>A view template—To show this details page</li>
<li>An HTTP routing configuration—For a URL with a parameter</li>
<li>A bar code image—To display on the page</li>
</ul>
<h3 id="model-finder-method">Model finder method</h3>
<p><code>app/models/Product.scala</code></p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre><span class="class"><span class="keyword">object</span> <span class="title">Product</span> {</span>
  <span class="keyword">def</span> findByEan(ean: Long) = products.find(_.ean == ean)
}
</pre></td></tr></table></figure>

<h3 id="details-page-template">Details page template</h3>
<p><code>app/views/products/details.scala.html</code></p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="code"><pre>@(product: Product)(implicit lang: Lang)
@main(Messages("products.details", product.name)) {
  <span class="tag">&lt;<span class="title">h2</span>&gt;</span>
    <span class="comment">&lt;!-- 生成横条码  --&gt;</span>
    @tags.barcode(product.ean)
    @Messages("products.details", product.name)
  <span class="tag">&lt;/<span class="title">h2</span>&gt;</span>

  <span class="tag">&lt;<span class="title">dl</span> <span class="attribute">class</span>=<span class="value">"dl-horizontal"</span>&gt;</span>
    <span class="tag">&lt;<span class="title">dt</span>&gt;</span>@Messages("ean"):<span class="tag">&lt;/<span class="title">dt</span>&gt;</span>
    <span class="tag">&lt;<span class="title">dd</span>&gt;</span>@product.ean<span class="tag">&lt;/<span class="title">dd</span>&gt;</span>
    <span class="tag">&lt;<span class="title">dt</span>&gt;</span>@Messages("name"):<span class="tag">&lt;/<span class="title">dt</span>&gt;</span>
    <span class="tag">&lt;<span class="title">dd</span>&gt;</span>@product.name<span class="tag">&lt;/<span class="title">dd</span>&gt;</span>
    <span class="tag">&lt;<span class="title">dt</span>&gt;</span>@Messages("description"):<span class="tag">&lt;/<span class="title">dt</span>&gt;</span>
    <span class="tag">&lt;<span class="title">dd</span>&gt;</span>@product.description<span class="tag">&lt;/<span class="title">dd</span>&gt;</span>
  <span class="tag">&lt;/<span class="title">dl</span>&gt;</span>

}
</pre></td></tr></table></figure>

<p><code>app/views/tags/barcode.scala.html</code></p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
</pre></td><td class="code"><pre>@(ean: <span class="built_in">Long</span>)
&lt;img <span class="keyword">class</span>=<span class="string">"barcode"</span> alt=<span class="string">"@ean"</span> src=<span class="string">"@routes.Barcodes.barcode(ean)"</span>&gt;
</pre></td></tr></table></figure>

<h3 id="additional-message-localizations">Additional message localizations</h3>
<p><code>conf/messages</code></p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
</pre></td><td class="code"><pre><span class="constant">ean</span> = EAN
<span class="constant">name</span> = Name
<span class="constant">description</span> = Description

products.details = Product: {0}
</pre></td></tr></table></figure>

<p><code>conf/messages.es</code></p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
</pre></td><td class="code"><pre><span class="constant">ean</span> = EAN
<span class="constant">name</span> = Nombre
<span class="constant">description</span> = Descripción

products.details = Producto: {0}
</pre></td></tr></table></figure>

<h3 id="adding-a-parameter-to-a-controller-action">Adding a parameter to a controller action</h3>
<p><code>app/controllers/Products.scala</code></p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
</pre></td><td class="code"><pre>def show(ean: Long) = Action { implicit request =&gt;
  Product<span class="preprocessor">.findByEan</span>(ean)<span class="preprocessor">.map</span> { product =&gt;
    Ok(views<span class="preprocessor">.html</span><span class="preprocessor">.products</span><span class="preprocessor">.details</span>(product))
  }<span class="preprocessor">.getOrElse</span>(NotFound)
}
</pre></td></tr></table></figure>

<h3 id="adding-a-parameter-to-a-route">Adding a parameter to a route</h3>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre><span class="keyword">GET</span> /products/:ean controllers.Products.show(ean: <span class="built_in">Long</span>)
</pre></td></tr></table></figure>

<h3 id="generating-a-bar-code-image">Generating a bar code image</h3>
<p><code>project/Build.scala</code></p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre>val appDependencies = Se<span class="string">q(
  "net.sf.barcode4j" % "barcode4j" % "2.0"
)</span>
</pre></td></tr></table></figure>

<p><code>app/controllers/Barcodes.scala</code></p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre></td><td class="code"><pre><span class="keyword">package</span> controllers

<span class="keyword">import</span> play.api.mvc.{Action, Controller}

<span class="class"><span class="keyword">object</span> <span class="title">Barcodes</span> <span class="keyword">extends</span> <span class="title">Controller</span> {</span>
  <span class="keyword">val</span> ImageResolution = <span class="number">144</span>
  <span class="comment">// Action that returns PNG response</span>
  <span class="keyword">def</span> barcode(ean: Long) = Action {
    <span class="keyword">import</span> java.lang.IllegalArgumentException
    <span class="keyword">val</span> MimeType = <span class="string">"image/png"</span>
    <span class="keyword">try</span> {
      <span class="keyword">val</span> imageData = ean13BarCode(ean, MimeType)
      Ok(imageData).as(MimeType)
    } <span class="keyword">catch</span> {
      <span class="keyword">case</span> e: IllegalArgumentException =&gt;
        BadRequest(<span class="string">"Couldn’t generate bar code. Error: "</span> + e.getMessage)
    }
  }
  <span class="keyword">def</span> ean13BarCode(ean: Long, mimeType: String): Array[Byte] = {
    <span class="keyword">import</span> java.io.ByteArrayOutputStream
    <span class="keyword">import</span> java.awt.image.BufferedImage
    <span class="keyword">import</span> org.krysalis.barcode4j.output.bitmap.BitmapCanvasProvider
    <span class="keyword">import</span> org.krysalis.barcode4j.impl.upcean.EAN13Bean
    <span class="keyword">val</span> output: ByteArrayOutputStream = <span class="keyword">new</span> ByteArrayOutputStream
    <span class="keyword">val</span> canvas: BitmapCanvasProvider =
      <span class="keyword">new</span> BitmapCanvasProvider(output, mimeType, ImageResolution,
        BufferedImage.TYPE_BYTE_BINARY, <span class="keyword">false</span>, <span class="number">0</span>)
    <span class="keyword">val</span> barcode = <span class="keyword">new</span> EAN13Bean()
    barcode.generateBarcode(canvas, String valueOf ean)
    canvas.finish
    output.toByteArray
  }
}
</pre></td></tr></table></figure>

<p><code>conf/routes</code></p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre><span class="keyword">GET</span> /barcode/:ean controllers.Barcodes.barcode(ean: <span class="built_in">Long</span>)
</pre></td></tr></table></figure>

<h2 id="adding-a-new-product">Adding a new product</h2>
<h3 id="additional-message-localizations">Additional message localizations</h3>
<p><code>conf/messages</code></p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
</pre></td><td class="code"><pre>products<span class="preprocessor">.form</span> = Product details
products<span class="preprocessor">.new</span> = (new)
products<span class="preprocessor">.new</span><span class="preprocessor">.command</span> = New

products<span class="preprocessor">.new</span><span class="preprocessor">.submit</span> = <span class="keyword">Add</span>
products<span class="preprocessor">.new</span><span class="preprocessor">.success</span> = Successfully added product {<span class="number">0</span>}.

validation<span class="preprocessor">.errors</span> = Please correct the errors <span class="keyword">in</span> the form.
validation<span class="preprocessor">.ean</span><span class="preprocessor">.duplicate</span> = A product with this EAN code already exists
</pre></td></tr></table></figure>

<h3 id="form-object">Form object</h3>
<p><code>app/controllers/Products.scala</code></p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="code"><pre>import play<span class="preprocessor">.api</span><span class="preprocessor">.data</span><span class="preprocessor">.Form</span>
import play<span class="preprocessor">.api</span><span class="preprocessor">.data</span><span class="preprocessor">.Forms</span>.{mapping, longNumber, nonEmptyText}
import play<span class="preprocessor">.api</span><span class="preprocessor">.i</span>18n<span class="preprocessor">.Messages</span>

private val productForm: Form[Product] = Form(
  mapping(
    <span class="string">"ean"</span> -&gt; longNumber<span class="preprocessor">.verifying</span>(
      <span class="string">"validation.ean.duplicate"</span>, Product<span class="preprocessor">.findByEan</span>(_)<span class="preprocessor">.isEmpty</span>),
    <span class="string">"name"</span> -&gt; nonEmptyText,
    <span class="string">"description"</span> -&gt; nonEmptyTest
  )(Product<span class="preprocessor">.apply</span>)(Product<span class="preprocessor">.unapply</span>)
)
</pre></td></tr></table></figure>

<h3 id="form-template">Form template</h3>
<p><code>app/views/main.scala.html</code></p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre></td><td class="code"><pre>&lt;<span class="keyword">div</span> <span class="type">class</span>=<span class="string">"container"</span>&gt;
  &lt;a <span class="type">class</span>=<span class="string">"brand"</span> href=<span class="string">"@routes.Application.index()"</span>&gt;
    @Messages(<span class="string">"application.name"</span>)
  &lt;/a&gt;
  &lt;ul <span class="type">class</span>=<span class="string">"nav"</span>&gt;
    &lt;li <span class="type">class</span>=<span class="string">"divider-vertical"</span>&gt;&lt;/li&gt;
    &lt;li <span class="type">class</span>=<span class="string">"active"</span>&gt;
      &lt;a href=<span class="string">"@routes.Products.list()"</span>&gt;
        @Messages(<span class="string">"products.list.navigation"</span>)
      &lt;/a&gt;
    &lt;/li&gt;
    &lt;li <span class="type">class</span>=<span class="string">"active"</span>&gt;
      &lt;a href=<span class="string">"@routes.Products.newProduct()"</span>&gt;
        &lt;i <span class="type">class</span>=<span class="string">"icon-plus icon-white"</span>&gt;&lt;/i&gt;
        @Messages(<span class="string">"products.new.command"</span>)
      &lt;/a&gt;
    &lt;/li&gt;
    &lt;li <span class="type">class</span>=<span class="string">"divider-vertical"</span>&gt;&lt;/li&gt;
  &lt;/ul&gt;
&lt;/<span class="keyword">div</span>&gt;

&lt;<span class="keyword">div</span> <span class="type">class</span>=<span class="string">"container"</span>&gt;
  @<span class="keyword">if</span>(flash.<span class="keyword">get</span>(<span class="string">"success"</span>).isDefined){
    &lt;<span class="keyword">div</span> <span class="type">class</span>=<span class="string">"alert alert-success"</span>&gt;
      @flash.<span class="keyword">get</span>(<span class="string">"success"</span>)
    &lt;/<span class="keyword">div</span>&gt;
  }
  @<span class="keyword">if</span>(flash.<span class="keyword">get</span>(<span class="string">"error"</span>).isDefined){
    &lt;<span class="keyword">div</span> <span class="type">class</span>=<span class="string">"alert alert-error"</span>&gt;
      @flash.<span class="keyword">get</span>(<span class="string">"error"</span>)
    &lt;/<span class="keyword">div</span>&gt;
  }
  @content
  @debug()
&lt;/<span class="keyword">div</span>&gt;
</pre></td></tr></table></figure>

<p><code>app/views/products/list.scala.html</code></p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
</pre></td><td class="code"><pre><span class="tag">&lt;<span class="title">p</span>&gt;</span>
  <span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"@controllers.routes.Products.newProduct()"</span> <span class="attribute">class</span>=<span class="value">"btn"</span>&gt;</span>
  <span class="tag">&lt;<span class="title">i</span> <span class="attribute">class</span>=<span class="value">"icon-plus"</span>&gt;</span><span class="tag">&lt;/<span class="title">i</span>&gt;</span> @Messages("products.new.command")<span class="tag">&lt;/<span class="title">a</span>&gt;</span>
<span class="tag">&lt;/<span class="title">p</span>&gt;</span>
</pre></td></tr></table></figure>

<p><code>app/views/products/editProduct.scala.html</code></p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="code"><pre><span class="at_rule">@(productForm:<span class="preprocessor"> Form</span>[Product])(implicit<span class="preprocessor"> flash</span>:<span class="preprocessor"> Flash</span>,<span class="preprocessor"> lang</span>:<span class="preprocessor"> Lang</span>)

&lt;!--<span class="preprocessor"> Twitter</span><span class="preprocessor"> Bootstrap</span><span class="preprocessor"> helpers</span><span class="preprocessor"> --</span>&gt;
@<span class="keyword">import</span><span class="preprocessor"> helper._</span>
@<span class="keyword">import</span><span class="preprocessor"> helper.twitterBootstrap._</span>

@<span class="function">main(<span class="function">Messages(<span class="string">"products.form"</span>)</span>)</span> {</span>
  &lt;<span class="tag">h2</span>&gt;<span class="at_rule">@<span class="function">Messages(<span class="string">"products.form"</span>)</span>&lt;/h2&gt;

  @helper.<span class="function">form(action = routes.Products.<span class="function">save()</span>)</span> {</span>
    &lt;<span class="tag">fieldset</span>&gt;
      &lt;<span class="tag">legend</span>&gt;
        <span class="at_rule">@<span class="function">Messages(<span class="string">"products.details"</span>, <span class="function">Messages(<span class="string">"products.new"</span>)</span>)</span>
      &lt;/legend&gt;
      @helper.<span class="function">inputText(<span class="function">productForm(<span class="string">"ean"</span>)</span>)</span>
      @helper.<span class="function">inputText(<span class="function">productForm(<span class="string">"name"</span>)</span>)</span>
      @helper.<span class="function">textarea(<span class="function">productForm(<span class="string">"description"</span>)</span>)</span>
    &lt;/fieldset&gt;
    &lt;p&gt;&lt;input<span class="preprocessor"> type</span>=<span class="string">"submit"</span><span class="preprocessor"> class</span>=<span class="string">"btn primary"</span><span class="preprocessor"> value</span>=<span class="string">'@Messages("products.new.submit")'</span>&gt;&lt;/p&gt;
  }
}</span>
</pre></td></tr></table></figure>

<h3 id="saving-the-new-product">Saving the new product</h3>
<p><code>app/models/Product.scala</code></p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
</pre></td><td class="code"><pre><span class="class"><span class="keyword">object</span> <span class="title">Product</span> {</span>
  <span class="keyword">def</span> add(product: Product) {
    products = products + product
  }
}
</pre></td></tr></table></figure>

<h3 id="validating-the-user-input">Validating the user input</h3>
<p><code>app/controllers/Products.scala</code></p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre></td><td class="code"><pre>import play<span class="preprocessor">.api</span><span class="preprocessor">.mvc</span><span class="preprocessor">.Flash</span>

def save = Action {implicit request =&gt;
  val newProductForm = productForm<span class="preprocessor">.bindFromRequest</span>()
  newProductForm<span class="preprocessor">.fold</span>(
    hasErrors = { form =&gt;
      Redirect(route<span class="preprocessor">.Products</span><span class="preprocessor">.newProduct</span>()).
        flashing(Flash(form<span class="preprocessor">.data</span>) +
          (<span class="string">"error"</span> -&gt; Messages(<span class="string">"validation.errors"</span>)))
    },
    success = { newProduct =&gt;
      Product<span class="preprocessor">.add</span>(newProduct)
      Redirect(routes<span class="preprocessor">.Products</span><span class="preprocessor">.show</span>(newProduct<span class="preprocessor">.ean</span>)).
        flashing(<span class="string">"success"</span> -&gt; message)
    }
  )
}

def newProduct = Action { implicit request =&gt;
  val form = if (flash<span class="preprocessor">.get</span>(<span class="string">"error"</span>)<span class="preprocessor">.isDefined</span>)
    productForm<span class="preprocessor">.bind</span>(flash<span class="preprocessor">.data</span>)
  else
    productForm
    
  Ok(views<span class="preprocessor">.html</span><span class="preprocessor">.products</span><span class="preprocessor">.editProduct</span>(form))
}
</pre></td></tr></table></figure>

<h3 id="adding-the-routes-for-saving-products">Adding the routes for saving products</h3>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre>POST /products controllers<span class="preprocessor">.Products</span><span class="preprocessor">.save</span>

GET /products/new controllers<span class="preprocessor">.Products</span><span class="preprocessor">.newProduct</span>
</pre></td></tr></table></figure>

  
	</div>
		<footer class="article-footer clearfix">

  <div class="article-tags">
  
  <span></span> <a href="/tags/scala/">scala</a><a href="/tags/play/">play</a>
  </div>




<div class="article-share" id="share">

  <div data-url="http://zhpooer.github.io/2014/08/07/play-for-scala-getting-start/" data-title="Play for Scala-Getting Start | Poe&#39;s World" data-tsina="null" class="share clearfix">
  </div>

</div>
</footer>   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2014/08/08/play-for-scala-deconstructing-play/" title="Play for Scala-Deconstructing Play">
  <strong>PREVIOUS:</strong><br/>
  <span>
  Play for Scala-Deconstructing Play</span>
</a>
</div>


<div class="next">
<a href="/2014/08/06/akka-in-action-integration/"  title="Akka in Action-Integration">
 <strong>NEXT:</strong><br/> 
 <span>Akka in Action-Integration
</span>
</a>
</div>

</nav>

	
<section class="comment">
	<div class="ds-thread"></div>
</section>

</div>  
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">文章目录</strong>
  <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#what-play-is"><span class="toc-number">1.</span> <span class="toc-text">What Play is</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#hello-play"><span class="toc-number">2.</span> <span class="toc-text">Hello Play</span></a></li><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#add-an-html-page-template"><span class="toc-number">2.1.</span> <span class="toc-text">Add an HTML page template</span></a></li></ol><li class="toc-item toc-level-1"><a class="toc-link" href="#your-first-play-application"><span class="toc-number">3.</span> <span class="toc-text">Your first Play application</span></a></li><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#getting-started"><span class="toc-number">3.1.</span> <span class="toc-text">Getting started</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#adding-the-model"><span class="toc-number">3.2.</span> <span class="toc-text">Adding the model</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#product-list-page"><span class="toc-number">3.3.</span> <span class="toc-text">Product list page</span></a></li><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#layout-template"><span class="toc-number">3.3.1.</span> <span class="toc-text">Layout template</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#controller-action-method"><span class="toc-number">3.3.2.</span> <span class="toc-text">Controller action method</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#adding-a-routes-configuration"><span class="toc-number">3.3.3.</span> <span class="toc-text">Adding a routes configuration</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#replacing-the-welcome-page-with-a-redirect"><span class="toc-number">3.3.4.</span> <span class="toc-text">Replacing the welcome page with a redirect</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#checking-the-language-localizations"><span class="toc-number">3.3.5.</span> <span class="toc-text">Checking the language localizations</span></a></li></ol><li class="toc-item toc-level-2"><a class="toc-link" href="#details-page"><span class="toc-number">3.4.</span> <span class="toc-text">Details page</span></a></li><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#model-finder-method"><span class="toc-number">3.4.1.</span> <span class="toc-text">Model finder method</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#details-page-template"><span class="toc-number">3.4.2.</span> <span class="toc-text">Details page template</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#additional-message-localizations"><span class="toc-number">3.4.3.</span> <span class="toc-text">Additional message localizations</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#adding-a-parameter-to-a-controller-action"><span class="toc-number">3.4.4.</span> <span class="toc-text">Adding a parameter to a controller action</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#adding-a-parameter-to-a-route"><span class="toc-number">3.4.5.</span> <span class="toc-text">Adding a parameter to a route</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#generating-a-bar-code-image"><span class="toc-number">3.4.6.</span> <span class="toc-text">Generating a bar code image</span></a></li></ol><li class="toc-item toc-level-2"><a class="toc-link" href="#adding-a-new-product"><span class="toc-number">3.5.</span> <span class="toc-text">Adding a new product</span></a></li><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#additional-message-localizations"><span class="toc-number">3.5.1.</span> <span class="toc-text">Additional message localizations</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#form-object"><span class="toc-number">3.5.2.</span> <span class="toc-text">Form object</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#form-template"><span class="toc-number">3.5.3.</span> <span class="toc-text">Form template</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#saving-the-new-product"><span class="toc-number">3.5.4.</span> <span class="toc-text">Saving the new product</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#validating-the-user-input"><span class="toc-number">3.5.5.</span> <span class="toc-text">Validating the user input</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#adding-the-routes-for-saving-products"><span class="toc-number">3.5.6.</span> <span class="toc-text">Adding the routes for saving products</span></a></li></ol>
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  

  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			<li><a href="/tags/AJAX/" title="AJAX">AJAX<sup>1</sup></a></li>
		
			<li><a href="/tags/Akka/" title="Akka">Akka<sup>1</sup></a></li>
		
			<li><a href="/tags/Android/" title="Android">Android<sup>1</sup></a></li>
		
			<li><a href="/tags/DOM/" title="DOM">DOM<sup>2</sup></a></li>
		
			<li><a href="/tags/EL表达式/" title="EL表达式">EL表达式<sup>1</sup></a></li>
		
			<li><a href="/tags/HBase/" title="HBase">HBase<sup>1</sup></a></li>
		
			<li><a href="/tags/Hadoop/" title="Hadoop">Hadoop<sup>1</sup></a></li>
		
			<li><a href="/tags/Hibernate/" title="Hibernate">Hibernate<sup>2</sup></a></li>
		
			<li><a href="/tags/HttpSession/" title="HttpSession">HttpSession<sup>1</sup></a></li>
		
			<li><a href="/tags/IO/" title="IO">IO<sup>1</sup></a></li>
		
			<li><a href="/tags/Illustrator/" title="Illustrator">Illustrator<sup>3</sup></a></li>
		
			<li><a href="/tags/JSP/" title="JSP">JSP<sup>1</sup></a></li>
		
			<li><a href="/tags/JavaBean/" title="JavaBean">JavaBean<sup>1</sup></a></li>
		
			<li><a href="/tags/JavaScript/" title="JavaScript">JavaScript<sup>1</sup></a></li>
		
			<li><a href="/tags/Mybatis/" title="Mybatis">Mybatis<sup>1</sup></a></li>
		
			<li><a href="/tags/NoSql/" title="NoSql">NoSql<sup>1</sup></a></li>
		
			<li><a href="/tags/SASS/" title="SASS">SASS<sup>1</sup></a></li>
		
			<li><a href="/tags/SAX/" title="SAX">SAX<sup>1</sup></a></li>
		
			<li><a href="/tags/ServletRequest/" title="ServletRequest">ServletRequest<sup>1</sup></a></li>
		
			<li><a href="/tags/ServletResponse/" title="ServletResponse">ServletResponse<sup>1</sup></a></li>
		
		</ul>
</div>


  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 订阅</a>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<div class="social-font" class="clearfix">
		
		
		
		
	</div>
		<p class="copyright">Powered by <a href="http://zespia.tw/hexo/" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/A-limon/pacman" target="_blank" title="Pacman">Pacman</a> © 2014 
		
		<a href="http://zhpooer.github.io" target="_blank" title="zhpooer">zhpooer</a>
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.1.0.min.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else
    {
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      h  = $('article h2')
      ah = $('article h2'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  if(ah.length==0){
    t.css('display','none');
  }else{
    c.click(function(){
      ta.css('display', 'block').addClass('fadeIn');
    });
    o.click(function(){
      ta.css('display', 'none');
    });
    $(window).scroll(function(){
      ta.css("top",Math.max(140,320-$(this).scrollTop()));
    });
  };
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina');
  var html = [
  '<a href="#" class="overlay" id="qrcode"></a>',
  '<div class="qrcode clearfix"><span>扫描二维码分享到微信朋友圈</span><a class="qrclose" href="#share"></a><strong>Loading...Please wait</strong><img id="qrcode-pic" data-src="http://s.jiathis.com/qrcode.php?url=' + encodedUrl + '"/></div>',
  '<a href="#textlogo" class="article-back-to-top" title="Top"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="QRcode"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="Weibo"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);
  $('.article-share-qrcode').click(function(){
    var imgSrc = $('#qrcode-pic').attr('data-src');
    $('#qrcode-pic').attr('src', imgSrc);
    $('#qrcode-pic').load(function(){
        $('.qrcode strong').text(' ');
    });
  });
});     
</script>


<script type="text/javascript">
  var duoshuoQuery = {short_name:"zhpoooer"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script> 





  </body>
</html>
