
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  
    <title>Play for Scala-Input with forms | Poe&#39;s World</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=3, minimum-scale=1">
    
    <meta name="author" content="zhpooer">
    
    <meta name="description" content="Forms—the concept
Play provides the so-called forms API. The term form isn’t just about HTML forms in
a Play application; it’s a more general concept.">
    
    
    
    
    <link rel="alternative" href="/atom.xml" title="Poe&#39;s World" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/pacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/pacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>

  <body>
    <header>
      <div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.svg" alt="Poe&#39;s World" title="Poe&#39;s World"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="Poe&#39;s World">Poe&#39;s World</a></h1>
				<h2 class="blog-motto">竹杖芒鞋轻胜马，一蓑烟雨任平生</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">主页</a></li>
					
						<li><a href="/english-monthly">英语角</a></li>
					
						<li><a href="/about">关于</a></li>
					
						<li><a href="/archives">归档</a></li>
					
					<li>
					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="text" id="search" name="q" autocomplete="off" maxlength="20" placeholder="搜索" />
						<input type="hidden" name="q" value="site:zhpooer.github.io">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>

    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2014/08/12/play-for-scala-input-with-forms/" title="Play for Scala-Input with forms" itemprop="url">Play for Scala-Input with forms</a>
  </h1>
  <p class="article-author">By
    
      <a href="http://zhpooer.github.io" title="zhpooer">zhpooer</a>
    </p>
  <p class="article-time">
    <time datetime="2014-08-12T08:22:42.000Z" itemprop="datePublished">8月 12 2014</time>
    更新日期:<time datetime="2014-08-12T13:05:00.000Z" itemprop="dateModified">8月 12 2014</time>
    
  </p>
</header>
	<div class="article-content">
		
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">文章目录</strong>
		<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#forms-the-concept"><span class="toc-number">1.</span> <span class="toc-text">Forms—the concept</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#forms-basics"><span class="toc-number">2.</span> <span class="toc-text">Forms basics</span></a></li><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#mappings"><span class="toc-number">2.1.</span> <span class="toc-text">Mappings</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#creating-a-form"><span class="toc-number">2.2.</span> <span class="toc-text">Creating a form</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#processing-data-with-a-form"><span class="toc-number">2.3.</span> <span class="toc-text">Processing data with a form</span></a></li><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#either"><span class="toc-number">2.3.1.</span> <span class="toc-text">Either</span></a></li></ol><li class="toc-item toc-level-2"><a class="toc-link" href="#object-mapping"><span class="toc-number">2.4.</span> <span class="toc-text">Object mapping</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mapping-http-request-data"><span class="toc-number">2.5.</span> <span class="toc-text">Mapping HTTP request data</span></a></li></ol><li class="toc-item toc-level-1"><a class="toc-link" href="#creating-and-processing-html-forms"><span class="toc-number">3.</span> <span class="toc-text">Creating and processing HTML forms</span></a></li><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#writing-html-forms-manually"><span class="toc-number">3.1.</span> <span class="toc-text">Writing HTML forms manually</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#generating-html-forms"><span class="toc-number">3.2.</span> <span class="toc-text">Generating HTML forms</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#input-helpers"><span class="toc-number">3.3.</span> <span class="toc-text">Input helpers</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#customizing-generated-html"><span class="toc-number">3.4.</span> <span class="toc-text">Customizing generated HTML</span></a></li></ol><li class="toc-item toc-level-1"><a class="toc-link" href="#validation-and-advanced-mappings"><span class="toc-number">4.</span> <span class="toc-text">Validation and advanced mappings</span></a></li></ol>
		</div>
		
		<h1 id="forms-the-concept">Forms—the concept</h1>
<p>Play provides the so-called forms API. The term form isn’t just about HTML forms in
a Play application; it’s a more general concept. The forms API helps you to validate data,
manage validation errors, and map this data to richer data structures.</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="code"><pre><span class="reserved">case</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span>(</span>
  username : String,
  realname : Option[String],
  email    : String )

val userForm = Form(
  mapping(
    <span class="string">"username"</span><span class="function"> -&gt;</span> nonEmptyText(<span class="number">8</span>),
    <span class="string">"realname"</span><span class="function"> -&gt;</span> optional(text),
    <span class="string">"email"</span><span class="function"> -&gt;</span> email)(User.apply)(User.unapply))

def createUser() = Action { implicit request<span class="function"> =&gt;</span>
  userForm.bindFromRequest.fold(
    formWithErrors<span class="function"> =&gt;</span> BadRequest,
    user<span class="function"> =&gt;</span> Ok(<span class="string">"User OK!"</span>))
}
</pre></td></tr></table></figure>

<h1 id="forms-basics">Forms basics</h1>
<p>Play’s forms are powerful, but they’re built on a few simple ideas.</p>
<h2 id="mappings">Mappings</h2>
<p>A Mapping is an object that can construct something from the data in an HTTP
request. This process is called binding.</p>
<p>So a Mapping[User] can construct a User instance, and
a Mapping[Int] can create an Int.</p>
<p> If you submit an HTML form with an input tag
<code>&lt;input type=&quot;text&quot; name=&quot;age&quot;&gt;</code>, a <code>Mapping[Int]</code> can convert that age value,
which is submitted as a string, into a Scala Int.</p>
<p>The data from the HTTP request is transformed into a <code>Map[String, String]</code>, and
this is what the Mapping operates on.</p>
<p>But a Mapping can not only construct an object from a map of data;
it can also do the reverse operation of deconstructing an object
into a map of data.</p>
<p> A mapping is an object of type <code>Mapping[T]</code> that can take a
<code>Map[String, String]</code>, and use it to construct an object of type T ,</p>
<p>For example, <code>Forms.number</code> is a mapping of type <code>Mapping[Int]</code>,
whereas <code>Forms.text</code> is a mapping of type
<code>Mapping[String]</code>. There’s also <code>Forms.email</code>,
which is also of type <code>Mapping[String]</code>,
but it also contains a constraint that the
string must look like an email address.</p>
<h2 id="creating-a-form">Creating a form</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="code"><pre>val data = <span class="keyword">Map</span>(
  <span class="string">"name"</span> -&gt; <span class="string">"Box of paper clips"</span>,
  <span class="string">"ean"</span> -&gt; <span class="string">"1234567890123"</span>,
  <span class="string">"pieces"</span> -&gt; <span class="string">"300"</span>
)

// The <span class="keyword">type</span> <span class="keyword">of</span> mapping <span class="keyword">is</span>
// play.api.data.Mapping[(<span class="typename">String</span>, <span class="typename">String</span>, Int)]
// indicates the <span class="keyword">type</span> <span class="keyword">of</span> objects that this mapping can construct.
val mapping = Forms.tuple(
  <span class="string">"name"</span> -&gt; Forms.text,
  <span class="string">"ean"</span> -&gt; Forms.text,
  <span class="string">"pieces"</span> -&gt; Forms.number)

// This form <span class="keyword">is</span> <span class="keyword">of</span> <span class="keyword">type</span> Form[(<span class="typename">String</span>, <span class="typename">String</span>, Int)].
// Form has a single <span class="keyword">type</span> parameter, <span class="keyword">and</span> it has the same meaning.
// But a form <span class="keyword">not</span> only wraps a Mapping, it can also contain data.
val productForm = Form(mapping)
</pre></td></tr></table></figure>

<p>You can use the following Play-provided
basic mappings to start composing more complex mappings:</p>
<ul>
<li><code>boolean: Mapping[Boolean]</code></li>
<li><code>checked(msg: String): Mapping[Boolean]</code></li>
<li><code>date: Mapping[Date]</code></li>
<li><code>email: Mapping[String]</code></li>
<li><code>ignored[A](value: A): Mapping[A]</code></li>
<li><code>longNumber: Mapping[Long]</code></li>
<li><code>nonEmptyText: Mapping[String]</code></li>
<li><code>number: Mapping[Int]</code></li>
<li><code>sqlDate: Mapping[java.sql.Date]</code></li>
</ul>
<h2 id="processing-data-with-a-form">Processing data with a form</h2>
<p>The process of putting your data in the form is called binding,
and we use the bind method to do it:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
</pre></td><td class="code"><pre>//  <span class="keyword">it</span> returns <span class="operator">a</span> <span class="built_in">new</span> Form—<span class="operator">a</span> copy <span class="operator">of</span> <span class="operator">the</span> original form populated <span class="operator">with</span> <span class="operator">the</span> data.
val processedForm = productForm.bind(data)

<span class="keyword">if</span>(!processedForm.hasErrors) {
  val productTuple = processedForm.<span class="built_in">get</span><span class="comment"> // Do something with the product</span>
} <span class="keyword">else</span> {
  val errors = processedForm.getErrors<span class="comment"> // Do something with the errors</span>
}
</pre></td></tr></table></figure>

<p><code>Form.fold</code> takes two parameters, where the first is a function that accepts the
“failure” result, and the second accepts the “success” result as the single parameter.</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
</pre></td><td class="code"><pre>val processedForm = productForm<span class="preprocessor">.bind</span>(data)
processedForm<span class="preprocessor">.fold</span> (
  formWithErrors =&gt; BadRequest,
  productTuple =&gt; {
    Ok(views<span class="preprocessor">.html</span><span class="preprocessor">.product</span><span class="preprocessor">.show</span>(product))
  }
)
</pre></td></tr></table></figure>

<h3 id="either">Either</h3>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="code"><pre>def getProduct(): Either[String, Product] = {
  if(validation<span class="preprocessor">.hasError</span>) {
    Left(validation<span class="preprocessor">.error</span>)
  } else {
    Right(Product())
  }
}
def showProduct() = Action {
  getProduct()<span class="preprocessor">.fold</span>(
    failureReason =&gt; InternalServerError(failureReason),
    product =&gt; Ok(views<span class="preprocessor">.html</span><span class="preprocessor">.product</span><span class="preprocessor">.show</span>(product))
  )
}
</pre></td></tr></table></figure>

<h2 id="object-mapping">Object mapping</h2>
<p>To do so, we’ll have to provide the mapping with a function to construct the value.</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td><td class="code"><pre><span class="keyword">case</span> class Product(
  name: <span class="built_in">String</span>,
  ean: <span class="built_in">String</span>,
  pieces: Int)

<span class="keyword">import</span> play<span class="built_in">.</span>api<span class="built_in">.</span><span class="built_in">data</span><span class="built_in">.</span>Forms<span class="built_in">.</span>_

<span class="comment">// This makes the type of this mapping Mapping[Product].</span>
val productMapping <span class="subst">=</span> mapping(
  <span class="string">"name"</span> <span class="subst">-&gt; </span>text,
  <span class="string">"ean"</span> <span class="subst">-&gt; </span>text,
  <span class="string">"pieces"</span> <span class="subst">-&gt; </span>number)(Product<span class="built_in">.</span>apply)(Product<span class="built_in">.</span>unapply)

<span class="comment">// Using our Mapping[Product], we can now easily create a Form[Product]:</span>
val productForm <span class="subst">=</span> Form(productMapping)

productForm<span class="built_in">.</span>bind(<span class="built_in">data</span>)<span class="built_in">.</span>fold(
  formWithErrors <span class="subst">=&gt;</span> <span class="attribute">...</span>,
  product <span class="subst">=&gt;</span> 
)
</pre></td></tr></table></figure>

<h2 id="mapping-http-request-data">Mapping HTTP request data</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="code"><pre>def processForm() = Action { request =&gt;
  productForm.bindFromRequest()(request).fold(
  <span class="keyword">...</span>
  )
}

// 加入 imlicit
def processForm() = Action { implicit request =&gt;
  productForm.bindFromRequest().fold(
    <span class="keyword">...</span>
  )
}
</pre></td></tr></table></figure>

<p>Browsers submit HTTP bodies with either an <code>application/x-www-form-urlencoded</code>
or a <code>multipart/form-data</code> content type, depending on the form, and it’s
also common to send JSON over the wire. The bindFromRequest method uses the
Content-Type header to determine a suitable decoder for the body.</p>
<h1 id="creating-and-processing-html-forms">Creating and processing HTML forms</h1>
<p>Play also provides helpers that generate forms and take the
tedium out of showing validation and error messages in the appropriate places.</p>
<h2 id="writing-html-forms-manually">Writing HTML forms manually</h2>
<p>model class:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td><td class="code"><pre><span class="reserved">case</span> <span class="class"><span class="keyword">class</span> <span class="title">Product</span>(</span>
  <span class="attribute">ean</span>: Long,
  <span class="attribute">name</span>: String,
  <span class="attribute">description</span>: String,
  <span class="attribute">pieces</span>: Int,
  <span class="attribute">active</span>: Boolean)

val productForm = Form(mapping(
  <span class="string">"ean"</span><span class="function"> -&gt;</span> longNumber,
  <span class="string">"name"</span><span class="function"> -&gt;</span> nonEmptyText,
  <span class="string">"description"</span><span class="function"> -&gt;</span> text,
  <span class="string">"pieces"</span><span class="function"> -&gt;</span> number,
  <span class="string">"active"</span><span class="function"> -&gt;</span> boolean)(Product.apply)(Product.unapply))

def create() = Action { implicit request<span class="function"> =&gt;</span>
  productForm.bindFromRequest.fold(
    formWithErrors<span class="function"> =&gt;</span> BadRequest(<span class="string">"Oh noes, invalid submission!"</span>),
    value<span class="function"> =&gt;</span> Ok(<span class="string">"created: "</span> + value)
  )
}
</pre></td></tr></table></figure>

<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre></td><td class="code"><pre>@()
@main("Product Form") {
  <span class="tag">&lt;<span class="title">form</span> <span class="attribute">action</span>=<span class="value">"@routes.Products.create()"</span> <span class="attribute">method</span>=<span class="value">"post"</span>&gt;</span>
    <span class="tag">&lt;<span class="title">div</span>&gt;</span>
      <span class="tag">&lt;<span class="title">label</span> <span class="attribute">for</span>=<span class="value">"name"</span>&gt;</span>Product name<span class="tag">&lt;/<span class="title">label</span>&gt;</span>
      <span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"text"</span> <span class="attribute">name</span>=<span class="value">"name"</span> <span class="attribute">id</span>=<span class="value">"name"</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">div</span>&gt;</span>
    <span class="tag">&lt;<span class="title">div</span>&gt;</span>
      <span class="tag">&lt;<span class="title">label</span> <span class="attribute">for</span>=<span class="value">"description"</span>&gt;</span>Description<span class="tag">&lt;/<span class="title">label</span>&gt;</span>
      <span class="tag">&lt;<span class="title">textarea</span> <span class="attribute">id</span>=<span class="value">"description"</span> <span class="attribute">name</span>=<span class="value">"description"</span>&gt;</span><span class="tag">&lt;/<span class="title">textarea</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">div</span>&gt;</span>
    <span class="tag">&lt;<span class="title">div</span>&gt;</span>
      <span class="tag">&lt;<span class="title">label</span> <span class="attribute">for</span>=<span class="value">"ean"</span>&gt;</span>EAN Code<span class="tag">&lt;/<span class="title">label</span>&gt;</span>
      <span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"text"</span> <span class="attribute">name</span>=<span class="value">"ean"</span> <span class="attribute">id</span>=<span class="value">"ean"</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">div</span>&gt;</span>
    <span class="tag">&lt;<span class="title">div</span>&gt;</span>
      <span class="tag">&lt;<span class="title">label</span> <span class="attribute">for</span>=<span class="value">"pieces"</span>&gt;</span>Pieces<span class="tag">&lt;/<span class="title">label</span>&gt;</span>
      <span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"text"</span> <span class="attribute">name</span>=<span class="value">"pieces"</span> <span class="attribute">id</span>=<span class="value">"pieces"</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">div</span>&gt;</span>
    <span class="tag">&lt;<span class="title">div</span>&gt;</span>
      <span class="tag">&lt;<span class="title">label</span> <span class="attribute">for</span>=<span class="value">"active"</span>&gt;</span>Active<span class="tag">&lt;/<span class="title">label</span>&gt;</span>
      <span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"checkbox"</span> <span class="attribute">name</span>=<span class="value">"active"</span> <span class="attribute">value</span>=<span class="value">"true"</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">div</span>&gt;</span>
    <span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"buttons"</span>&gt;</span>
      <span class="tag">&lt;<span class="title">button</span> <span class="attribute">type</span>=<span class="value">"submit"</span>&gt;</span>Create Product<span class="tag">&lt;/<span class="title">button</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">div</span>&gt;</span>
  <span class="tag">&lt;/<span class="title">form</span>&gt;</span>
}
</pre></td></tr></table></figure>

<h2 id="generating-html-forms">Generating HTML forms</h2>
<p>Play provides helpers, template snippets that can render a form field for you, including
extra information like an indication when the value is required and an error message
if the field has an invalid value. The helpers are in the <code>views.template</code> package.</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="code"><pre><span class="at_rule">@(productForm:<span class="preprocessor"> Form</span>[Product])

@<span class="function">main(<span class="string">"Product Form"</span>)</span> {</span>
  <span class="at_rule">@helper.<span class="function">form(action = routes.GeneratedForm.create)</span> {</span>
    <span class="at_rule">@helper.<span class="function">inputText(<span class="function">productForm(<span class="string">"name"</span>)</span>)</span>
    @helper.<span class="function">textarea(<span class="function">productForm(<span class="string">"description"</span>)</span>)</span>
    @helper.<span class="function">inputText(<span class="function">productForm(<span class="string">"ean"</span>)</span>)</span>
    @helper.<span class="function">inputText(<span class="function">productForm(<span class="string">"pieces"</span>)</span>)</span>
    @helper.<span class="function">checkbox(<span class="function">productForm(<span class="string">"active"</span>)</span>)</span>
    &lt;div<span class="preprocessor"> class</span>=<span class="string">"form-actions"</span>&gt;
      &lt;button<span class="preprocessor"> type</span>=<span class="string">"submit"</span>&gt;Create<span class="preprocessor"> Product</span>&lt;/button&gt;
    &lt;/div&gt;
  }
}</span>
</pre></td></tr></table></figure>

<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre>def createForm() = Action {
  Ok(views<span class="preprocessor">.html</span><span class="preprocessor">.products</span><span class="preprocessor">.form</span>(productForm))
}
</pre></td></tr></table></figure>

<h2 id="input-helpers">Input helpers</h2>
<p>Play ships predefined helpers for the most common input types:</p>
<ul>
<li>inputDate—Generates an input tag with type date .</li>
<li>inputPassword—Generates an input tag with type password.</li>
<li>inputFile—Generates an input tag with type file .</li>
<li>inputText—Generates an input tag with type text .</li>
<li>select—Generates a select tag.</li>
<li>inputRadioGroup—Generates a set of input tags with type radio.</li>
<li>checkbox—Generates an input tag with type checkbox.</li>
<li>textarea—Generates a textarea element.</li>
<li>input—Creates a custom input.</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
</pre></td><td class="code"><pre>@*  notation '_class creates a <span class="type">Scala</span> <span class="type">Symbol</span> named _class *@
@helper.inputText(productForm(<span class="string">"name"</span>), '_class -&gt; <span class="string">"important"</span>, 'size -&gt; <span class="number">40</span>)
</pre></td></tr></table></figure>

<p>These are the extra symbols with underscores that you can use:</p>
<ul>
<li><code>_label</code>—Use to set a custom label</li>
<li><code>_id</code>—Use to set the id attribute of the dl element</li>
<li><code>_class</code>—Use to set the class attribute of the dl element</li>
<li><code>_help</code>—Use to show custom help text</li>
<li><code>_showConstraints</code>—Set to false to hide the constraints on this field</li>
<li><code>_error</code>—Set to a <code>Some[FormError]</code> instance to show a custom error</li>
<li><code>_showErrors</code>—Set to false to hide the errors on this field</li>
</ul>
<h2 id="customizing-generated-html">Customizing generated HTML</h2>
<p>Play allows you to customize the generated HTML in two ways. First, you
can customize which input element is generated, in case you need some special input
type. Second, you can customize the HTML elements around that input element.</p>
<p>Suppose we want to create an input with type datetime.</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
</pre></td><td class="code"><pre>@* the first <span class="keyword">is</span> the Field that we want to create the input <span class="keyword">for</span> *@
<span class="property">@helper</span>.input<span class="function"><span class="params">(myForm(<span class="string">"mydatetime"</span>))</span> { <span class="params">(id, name, value, args)</span> =&gt;</span>
  @* a type <span class="function"><span class="params">(String, String, Option[String], Map[Symbol,Any])</span> =&gt;</span> Html *@
  &lt;input type=<span class="string">"datetime"</span> name=<span class="string">"@name"</span> id=<span class="string">"@id"</span> value=<span class="string">"@value"</span> <span class="property">@toHtmlArgs</span>(args)&gt;
}
</pre></td></tr></table></figure>

<p>We use the toHtmlArgs method from the <code>play.api.templates.PlayMagic</code>
object to construct additional attributes from the args map.</p>
<p>They have an additional parameter list that takes an implicit <code>FieldConstructor</code> and a <code>Lang</code>.</p>
<p><code>FieldConstructor</code> is a trait with a single apply method that takes a
<code>FieldElements</code> object and returns Html. Play provides a <code>defaultFieldConstructor</code>
that generates the HTML we saw earlier, but you can implement
your own <code>FieldConstructor</code> if you want different HTML.</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="code"><pre>@(elements: views.html.helper.FieldElements)

<span class="keyword">@import</span> play.api.i18n._
<span class="keyword">@import</span> views.html.helper._

&lt;div <span class="keyword">class</span>=<span class="string">"control-group @elements.args.get('_class)
  @if(elements.hasErrors) {error}"</span>
  id=<span class="string">"@elements.args.get('_id).getOrElse(elements.id + "</span>_field<span class="string">")"</span> &gt;
    &lt;label <span class="keyword">class</span>=<span class="string">"control-label"</span> <span class="keyword">for</span>=<span class="string">"@elements.id"</span>&gt;
      <span class="keyword">@elements</span>.label(elements.lang)
    &lt;/label&gt;
    &lt;div <span class="keyword">class</span>=<span class="string">"controls"</span>&gt;
      <span class="keyword">@elements</span>.input
      &lt;span <span class="keyword">class</span>=<span class="string">"help-inline"</span>&gt;
        <span class="keyword">@if</span>(elements.errors(elements.lang).nonEmpty) {
          <span class="keyword">@elements</span>.errors(elements.lang).mkString(<span class="string">", "</span>)
        } <span class="keyword">else</span> {
          <span class="keyword">@elements</span>.infos(elements.lang).mkString(<span class="string">", "</span>)
        }
      &lt;/span&gt;
    &lt;/div&gt;
&lt;/div&gt;
</pre></td></tr></table></figure>

<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
</pre></td><td class="code"><pre><span class="keyword">package</span> views.html.helper

<span class="keyword">package</span> <span class="class"><span class="keyword">object</span> <span class="title">bootstrap</span> {</span>
implicit <span class="keyword">val</span> fieldConstructor = <span class="keyword">new</span> FieldConstructor {
  <span class="keyword">def</span> apply(elements: FieldElements) =
    bootstrap.bootstrapFieldConstructor(elements)
  }
}
</pre></td></tr></table></figure>

<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="code"><pre><span class="at_rule">@(productForm:<span class="preprocessor"> Form</span>[Product])
@<span class="keyword">import</span><span class="preprocessor"> views.html.helper.bootstrap._</span>
@<span class="function">main(<span class="string">"Product Form"</span>)</span> {</span>
  <span class="at_rule">@helper.<span class="function">form(action = routes.GeneratedForm.create)</span> {</span>
    <span class="at_rule">@helper.<span class="function">inputText(<span class="function">productForm(<span class="string">"name"</span>)</span>)</span>
    @helper.<span class="function">textarea(<span class="function">productForm(<span class="string">"description"</span>)</span>)</span>
    @helper.<span class="function">inputText(<span class="function">productForm(<span class="string">"ean"</span>)</span>)</span>
    @helper.<span class="function">inputText(<span class="function">productForm(<span class="string">"pieces"</span>)</span>)</span>
    @helper.<span class="function">checkbox(<span class="function">productForm(<span class="string">"active"</span>)</span>)</span>
    &lt;div<span class="preprocessor"> class</span>=<span class="string">"form-actions"</span>&gt;
      &lt;button<span class="preprocessor"> type</span>=<span class="string">"submit"</span>&gt;Create<span class="preprocessor"> Product</span>&lt;/button&gt;
    &lt;/div&gt;
  }
}</span>
</pre></td></tr></table></figure>

<h1 id="validation-and-advanced-mappings">Validation and advanced mappings</h1>
  
	</div>
		<footer class="article-footer clearfix">

  <div class="article-tags">
  
  <span></span> <a href="/tags/scala/">scala</a><a href="/tags/play/">play</a>
  </div>




<div class="article-share" id="share">

  <div data-url="http://zhpooer.github.io/2014/08/12/play-for-scala-input-with-forms/" data-title="Play for Scala-Input with forms | Poe&#39;s World" data-tsina="null" class="share clearfix">
  </div>

</div>
</footer>   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2014/08/12/mit-algorithm-算法分析/" title="MIT Algorithm-算法分析">
  <strong>PREVIOUS:</strong><br/>
  <span>
  MIT Algorithm-算法分析</span>
</a>
</div>


<div class="next">
<a href="/2014/08/12/play-for-scala-view-template/"  title="Play for Scala-View Template">
 <strong>NEXT:</strong><br/> 
 <span>Play for Scala-View Template
</span>
</a>
</div>

</nav>

	
<section class="comment">
	<div class="ds-thread"></div>
</section>

</div>  
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">文章目录</strong>
  <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#forms-the-concept"><span class="toc-number">1.</span> <span class="toc-text">Forms—the concept</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#forms-basics"><span class="toc-number">2.</span> <span class="toc-text">Forms basics</span></a></li><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#mappings"><span class="toc-number">2.1.</span> <span class="toc-text">Mappings</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#creating-a-form"><span class="toc-number">2.2.</span> <span class="toc-text">Creating a form</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#processing-data-with-a-form"><span class="toc-number">2.3.</span> <span class="toc-text">Processing data with a form</span></a></li><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#either"><span class="toc-number">2.3.1.</span> <span class="toc-text">Either</span></a></li></ol><li class="toc-item toc-level-2"><a class="toc-link" href="#object-mapping"><span class="toc-number">2.4.</span> <span class="toc-text">Object mapping</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mapping-http-request-data"><span class="toc-number">2.5.</span> <span class="toc-text">Mapping HTTP request data</span></a></li></ol><li class="toc-item toc-level-1"><a class="toc-link" href="#creating-and-processing-html-forms"><span class="toc-number">3.</span> <span class="toc-text">Creating and processing HTML forms</span></a></li><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#writing-html-forms-manually"><span class="toc-number">3.1.</span> <span class="toc-text">Writing HTML forms manually</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#generating-html-forms"><span class="toc-number">3.2.</span> <span class="toc-text">Generating HTML forms</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#input-helpers"><span class="toc-number">3.3.</span> <span class="toc-text">Input helpers</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#customizing-generated-html"><span class="toc-number">3.4.</span> <span class="toc-text">Customizing generated HTML</span></a></li></ol><li class="toc-item toc-level-1"><a class="toc-link" href="#validation-and-advanced-mappings"><span class="toc-number">4.</span> <span class="toc-text">Validation and advanced mappings</span></a></li></ol>
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  

  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			<li><a href="/tags/AJAX/" title="AJAX">AJAX<sup>1</sup></a></li>
		
			<li><a href="/tags/Akka/" title="Akka">Akka<sup>1</sup></a></li>
		
			<li><a href="/tags/DOM/" title="DOM">DOM<sup>2</sup></a></li>
		
			<li><a href="/tags/EL表达式/" title="EL表达式">EL表达式<sup>1</sup></a></li>
		
			<li><a href="/tags/Hadoop/" title="Hadoop">Hadoop<sup>1</sup></a></li>
		
			<li><a href="/tags/Hibernate/" title="Hibernate">Hibernate<sup>2</sup></a></li>
		
			<li><a href="/tags/HttpSession/" title="HttpSession">HttpSession<sup>1</sup></a></li>
		
			<li><a href="/tags/IO/" title="IO">IO<sup>1</sup></a></li>
		
			<li><a href="/tags/JSP/" title="JSP">JSP<sup>1</sup></a></li>
		
			<li><a href="/tags/JavaBean/" title="JavaBean">JavaBean<sup>1</sup></a></li>
		
			<li><a href="/tags/JavaScript/" title="JavaScript">JavaScript<sup>1</sup></a></li>
		
			<li><a href="/tags/Mybatis/" title="Mybatis">Mybatis<sup>1</sup></a></li>
		
			<li><a href="/tags/NoSql/" title="NoSql">NoSql<sup>1</sup></a></li>
		
			<li><a href="/tags/SAX/" title="SAX">SAX<sup>1</sup></a></li>
		
			<li><a href="/tags/ServletRequest/" title="ServletRequest">ServletRequest<sup>1</sup></a></li>
		
			<li><a href="/tags/ServletResponse/" title="ServletResponse">ServletResponse<sup>1</sup></a></li>
		
			<li><a href="/tags/Spring/" title="Spring">Spring<sup>1</sup></a></li>
		
			<li><a href="/tags/Spring MVC/" title="Spring MVC">Spring MVC<sup>1</sup></a></li>
		
			<li><a href="/tags/String/" title="String">String<sup>1</sup></a></li>
		
			<li><a href="/tags/StringBuffer/" title="StringBuffer">StringBuffer<sup>1</sup></a></li>
		
		</ul>
</div>


  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 订阅</a>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<div class="social-font" class="clearfix">
		
		
		
		
	</div>
		<p class="copyright">Powered by <a href="http://zespia.tw/hexo/" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/A-limon/pacman" target="_blank" title="Pacman">Pacman</a> © 2014 
		
		<a href="http://zhpooer.github.io" target="_blank" title="zhpooer">zhpooer</a>
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.1.0.min.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else
    {
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      h  = $('article h2')
      ah = $('article h2'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  if(ah.length==0){
    t.css('display','none');
  }else{
    c.click(function(){
      ta.css('display', 'block').addClass('fadeIn');
    });
    o.click(function(){
      ta.css('display', 'none');
    });
    $(window).scroll(function(){
      ta.css("top",Math.max(140,320-$(this).scrollTop()));
    });
  };
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina');
  var html = [
  '<a href="#" class="overlay" id="qrcode"></a>',
  '<div class="qrcode clearfix"><span>扫描二维码分享到微信朋友圈</span><a class="qrclose" href="#share"></a><strong>Loading...Please wait</strong><img id="qrcode-pic" data-src="http://s.jiathis.com/qrcode.php?url=' + encodedUrl + '"/></div>',
  '<a href="#textlogo" class="article-back-to-top" title="Top"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="QRcode"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="Weibo"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);
  $('.article-share-qrcode').click(function(){
    var imgSrc = $('#qrcode-pic').attr('data-src');
    $('#qrcode-pic').attr('src', imgSrc);
    $('#qrcode-pic').load(function(){
        $('.qrcode strong').text(' ');
    });
  });
});     
</script>


<script type="text/javascript">
  var duoshuoQuery = {short_name:"zhpoooer"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script> 





  </body>
</html>
