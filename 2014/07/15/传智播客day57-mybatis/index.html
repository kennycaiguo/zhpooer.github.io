
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  
    <title>传智播客day57-Mybatis | Poe&#39;s World</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=3, minimum-scale=1">
    
    <meta name="author" content="zhpooer">
    
    <meta name="description" content="概况

mybatis配置

SqlMapConfig.xml，此文件作为mybatis的全局配置文件，配置了mybatis的运行环境等信息。
mapper.xml文件即sql映射文件，文件中配置了操作数据库的sql语句。
此文件需要在SqlMapConfig.xml中加载。
通过mybatis环境">
    
    
    
    
    <link rel="alternative" href="/atom.xml" title="Poe&#39;s World" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/pacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/pacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>

  <body>
    <header>
      <div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.svg" alt="Poe&#39;s World" title="Poe&#39;s World"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="Poe&#39;s World">Poe&#39;s World</a></h1>
				<h2 class="blog-motto">竹杖芒鞋轻胜马，一蓑烟雨任平生</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">主页</a></li>
					
						<li><a href="/english-monthly">英语角</a></li>
					
						<li><a href="/about">关于</a></li>
					
						<li><a href="/archives">归档</a></li>
					
					<li>
					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="text" id="search" name="q" autocomplete="off" maxlength="20" placeholder="搜索" />
						<input type="hidden" name="q" value="site:zhpooer.github.io">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>

    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2014/07/15/传智播客day57-mybatis/" title="传智播客day57-Mybatis" itemprop="url">传智播客day57-Mybatis</a>
  </h1>
  <p class="article-author">By
    
      <a href="http://zhpooer.github.io" title="zhpooer">zhpooer</a>
    </p>
  <p class="article-time">
    <time datetime="2014-07-15T01:12:17.000Z" itemprop="datePublished">7月 15 2014</time>
    更新日期:<time datetime="2014-07-15T13:12:57.000Z" itemprop="dateModified">7月 15 2014</time>
    
  </p>
</header>
	<div class="article-content">
		
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">文章目录</strong>
		<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#-"><span class="toc-number">1.</span> <span class="toc-text">概况</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#demo"><span class="toc-number">2.</span> <span class="toc-text">Demo</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#api-"><span class="toc-number">3.</span> <span class="toc-text">API 介绍</span></a></li><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#sqlsessionfactorybuilder"><span class="toc-number">3.1.</span> <span class="toc-text">SqlSessionFactoryBuilder</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sqlsessionfactory"><span class="toc-number">3.2.</span> <span class="toc-text">SqlSessionFactory</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sqlsession"><span class="toc-number">3.3.</span> <span class="toc-text">SqlSession</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#namespace"><span class="toc-number">3.4.</span> <span class="toc-text">Namespace</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mapper-"><span class="toc-number">3.5.</span> <span class="toc-text">Mapper 接口</span></a></li></ol><li class="toc-item toc-level-1"><a class="toc-link" href="#-"><span class="toc-number">4.</span> <span class="toc-text">配置详解</span></a></li><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#properties"><span class="toc-number">4.1.</span> <span class="toc-text">properties</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#settings"><span class="toc-number">4.2.</span> <span class="toc-text">settings</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#-"><span class="toc-number">4.3.</span> <span class="toc-text">别名</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#-"><span class="toc-number">4.4.</span> <span class="toc-text">类型处理器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#environments-"><span class="toc-number">4.5.</span> <span class="toc-text">environments(环境集合属性对象)</span></a></li><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#databaseidprovider-id-"><span class="toc-number">4.5.1.</span> <span class="toc-text">databaseIdProvider(数据库ID提供者)</span></a></li></ol><li class="toc-item toc-level-2"><a class="toc-link" href="#-mapper-"><span class="toc-number">4.6.</span> <span class="toc-text">指定mapper文件位置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mapper-xml"><span class="toc-number">4.7.</span> <span class="toc-text">Mapper.xml</span></a></li></ol>
		</div>
		
		<h1 id="-">概况</h1>
<p><img src="/img/mybatis_api.png" alt="mybatis api"></p>
<p>mybatis配置</p>
<ol>
<li>SqlMapConfig.xml，此文件作为mybatis的全局配置文件，配置了mybatis的运行环境等信息。</li>
<li>mapper.xml文件即sql映射文件，文件中配置了操作数据库的sql语句。
此文件需要在SqlMapConfig.xml中加载。</li>
<li>通过mybatis环境等配置信息构造SqlSessionFactory即会话工厂</li>
<li>由会话工厂创建sqlSession即会话，操作数据库需要通过sqlSession进行。</li>
<li>mybatis底层自定义了Executor接口操作数据库，
Executor接口有两个实现，一个是基本实现一个是缓存实现。</li>
<li>Mapped Statement也是mybatis一个底层对象，
它包装了mybatis配置信息及sql映射信息等。
mapper.xml文件中一个sql对应一个Mapped Statement对象，sql的id即是Mapped statement的id。</li>
<li>Mapped Statement对sql执行输入参数进行定义，包括HashMap、基本类型、pojo，
Executor通过 Mapped Statement在执行sql前将输入的java对象映射至sql中，
输入参数映射就是jdbc编程中对preparedStatement设置参数。</li>
<li>Mapped Statement对sql执行输出结果进行定义，包括HashMap、基本类型、pojo，
Executor通过 Mapped Statement在执行sql后将输出结果映射至java对象中，
输出结果映射过程相当于jdbc编程中对结果的解析处理过程。</li>
</ol>
<h1 id="demo">Demo</h1>
<p>log4j.properties</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
</pre></td><td class="code"><pre><span class="preprocessor"># Global logging configuration</span>
log4j<span class="preprocessor">.rootLogger</span>=DEBUG, stdout
<span class="preprocessor"># Console output...</span>
log4j<span class="preprocessor">.appender</span><span class="preprocessor">.stdout</span>=org<span class="preprocessor">.apache</span><span class="preprocessor">.log</span>4j<span class="preprocessor">.ConsoleAppender</span>
log4j<span class="preprocessor">.appender</span><span class="preprocessor">.stdout</span><span class="preprocessor">.layout</span>=org<span class="preprocessor">.apache</span><span class="preprocessor">.log</span>4j<span class="preprocessor">.PatternLayout</span>
log4j<span class="preprocessor">.appender</span><span class="preprocessor">.stdout</span><span class="preprocessor">.layout</span><span class="preprocessor">.ConversionPattern</span>=%<span class="number">5</span>p [%t] - %m%n
</pre></td></tr></table></figure>

<p>SqlMapConfig.xml是mybatis核心配置文件，上边文件的配置内容为数据源、事务管理</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="code"><pre><span class="tag">&lt;<span class="title">configuration</span>&gt;</span>
    <span class="tag">&lt;<span class="title">environments</span> <span class="attribute">default</span>=<span class="value">"development"</span>&gt;</span>
        <span class="tag">&lt;<span class="title">environment</span> <span class="attribute">id</span>=<span class="value">"development"</span>&gt;</span>
            <span class="comment">&lt;!-- 配置事务  --&gt;</span>
            <span class="tag">&lt;<span class="title">transactionManager</span> <span class="attribute">type</span>=<span class="value">"JDBC"</span>/&gt;</span>
            <span class="tag">&lt;<span class="title">dataSource</span> <span class="attribute">type</span>=<span class="value">"POOLED"</span>&gt;</span>
			    <span class="tag">&lt;<span class="title">property</span> <span class="attribute">name</span>=<span class="value">"driver"</span> <span class="attribute">value</span>=<span class="value">"com.mysql.jdbc.Driver"</span> /&gt;</span>
			    <span class="tag">&lt;<span class="title">property</span> <span class="attribute">name</span>=<span class="value">"url"</span> <span class="attribute">value</span>=<span class="value">"jdbc:mysql://localhost:3306/mybatis?characterEncoding=utf-8"</span> /&gt;</span>
			    <span class="tag">&lt;<span class="title">property</span> <span class="attribute">name</span>=<span class="value">"username"</span> <span class="attribute">value</span>=<span class="value">"root"</span> /&gt;</span>
			    <span class="tag">&lt;<span class="title">property</span> <span class="attribute">name</span>=<span class="value">"password"</span> <span class="attribute">value</span>=<span class="value">"mysql"</span> /&gt;</span>
			<span class="tag">&lt;/<span class="title">dataSource</span>&gt;</span>
        <span class="tag">&lt;/<span class="title">environment</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">environments</span>&gt;</span>
    <span class="tag">&lt;<span class="title">mappers</span>&gt;</span>
        <span class="tag">&lt;<span class="title">mapper</span> <span class="attribute">resource</span>=<span class="value">"sqlmap/User.xml"</span>&gt;</span><span class="tag">&lt;/<span class="title">mapper</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">mappers</span>&gt;</span>
<span class="tag">&lt;/<span class="title">configuration</span>&gt;</span>
</pre></td></tr></table></figure>

<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre></td><td class="code"><pre><span class="comment">&lt;!-- User.xml --&gt;</span>
<span class="tag">&lt;<span class="title">mapper</span> <span class="attribute">namespace</span>=<span class="value">"test"</span>&gt;</span>
    <span class="comment">&lt;!-- 根据用户账号查询单个用户信息
         将定义的select 理解为一个sql, 这个sql对应statement
         可以将sql的id理解为statement的id--&gt;</span>
    <span class="tag">&lt;<span class="title">select</span> <span class="attribute">id</span>=<span class="value">"findUserById"</span> <span class="attribute">parameterType</span>=<span class="value">"java.lang.Integer"</span> <span class="attribute">resultType</span>=<span class="value">"po.User"</span>&gt;</span>
       select * from user where id=#{id}
    <span class="tag">&lt;/<span class="title">select</span>&gt;</span>
    <span class="tag">&lt;<span class="title">insert</span> <span class="attribute">id</span>=<span class="value">"insertUser"</span> <span class="attribute">parameterType</span>=<span class="value">"po.User"</span>&gt;</span>
        <span class="comment">&lt;!-- 指定主键映射的pojo对象的属性  --&gt;</span>
        <span class="comment">&lt;!-- order selectKey, 的执行顺序 --&gt;</span>
        <span class="comment">&lt;!-- 一般不用自增, 而是用 uuid --&gt;</span>
        <span class="tag">&lt;<span class="title">selectKey</span> <span class="attribute">keyProperty</span>=<span class="value">"id"</span> <span class="attribute">order</span>=<span class="value">"AFTER"</span> <span class="attribute">resultType</span>=<span class="value">"java.lang.Integer"</span>&gt;</span>
            select last_insert_id()
        <span class="tag">&lt;/<span class="title">selectKey</span>&gt;</span>
        insert into user(username, birthday, sex, address, detail, score)
        values(#{username}, #{birthday}, #{sex}, #{address}, #{detail}, #{score})
    <span class="tag">&lt;/<span class="title">insert</span>&gt;</span>
    <span class="tag">&lt;<span class="title">update</span> <span class="attribute">id</span>=<span class="value">"updateUserUserById"</span> <span class="attribute">parameterType</span>=<span class="value">"po.User"</span>&gt;</span>
        update user set username=#{username}, birthday=#{birthday},
        sex=#{sex}, address=#{address}, detail=#{detail}, score=#{score}
        where id=#{id}
    <span class="tag">&lt;/<span class="title">update</span>&gt;</span>
    <span class="tag">&lt;<span class="title">delete</span> <span class="attribute">id</span>=<span class="value">"deleteUserById"</span> <span class="attribute">parameterType</span>=<span class="value">"java.lang.Integer"</span>&gt;</span>
        delete from user where id=#{value}
    <span class="tag">&lt;/<span class="title">delete</span>&gt;</span>
<span class="tag">&lt;/<span class="title">mapper</span>&gt;</span>
</pre></td></tr></table></figure>

<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="code"><pre>String resource = "sqlMapConfig.xml";
// 通过输入流读取配置文件
InputStream inputStream = Resources.getResourceAsStream(resource);

// 通过sqlSessionFactoryBuilder, 获取SqlSessonFactory
SqlSessoinFactory fac = new SqlSessionFactoryBuilder().build(inputStream);
SqlSession session = fac.openSession();

// 查询用户
// 命名空间 + id
User user = session.selectOne("test.findUserById", 1);

// 插入数据
session.<span class="operator"><span class="keyword">insert</span>(<span class="string">"test.insertUser"</span>, <span class="keyword">user</span>);</span>
sqlSession.<span class="operator"><span class="keyword">commit</span>();</span> // 提交事务

// 更新记录
session.<span class="operator"><span class="keyword">update</span>(<span class="string">"test.updateUserById"</span>, <span class="keyword">user</span>);</span>
sqlSession.<span class="operator"><span class="keyword">commit</span>();</span> // 提交事务

// 删除记录
session.<span class="operator"><span class="keyword">delete</span>(<span class="string">"test.deleteUserById"</span>, <span class="keyword">user</span>);</span>
sqlSession.<span class="operator"><span class="keyword">commit</span>();</span> // 提交事务

session.close();
</pre></td></tr></table></figure>

<h1 id="api-">API 介绍</h1>
<h2 id="sqlsessionfactorybuilder">SqlSessionFactoryBuilder</h2>
<p>SqlSessionFacoty是通过SqlSessionFactoryBuilder进行创建，
SqlSessionFactoryBuilder只用于创建SqlSessionFactory，
可以当成一个工具类，在使用时随时拿来使用不需要特殊处理为共享对象。</p>
<h2 id="sqlsessionfactory">SqlSessionFactory</h2>
<p>SqlSessionFactory是一个接口，
接口中定义了openSession的不同方式，
mybatis默认使用DefaultSqlSessionFactory作为接口实现，
SqlSessionFactory一但创建后可以重复使用，实际应用时通常设计为单例模式。</p>
<h2 id="sqlsession">SqlSession</h2>
<p>SqlSession是一个接口，定义了数据库操作。</p>
<p>执行过程如下：</p>
<ul>
<li>加载数据源等配置信息
<code>Environment environment = configuration.getEnvironment();</code></li>
<li>创建数据库链接</li>
<li>创建事务对象</li>
<li><p>创建Executor，SqlSession所有操作都是通过Executor完成，mybatis源码如下：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
</pre></td><td class="code"><pre><span class="keyword">if</span> (ExecutorType.BATCH == executorType) {
    executor = <span class="keyword">new</span> BatchExecutor(<span class="keyword">this</span>, transaction);
} <span class="keyword">else</span> <span class="keyword">if</span> (ExecutorType.REUSE == executorType) {
    executor = <span class="keyword">new</span> ReuseExecutor(<span class="keyword">this</span>, transaction);
} <span class="keyword">else</span> {
    executor = <span class="keyword">new</span> SimpleExecutor(<span class="keyword">this</span>, transaction);
}
<span class="keyword">if</span> (cacheEnabled) {
    executor = <span class="keyword">new</span> CachingExecutor(executor, autoCommit);
}
</pre></td></tr></table></figure>
</li>
<li><p>SqlSession的实现类即DefaultSqlSession，此对象中对操作数据库实质上用的是 Executor</p>
</li>
</ul>
<p>结论：每个线程都应该有它自己的SqlSession实例。
SqlSession的实例不能共享使用，它也是线程不安全的。
因此最佳的范围是请求或方法范围。
绝对不能将SqlSession实例的引用放在一个类的静态字段甚至是实例字段中。</p>
<h2 id="namespace">Namespace</h2>
<p>命名空间除了对sql进行隔离，mybatis中对命名空间有特殊的作用，
用于定义mapper接口地址</p>
<h2 id="mapper-">Mapper 接口</h2>
<p>// 原生实现</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre></td><td class="code"><pre><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserDao</span> {</span>
    <span class="keyword">public</span> User <span class="title">findUserById</span>(String id);
    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">inserUser</span>(User user);
    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">pudateUserById</span>(User user);
    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteUserById</span>(String id);
}
<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDaoImpl</span> <span class="keyword">implements</span> <span class="title">UserDao</span> {</span>
    <span class="keyword">private</span> SqlSessionFactory fac;
    
    <span class="keyword">public</span> User <span class="title">findUserById</span>(String id){
        SqlSession session = fac.openSession();
        User u = session.selectOne(<span class="string">"test.selectUserById"</span>, <span class="number">1</span>);
        session.close();
    }
    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">inserUser</span>(User user){
        SqlSession session = fac.openSession();
        User u = session.insert(<span class="string">"test.insertUser"</span>, user);
        session.commit();
        session.close();
    }
    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">pudateUserById</span>(User user){
        SqlSession session = fac.openSession();
        session.update(<span class="string">"test.updateUser"</span>, user);
        session.commit();
        session.close();
    }
    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteUserById</span>(String id){
        SqlSession session = fac.openSession();
        session.update(<span class="string">"test.deleteUserById"</span>, i);
        session.commit();
        session.close();
    }
}
</pre></td></tr></table></figure>

<p>第一个例子中，在访问sql映射文件中定义的sql时需要调用sqlSession的selectOne
方法，并将sql的位置(命名空间+id)和参数传递到selectOne方法中，
且第一个参数是一个长长的字符串，第二个参数是一个object对象，
这对于程序编写有很大的不方便，很多问题无法在编译阶段发现。
虽然上边对提出的面向接口编程问题进行解决，
但是dao实现方法中仍然是调用sqlSession的selectOne方法，且重复代码多。</p>
<p>解决方法:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="code"><pre><span class="comment">// 将 namespace 修改为 cn.mapper.UserMapper</span>
<span class="keyword">public</span> <span class="keyword">interface</span> UserMapper {
    <span class="keyword">public</span> User <span class="title">findUserById</span>(String id);
    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">inserUser</span>(User user);
    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">pudateUserById</span>(User user);
    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteUserById</span>(String id);
}

<span class="keyword">public</span> <span class="keyword">void</span> testFindUserById {
    sqlSession sqlSession = sqlSessionFactory.openSession();
    <span class="comment">// 指定mapper接口类型, mybatis生成一个代码对象实现mapper接口</span>
    UserMapper userMapper = sqlSessioin.getMapper(UserMapper.class);
    userMapper.findUserById(<span class="number">1</span>);
}
</pre></td></tr></table></figure>

<ul>
<li>Mapper接口方法名和mapper.xml中定义的每个sql的id相同</li>
<li>Mapper接口方法的输入参数类型和mapper.xml中定义的每个sql 的parameterType的类型相同</li>
<li>Mapper接口方法的输出参数类型和mapper.xml中定义的每个sql的resultType的类型相同</li>
<li>Mapper.xml文件中的namespace即是mapper接口的类路径。</li>
</ul>
<h1 id="-">配置详解</h1>
<h2 id="properties">properties</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
</pre></td><td class="code"><pre><span class="preprocessor"># db.properties</span>
driver=<span class="keyword">com</span><span class="preprocessor">.mysql</span><span class="preprocessor">.jdbc</span><span class="preprocessor">.Driver</span>
url=jdbc:mysql://localhost:<span class="number">3306</span>/mybatis
username=root
password=mysql
</pre></td></tr></table></figure>

<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="code"><pre><span class="tag">&lt;<span class="title">properties</span> <span class="attribute">resource</span>=<span class="value">"db.properties"</span> /&gt;</span>
<span class="tag">&lt;<span class="title">environments</span> <span class="attribute">default</span>=<span class="value">"development"</span>&gt;</span>
    <span class="tag">&lt;<span class="title">environment</span> <span class="attribute">id</span>=<span class="value">"development"</span>&gt;</span>
        <span class="tag">&lt;<span class="title">transactionManager</span> <span class="attribute">type</span>=<span class="value">"JDBC"</span> /&gt;</span>
        <span class="tag">&lt;<span class="title">dataSource</span> <span class="attribute">type</span>=<span class="value">"POOLED"</span>&gt;</span>
            <span class="tag">&lt;<span class="title">property</span> <span class="attribute">name</span>=<span class="value">"driver"</span> <span class="attribute">value</span>=<span class="value">"${driver}"</span> /&gt;</span>
            <span class="tag">&lt;<span class="title">property</span> <span class="attribute">name</span>=<span class="value">"url"</span> <span class="attribute">value</span>=<span class="value">"${url}"</span> /&gt;</span>
            <span class="tag">&lt;<span class="title">property</span> <span class="attribute">name</span>=<span class="value">"username"</span> <span class="attribute">value</span>=<span class="value">"${username}"</span> /&gt;</span>
            <span class="tag">&lt;<span class="title">property</span> <span class="attribute">name</span>=<span class="value">"password"</span> <span class="attribute">value</span>=<span class="value">"${password}"</span> /&gt;</span>
        <span class="tag">&lt;/<span class="title">dataSource</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">environment</span>&gt;</span>
<span class="tag">&lt;/<span class="title">environments</span>&gt;</span>
</pre></td></tr></table></figure>

<h2 id="settings">settings</h2>
<p>全局配置参数, 会影响到 mybatis 的运行行为</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
</pre></td><td class="code"><pre><span class="tag">&lt;<span class="title">configuration</span>&gt;</span>
    <span class="tag">&lt;<span class="title">settings</span>&gt;</span>
        <span class="tag">&lt;<span class="title">setting</span> <span class="attribute">name</span>=<span class="value">"cacheEnabled"</span> <span class="attribute">value</span>=<span class="value">"false"</span>/&gt;</span>
    <span class="tag">&lt;/<span class="title">settings</span>&gt;</span>
<span class="tag">&lt;/<span class="title">configuration</span>&gt;</span>
</pre></td></tr></table></figure>

<h2 id="-">别名</h2>
<table>
<thead>
<tr>
<th>别名</th>
<th>映射的类型</th>
</tr>
</thead>
<tbody>
<tr>
<td>_byte</td>
<td>byte</td>
</tr>
<tr>
<td>_long</td>
<td>long</td>
</tr>
<tr>
<td>_short</td>
<td>short</td>
</tr>
<tr>
<td>_int</td>
<td>int</td>
</tr>
<tr>
<td>_integer</td>
<td>int</td>
</tr>
<tr>
<td>_double</td>
<td>double</td>
</tr>
<tr>
<td>_float</td>
<td>float</td>
</tr>
<tr>
<td>_boolean</td>
<td>boolean</td>
</tr>
<tr>
<td>string</td>
<td>String</td>
</tr>
<tr>
<td>byte</td>
<td>Byte</td>
</tr>
<tr>
<td>long</td>
<td>Long</td>
</tr>
<tr>
<td>short</td>
<td>Short</td>
</tr>
<tr>
<td>int</td>
<td>Integer</td>
</tr>
<tr>
<td>integer</td>
<td>Integer</td>
</tr>
<tr>
<td>double</td>
<td>Double</td>
</tr>
<tr>
<td>float</td>
<td>Float</td>
</tr>
<tr>
<td>boolean</td>
<td>Boolean</td>
</tr>
<tr>
<td>date</td>
<td>Date</td>
</tr>
<tr>
<td>decimal</td>
<td>BigDecimal</td>
</tr>
<tr>
<td>bigdecimal</td>
<td>BigDecimal</td>
</tr>
</tbody>
</table>
<p>定义别名</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
</pre></td><td class="code"><pre><span class="tag">&lt;<span class="title">typeAliases</span>&gt;</span>
    <span class="tag">&lt;<span class="title">typeAlias</span> <span class="attribute">alias</span>=<span class="value">"user"</span> <span class="attribute">type</span>=<span class="value">"cn.itcast.mybatis.po.User"</span>&gt;</span><span class="tag">&lt;/<span class="title">typeAlias</span>&gt;</span>
    <span class="comment">&lt;!-- 批量别名定义，扫描整个包下的类 --&gt;</span>
	<span class="tag">&lt;<span class="title">package</span> <span class="attribute">name</span>=<span class="value">"cn.itcast.mybatis.po"</span>/&gt;</span>
    <span class="comment">&lt;!-- 就可以使用 po.User -&gt; user --&gt;</span>
<span class="tag">&lt;/<span class="title">typeAliases</span>&gt;</span>
</pre></td></tr></table></figure>

<p>使用注解方式</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre>@Alias(<span class="string">"user"</span>)
<span class="keyword">public</span> <span class="keyword">class</span> User{
}
</pre></td></tr></table></figure>

<h2 id="-">类型处理器</h2>
<p>将java类型和 sql 映射文件进行映射,
mybatis自带的类型处理器基本上满足日常需求，不需要单独定义。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
</pre></td><td class="code"><pre><span class="comment">&lt;!-- parameterType：指定输入数据类型为int，即向statement设置值 --&gt;</span>
<span class="comment">&lt;!-- resultType：指定输出数据类型为自定义User，即将resultset转为java对象 --&gt;</span>
<span class="tag">&lt;<span class="title">select</span> <span class="attribute">id</span>=<span class="value">"selectUserById"</span> <span class="attribute">parameterType</span>=<span class="value">"int"</span> <span class="attribute">resultType</span>=<span class="value">"user"</span>&gt;</span>
    select * from user where id = #{id}
<span class="tag">&lt;/<span class="title">select</span>&gt;</span>
</pre></td></tr></table></figure>

<h2 id="environments-">environments(环境集合属性对象)</h2>
<p>MyBatis可以配置多种环境. 这会帮助你将SQL映射应用于多种数据库之中.</p>
<p>多数据库配置</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td><td class="code"><pre><span class="tag">&lt;<span class="title">environments</span> <span class="attribute">default</span>=<span class="value">"development"</span>&gt;</span>
    <span class="tag">&lt;<span class="title">environment</span> <span class="attribute">id</span>=<span class="value">"development_mysql"</span>&gt;</span>
        <span class="tag">&lt;<span class="title">transactionManager</span> <span class="attribute">type</span>=<span class="value">"JDBC"</span> /&gt;</span>
        <span class="tag">&lt;<span class="title">dataSource</span> <span class="attribute">type</span>=<span class="value">"POOLED"</span>&gt;</span>
            <span class="tag">&lt;<span class="title">property</span> <span class="attribute">name</span>=<span class="value">"driver"</span> <span class="attribute">value</span>=<span class="value">"${mysql.driver}"</span> /&gt;</span>
            <span class="tag">&lt;<span class="title">property</span> <span class="attribute">name</span>=<span class="value">"url"</span> <span class="attribute">value</span>=<span class="value">"${mysql.url}"</span> /&gt;</span>
            <span class="tag">&lt;<span class="title">property</span> <span class="attribute">name</span>=<span class="value">"username"</span> <span class="attribute">value</span>=<span class="value">"${mysql.username}"</span> /&gt;</span>
            <span class="tag">&lt;<span class="title">property</span> <span class="attribute">name</span>=<span class="value">"password"</span> <span class="attribute">value</span>=<span class="value">"${mysql.password}"</span> /&gt;</span>
        <span class="tag">&lt;/<span class="title">dataSource</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">environment</span>&gt;</span>
        <span class="tag">&lt;<span class="title">environment</span> <span class="attribute">id</span>=<span class="value">"development_oracle"</span>&gt;</span>
        <span class="tag">&lt;<span class="title">transactionManager</span> <span class="attribute">type</span>=<span class="value">"JDBC"</span> /&gt;</span>
        <span class="tag">&lt;<span class="title">dataSource</span> <span class="attribute">type</span>=<span class="value">"POOLED"</span>&gt;</span>
            <span class="tag">&lt;<span class="title">property</span> <span class="attribute">name</span>=<span class="value">"driver"</span> <span class="attribute">value</span>=<span class="value">"${oracle.driver}"</span> /&gt;</span>
            <span class="tag">&lt;<span class="title">property</span> <span class="attribute">name</span>=<span class="value">"url"</span> <span class="attribute">value</span>=<span class="value">"${oracle.url}"</span> /&gt;</span>
            <span class="tag">&lt;<span class="title">property</span> <span class="attribute">name</span>=<span class="value">"username"</span> <span class="attribute">value</span>=<span class="value">"${oracle.username}"</span> /&gt;</span>
            <span class="tag">&lt;<span class="title">property</span> <span class="attribute">name</span>=<span class="value">"password"</span> <span class="attribute">value</span>=<span class="value">"${oracle.password}"</span> /&gt;</span>
        <span class="tag">&lt;/<span class="title">dataSource</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">environment</span>&gt;</span>
<span class="tag">&lt;/<span class="title">environments</span>&gt;</span>
</pre></td></tr></table></figure>

<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
</pre></td><td class="code"><pre>mysql<span class="preprocessor">.driver</span>=<span class="keyword">com</span><span class="preprocessor">.mysql</span><span class="preprocessor">.jdbc</span><span class="preprocessor">.Driver</span>
mysql<span class="preprocessor">.url</span>=jdbc:mysql://localhost:<span class="number">3306</span>/mybatis
mysql<span class="preprocessor">.username</span>=root
mysql<span class="preprocessor">.password</span>=mysql

oracle<span class="preprocessor">.driver</span>=oracle<span class="preprocessor">.jdbc</span><span class="preprocessor">.driver</span><span class="preprocessor">.OracleDriver</span>
oracle<span class="preprocessor">.url</span>=jdbc:oracle:thin:<span class="localvars">@127</span><span class="number">.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">1521</span>:yycg
oracle<span class="preprocessor">.username</span>=yycg
oracle<span class="preprocessor">.password</span>=yycg
</pre></td></tr></table></figure>

<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre><span class="comment">// 需要用到 oracle 数据库</span>
sqlSessionFactory_oracle = <span class="keyword">new</span> SqlSessionFactoryBuilder()
    .build(Resources.getResourceAsStream(resource), <span class="string">"development_oracle"</span>);
</pre></td></tr></table></figure>

<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="code"><pre><span class="tag">&lt;<span class="title">mapper</span>&gt;</span>
    <span class="comment">&lt;!-- 只对 mysql 有效 --&gt;</span>
    <span class="tag">&lt;<span class="title">select</span> <span class="attribute">id</span>=<span class="value">"getNow"</span> <span class="attribute">resultType</span>=<span class="value">"date"</span>&gt;</span>
        select now()
    <span class="tag">&lt;/<span class="title">select</span>&gt;</span>
    <span class="comment">&lt;!-- 只对 oracle 有效 --&gt;</span>
    <span class="comment">&lt;!-- 重新定义一个 getNow_Oracle的接口 --&gt;</span>
    <span class="tag">&lt;<span class="title">select</span> <span class="attribute">id</span>=<span class="value">"getNow_Oracle"</span> <span class="attribute">resultType</span>=<span class="value">"date"</span>&gt;</span>
        select sysdate from dual
    <span class="tag">&lt;/<span class="title">select</span>&gt;</span>
<span class="tag">&lt;/<span class="title">mapper</span>&gt;</span>
</pre></td></tr></table></figure>

<p>可以用 databaseIdProvider 提供多数据库支持</p>
<h3 id="databaseidprovider-id-">databaseIdProvider(数据库ID提供者)</h3>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="code"><pre><span class="comment">&lt;!-- SqlMapConfig.xml, 定义 databaseIdProvider --&gt;</span>
<span class="tag">&lt;<span class="title">databaseIdProvider</span> <span class="attribute">type</span>=<span class="value">"DB_VENDOR"</span>&gt;</span>
    <span class="tag">&lt;<span class="title">property</span> <span class="attribute">name</span>=<span class="value">"SQL Server"</span> <span class="attribute">value</span>=<span class="value">"sqlserver"</span>/&gt;</span>
    <span class="tag">&lt;<span class="title">property</span> <span class="attribute">name</span>=<span class="value">"DB2"</span> <span class="attribute">value</span>=<span class="value">"db2"</span>/&gt;</span>
    <span class="comment">&lt;!-- oracle的 databaseid 事务 oracle--&gt;</span>
    <span class="tag">&lt;<span class="title">property</span> <span class="attribute">name</span>=<span class="value">"Oracle"</span> <span class="attribute">value</span>=<span class="value">"oracle"</span> /&gt;</span>
    <span class="tag">&lt;<span class="title">property</span> <span class="attribute">name</span>=<span class="value">"MySQL"</span> <span class="attribute">value</span>=<span class="value">"mysql"</span> /&gt;</span>
<span class="tag">&lt;/<span class="title">databaseIdProvider</span>&gt;</span>

<span class="tag">&lt;<span class="title">mapper</span>&gt;</span>
    <span class="comment">&lt;!-- 只对 mysql 有效 --&gt;</span>
    <span class="tag">&lt;<span class="title">select</span> <span class="attribute">databaseid</span>=<span class="value">"mysql"</span> <span class="attribute">id</span>=<span class="value">"getNow"</span> <span class="attribute">resultType</span>=<span class="value">"date"</span>&gt;</span>
        select now()
    <span class="tag">&lt;/<span class="title">select</span>&gt;</span>
    <span class="comment">&lt;!-- 只对 oracle 有效 --&gt;</span>
    <span class="tag">&lt;<span class="title">select</span> <span class="attribute">databaseid</span>=<span class="value">"oracle"</span> <span class="attribute">id</span>=<span class="value">"getNow"</span> <span class="attribute">resultType</span>=<span class="value">"date"</span>&gt;</span>
        select sysdate from dual
    <span class="tag">&lt;/<span class="title">select</span>&gt;</span>
<span class="tag">&lt;/<span class="title">mapper</span>&gt;</span>
</pre></td></tr></table></figure>

<h2 id="-mapper-">指定mapper文件位置</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="code"><pre><span class="comment">&lt;!-- 指定mapper文件的配置 --&gt;</span>
<span class="tag">&lt;<span class="title">mappers</span>&gt;</span>
    <span class="comment">&lt;!-- 使用相对于类路径的资源 --&gt;</span>
    <span class="tag">&lt;<span class="title">mapper</span> <span class="attribute">resource</span>=<span class="value">"sqlmap/user.xml"</span> /&gt;</span>
    
    <span class="comment">&lt;!-- 使用完全限定路径 --&gt;</span>
    <span class="tag">&lt;<span class="title">mapper</span> <span class="attribute">url</span>=<span class="value">"file:///D:\workspace_spingmvc\mybatis_01\config\sqlmap\user.xml"</span> /&gt;</span>
    
    <span class="comment">&lt;!-- 使用mapper接口类路径 --&gt;</span>
    <span class="comment">&lt;!-- 此种方法要求mapper接口名称和mapper映射文件名称相同，且放在同一个目录中 --&gt;</span>
    <span class="tag">&lt;<span class="title">mapper</span> <span class="attribute">class</span>=<span class="value">"cn.itcast.mybatis.mapper.UserMapper"</span>/&gt;</span>
    
    <span class="comment">&lt;!-- 注册指定包下的所有mapper接口 --&gt;</span>
    <span class="comment">&lt;!-- 此种方法要求mapper接口名称和mapper映射文件名称相同，且放在同一个目录中 --&gt;</span>
    <span class="tag">&lt;<span class="title">package</span> <span class="attribute">name</span>=<span class="value">"cn.itcast.mybatis.mapper"</span>/&gt;</span>
<span class="tag">&lt;/<span class="title">mappers</span>&gt;</span>
</pre></td></tr></table></figure>

<h2 id="mapper-xml">Mapper.xml</h2>
<p>输入类型</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="code"><pre><span class="tag">&lt;<span class="title">select</span> <span class="attribute">id</span>=<span class="value">"selectUserById"</span>  <span class="attribute">parameterType</span>=<span class="value">"int"</span> <span class="attribute">resultType</span>=<span class="value">"user"</span>&gt;</span>
    select * from user where id = #{id}
<span class="tag">&lt;/<span class="title">select</span>&gt;</span>

<span class="comment">&lt;!-- ${}只显示内容, 不管类型 --&gt;</span>
<span class="comment">&lt;!-- ${}和#{}不同，${}是将参数值不加修饰的拼在sql中，
     相当中用jdbc的statement拼接sql，使用${}不能防止sql注入，
     但是有时用${}会非常方便 --&gt;</span>
 <span class="comment">&lt;!--${}中只能写value --&gt;</span>
<span class="tag">&lt;<span class="title">select</span> <span class="attribute">id</span>=<span class="value">"selectUserByName"</span>  <span class="attribute">parameterType</span>=<span class="value">"int"</span> <span class="attribute">resultType</span>=<span class="value">"user"</span>&gt;</span>
    select * from user where username like '${value}%'
<span class="tag">&lt;/<span class="title">select</span>&gt;</span>

<span class="comment">&lt;!-- 如果传递的是模型类 ${} 要写属性名  --&gt;</span>
<span class="tag">&lt;<span class="title">select</span> <span class="attribute">id</span>=<span class="value">"selectUserByUser"</span> <span class="attribute">parameterType</span>=<span class="value">"user"</span> <span class="attribute">resultType</span>=<span class="value">"user"</span>&gt;</span>
    select * from user where id=#{id} and username like '%${username}%'
<span class="tag">&lt;/<span class="title">select</span>&gt;</span>

<span class="comment">&lt;!-- 传递hashmap综合查询用户信息 --&gt;</span>
<span class="tag">&lt;<span class="title">select</span> <span class="attribute">id</span>=<span class="value">"selectUserByHashmap"</span> <span class="attribute">parameterType</span>=<span class="value">"hashmap"</span> <span class="attribute">resultType</span>=<span class="value">"user"</span>&gt;</span>
    select * from user where id=#{id} and username like '%${username}%'
<span class="tag">&lt;/<span class="title">select</span>&gt;</span>
</pre></td></tr></table></figure>

<p>输出类型:</p>
<ul>
<li>输出pojo对象和输出pojo列表在sql中定义的resultType是一样的。</li>
<li>返回单个pojo对象要保证sql查询出来的结果集为单条，
使用session.selectOne方法调用，mapper接口使用pojo对象作为方法返回值。</li>
<li>返回pojo列表表示查询出来的结果集可能为多条，
只能使用session.selectList方法调用，
mapper接口使用List<pojo>对象作为方法返回值。</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="code"><pre><span class="comment">&lt;!-- 获取用户信息列表, 返回hashmap --&gt;</span>
<span class="comment">&lt;!-- 输出pojo对象可以改用hashmap输出类型，
     将输出的字段名称作为map的key，value为字段值 --&gt;</span>
<span class="comment">&lt;!-- 输出hashmap类型必须保证sql查询出来的记录为单条 --&gt;</span>
<span class="tag">&lt;<span class="title">select</span> <span class="attribute">id</span>=<span class="value">"selectUserByHashmap"</span> <span class="attribute">parameterType</span>=<span class="value">"user"</span> <span class="attribute">resultType</span>=<span class="value">"hashmap"</span>&gt;</span>
    select * from user where id=#{id} and sex=#{sex}
<span class="tag">&lt;/<span class="title">select</span>&gt;</span>

<span class="comment">&lt;!-- resultMap --&gt;</span>
<span class="comment">&lt;!-- 返回类型 Person{userid:int, name:String, addr:String} --&gt;</span>
<span class="tag">&lt;<span class="title">select</span> <span class="attribute">id</span>=<span class="value">"selectUserByHashmap"</span> <span class="attribute">parameterType</span>=<span class="value">"user"</span> <span class="attribute">resultType</span>=<span class="value">"resultMapPerson"</span>&gt;</span>
    select * from user where id=#{id} and sex=#{sex}
<span class="tag">&lt;/<span class="title">select</span>&gt;</span>

<span class="comment">&lt;!-- 定义rsultMap --&gt;</span>
<span class="tag">&lt;<span class="title">resultMap</span> <span class="attribute">type</span>=<span class="value">"person"</span> <span class="attribute">id</span>=<span class="value">"resultMapPerson"</span>&gt;</span>
    <span class="comment">&lt;!-- 结果集的属性  --&gt;</span>
    <span class="tag">&lt;<span class="title">id</span> <span class="attribute">property</span>=<span class="value">"userid"</span> <span class="attribute">column</span>=<span class="value">"id"</span>&gt;</span><span class="tag">&lt;/<span class="title">id</span>&gt;</span>
    <span class="tag">&lt;<span class="title">result</span> <span class="attribute">property</span>=<span class="value">"name"</span> <span class="attribute">column</span>=<span class="value">"username"</span>&gt;</span><span class="tag">&lt;/<span class="title">result</span>&gt;</span>
    <span class="tag">&lt;<span class="title">result</span> <span class="attribute">property</span>=<span class="value">"addr"</span> <span class="attribute">column</span>=<span class="value">"address"</span>&gt;</span><span class="tag">&lt;/<span class="title">result</span>&gt;</span>
<span class="tag">&lt;/<span class="title">resultMap</span>&gt;</span>
</pre></td></tr></table></figure>

  
	</div>
		<footer class="article-footer clearfix">

  <div class="article-tags">
  
  <span></span> <a href="/tags/传智播客/">传智播客</a><a href="/tags/Mybatis/">Mybatis</a>
  </div>




<div class="article-share" id="share">

  <div data-url="http://zhpooer.github.io/2014/07/15/传智播客day57-mybatis/" data-title="传智播客day57-Mybatis | Poe&#39;s World" data-tsina="null" class="share clearfix">
  </div>

</div>
</footer>   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2014/07/15/scala-in-action-functional-programming-in-scala/" title="Scala in Action-Functional Programming in Scala">
  <strong>PREVIOUS:</strong><br/>
  <span>
  Scala in Action-Functional Programming in Scala</span>
</a>
</div>


<div class="next">
<a href="/2014/07/13/传智播客day56-spring-mvc/"  title="传智播客day56-Spring mvc">
 <strong>NEXT:</strong><br/> 
 <span>传智播客day56-Spring mvc
</span>
</a>
</div>

</nav>

	
<section class="comment">
	<div class="ds-thread"></div>
</section>

</div>  
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">文章目录</strong>
  <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#-"><span class="toc-number">1.</span> <span class="toc-text">概况</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#demo"><span class="toc-number">2.</span> <span class="toc-text">Demo</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#api-"><span class="toc-number">3.</span> <span class="toc-text">API 介绍</span></a></li><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#sqlsessionfactorybuilder"><span class="toc-number">3.1.</span> <span class="toc-text">SqlSessionFactoryBuilder</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sqlsessionfactory"><span class="toc-number">3.2.</span> <span class="toc-text">SqlSessionFactory</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sqlsession"><span class="toc-number">3.3.</span> <span class="toc-text">SqlSession</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#namespace"><span class="toc-number">3.4.</span> <span class="toc-text">Namespace</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mapper-"><span class="toc-number">3.5.</span> <span class="toc-text">Mapper 接口</span></a></li></ol><li class="toc-item toc-level-1"><a class="toc-link" href="#-"><span class="toc-number">4.</span> <span class="toc-text">配置详解</span></a></li><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#properties"><span class="toc-number">4.1.</span> <span class="toc-text">properties</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#settings"><span class="toc-number">4.2.</span> <span class="toc-text">settings</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#-"><span class="toc-number">4.3.</span> <span class="toc-text">别名</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#-"><span class="toc-number">4.4.</span> <span class="toc-text">类型处理器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#environments-"><span class="toc-number">4.5.</span> <span class="toc-text">environments(环境集合属性对象)</span></a></li><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#databaseidprovider-id-"><span class="toc-number">4.5.1.</span> <span class="toc-text">databaseIdProvider(数据库ID提供者)</span></a></li></ol><li class="toc-item toc-level-2"><a class="toc-link" href="#-mapper-"><span class="toc-number">4.6.</span> <span class="toc-text">指定mapper文件位置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mapper-xml"><span class="toc-number">4.7.</span> <span class="toc-text">Mapper.xml</span></a></li></ol>
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  

  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			<li><a href="/tags/AJAX/" title="AJAX">AJAX<sup>1</sup></a></li>
		
			<li><a href="/tags/Akka/" title="Akka">Akka<sup>1</sup></a></li>
		
			<li><a href="/tags/DOM/" title="DOM">DOM<sup>2</sup></a></li>
		
			<li><a href="/tags/EL表达式/" title="EL表达式">EL表达式<sup>1</sup></a></li>
		
			<li><a href="/tags/Hibernate/" title="Hibernate">Hibernate<sup>2</sup></a></li>
		
			<li><a href="/tags/HttpSession/" title="HttpSession">HttpSession<sup>1</sup></a></li>
		
			<li><a href="/tags/IO/" title="IO">IO<sup>1</sup></a></li>
		
			<li><a href="/tags/JSP/" title="JSP">JSP<sup>1</sup></a></li>
		
			<li><a href="/tags/JavaBean/" title="JavaBean">JavaBean<sup>1</sup></a></li>
		
			<li><a href="/tags/JavaScript/" title="JavaScript">JavaScript<sup>1</sup></a></li>
		
			<li><a href="/tags/Mybatis/" title="Mybatis">Mybatis<sup>1</sup></a></li>
		
			<li><a href="/tags/SAX/" title="SAX">SAX<sup>1</sup></a></li>
		
			<li><a href="/tags/ServletRequest/" title="ServletRequest">ServletRequest<sup>1</sup></a></li>
		
			<li><a href="/tags/ServletResponse/" title="ServletResponse">ServletResponse<sup>1</sup></a></li>
		
			<li><a href="/tags/Spring/" title="Spring">Spring<sup>1</sup></a></li>
		
			<li><a href="/tags/Spring MVC/" title="Spring MVC">Spring MVC<sup>1</sup></a></li>
		
			<li><a href="/tags/String/" title="String">String<sup>1</sup></a></li>
		
			<li><a href="/tags/StringBuffer/" title="StringBuffer">StringBuffer<sup>1</sup></a></li>
		
			<li><a href="/tags/activiti/" title="activiti">activiti<sup>2</sup></a></li>
		
			<li><a href="/tags/akka/" title="akka">akka<sup>6</sup></a></li>
		
		</ul>
</div>


  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 订阅</a>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<div class="social-font" class="clearfix">
		
		
		
		
	</div>
		<p class="copyright">Powered by <a href="http://zespia.tw/hexo/" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/A-limon/pacman" target="_blank" title="Pacman">Pacman</a> © 2014 
		
		<a href="http://zhpooer.github.io" target="_blank" title="zhpooer">zhpooer</a>
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.1.0.min.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else
    {
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      h  = $('article h2')
      ah = $('article h2'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  if(ah.length==0){
    t.css('display','none');
  }else{
    c.click(function(){
      ta.css('display', 'block').addClass('fadeIn');
    });
    o.click(function(){
      ta.css('display', 'none');
    });
    $(window).scroll(function(){
      ta.css("top",Math.max(140,320-$(this).scrollTop()));
    });
  };
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina');
  var html = [
  '<a href="#" class="overlay" id="qrcode"></a>',
  '<div class="qrcode clearfix"><span>扫描二维码分享到微信朋友圈</span><a class="qrclose" href="#share"></a><strong>Loading...Please wait</strong><img id="qrcode-pic" data-src="http://s.jiathis.com/qrcode.php?url=' + encodedUrl + '"/></div>',
  '<a href="#textlogo" class="article-back-to-top" title="Top"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="QRcode"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="Weibo"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);
  $('.article-share-qrcode').click(function(){
    var imgSrc = $('#qrcode-pic').attr('data-src');
    $('#qrcode-pic').attr('src', imgSrc);
    $('#qrcode-pic').load(function(){
        $('.qrcode strong').text(' ');
    });
  });
});     
</script>


<script type="text/javascript">
  var duoshuoQuery = {short_name:"zhpoooer"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script> 





  </body>
</html>
