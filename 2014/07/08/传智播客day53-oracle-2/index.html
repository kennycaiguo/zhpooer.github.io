
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  
    <title>传智播客day53-oracle 2 | Poe&#39;s World</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=3, minimum-scale=1">
    
    <meta name="author" content="zhpooer">
    
    <meta name="description" content="子查询
解决不能一步求解的问题
注意问题

括号
合理的书写风格
可以在主查询的 where select from having 后面放子查询
不可以在主查询的 group by后面放置子查询
强调from后面的子查询
主查询和子查询可以不是同一张表, 只要子查询返回结果
一般不在子查询中使用 o">
    
    
    
    
    <link rel="alternative" href="/atom.xml" title="Poe&#39;s World" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/pacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/pacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>

  <body>
    <header>
      <div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.svg" alt="Poe&#39;s World" title="Poe&#39;s World"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="Poe&#39;s World">Poe&#39;s World</a></h1>
				<h2 class="blog-motto">竹杖芒鞋轻胜马，一蓑烟雨任平生</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">主页</a></li>
					
						<li><a href="/english-monthly">英语角</a></li>
					
						<li><a href="/about">关于</a></li>
					
						<li><a href="/archives">归档</a></li>
					
					<li>
					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="text" id="search" name="q" autocomplete="off" maxlength="20" placeholder="搜索" />
						<input type="hidden" name="q" value="site:zhpooer.github.io">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>

    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2014/07/08/传智播客day53-oracle-2/" title="传智播客day53-oracle 2" itemprop="url">传智播客day53-oracle 2</a>
  </h1>
  <p class="article-author">By
    
      <a href="http://zhpooer.github.io" title="zhpooer">zhpooer</a>
    </p>
  <p class="article-time">
    <time datetime="2014-07-08T11:06:52.000Z" itemprop="datePublished">7月 8 2014</time>
    更新日期:<time datetime="2014-07-10T09:05:36.000Z" itemprop="dateModified">7月 10 2014</time>
    
  </p>
</header>
	<div class="article-content">
		
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">文章目录</strong>
		<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#-"><span class="toc-number">1.</span> <span class="toc-text">子查询</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#-"><span class="toc-number">2.</span> <span class="toc-text">集合运算</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#-"><span class="toc-number">3.</span> <span class="toc-text">课堂练习</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#-"><span class="toc-number">4.</span> <span class="toc-text">处理数据</span></a></li><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#insert"><span class="toc-number">4.1.</span> <span class="toc-text">insert</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#update"><span class="toc-number">4.2.</span> <span class="toc-text">update</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#delete-truncate"><span class="toc-number">4.3.</span> <span class="toc-text">delete &amp; truncate</span></a></li></ol><li class="toc-item toc-level-1"><a class="toc-link" href="#oracle-"><span class="toc-number">5.</span> <span class="toc-text">Oracle 中的事务</span></a></li><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#-"><span class="toc-number">5.1.</span> <span class="toc-text">控制事务</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#-"><span class="toc-number">5.2.</span> <span class="toc-text">数据的隔离级别</span></a></li></ol><li class="toc-item toc-level-1"><a class="toc-link" href="#ddl-"><span class="toc-number">6.</span> <span class="toc-text">DDL 语句</span></a></li><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#-"><span class="toc-number">6.1.</span> <span class="toc-text">约束</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#-view-"><span class="toc-number">6.2.</span> <span class="toc-text">视图(view)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#-sequence-"><span class="toc-number">6.3.</span> <span class="toc-text">序列(sequence)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#-index-"><span class="toc-number">6.4.</span> <span class="toc-text">索引(index)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#-"><span class="toc-number">6.5.</span> <span class="toc-text">同义词, 别名</span></a></li></ol><li class="toc-item toc-level-1"><a class="toc-link" href="#-"><span class="toc-number">7.</span> <span class="toc-text">触发器</span></a></li><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#-"><span class="toc-number">7.1.</span> <span class="toc-text">触发器应用</span></a></li></ol><li class="toc-item toc-level-1"><a class="toc-link" href="#-"><span class="toc-number">8.</span> <span class="toc-text">数据字典</span></a></li></ol>
		</div>
		
		<h1 id="-">子查询</h1>
<p>解决不能一步求解的问题</p>
<p>注意问题</p>
<ol>
<li>括号</li>
<li>合理的书写风格</li>
<li>可以在主查询的 where select from having 后面放子查询</li>
<li>不可以在主查询的 group by后面放置子查询</li>
<li>强调from后面的子查询</li>
<li>主查询和子查询可以不是同一张表, 只要子查询返回结果</li>
<li>一般不在子查询中使用 order by, 但在 Top-N 分析问题中使用排序</li>
<li>一般先执行子查询, 在执行主查询；但相关子查询除外</li>
<li>单行子查询只能使用单行操作符, 多行子查询只能使用多行操作符</li>
<li>子查询中的null</li>
</ol>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
</pre></td><td class="code"><pre><span class="operator"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> sal &gt; (<span class="keyword">select</span> sal <span class="keyword">from</span> emp <span class="keyword">where</span> ename=<span class="string">'scott'</span>);</span>

<span class="comment">-- 单行子查询, 只返回一条记录</span>
<span class="operator"><span class="keyword">select</span> ename, sal, (<span class="keyword">select</span> job <span class="keyword">from</span> emp <span class="keyword">where</span> empno=<span class="number">7389</span>) <span class="keyword">from</span> emp;</span>

<span class="comment">-- 强调 from 后面的子查询</span>
<span class="comment">-- 查询员工的姓名和薪水</span>
<span class="operator"><span class="keyword">select</span> * <span class="keyword">from</span> (<span class="keyword">select</span> ename, sal <span class="keyword">from</span> emp);</span>
<span class="comment">-- 查询员工的姓名和薪水,年薪</span>
<span class="operator"><span class="keyword">select</span> * <span class="keyword">from</span> (<span class="keyword">select</span> ename, sal, sal*<span class="number">12</span> annlsal <span class="keyword">from</span> emp);</span>

<span class="comment">-- 6. 主查询和子查询可以不是同一张表, 只要子查询返回结果</span>
<span class="comment">-- 查询部门名称为sales的员工信息</span>
<span class="operator"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> deptno =
    (<span class="keyword">select</span> depton <span class="keyword">from</span> dept <span class="keyword">where</span> dname=<span class="string">'sales'</span>);</span>
<span class="comment">-- 也可以使用多表查询</span>
<span class="comment">-- 优化5: 理论上, 尽量使用多表查询</span>

<span class="comment">-- 9. 单行子查询只能使用单行操作符, 多行子查询只能使用多行操作符</span>
<span class="comment">-- 单行操作符: &gt; = &lt;</span>
<span class="operator"><span class="keyword">select</span> department_id, <span class="aggregate">min</span>(salary)
<span class="keyword">from</span> employees
<span class="keyword">group</span> <span class="keyword">by</span> department_id
<span class="keyword">having</span> <span class="aggregate">min</span>(salary) &gt;
    (<span class="keyword">select</span> <span class="aggregate">min</span>(salary) <span class="keyword">from</span> employees <span class="keyword">where</span> department_id=<span class="number">50</span>);</span>

<span class="comment">-- 多行比较操作: in 在集合中</span>
<span class="comment">-- 查询部门名称是 sales 和 accounting 的员工</span>
<span class="operator"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> deptno <span class="keyword">in</span>
    (<span class="keyword">select</span> deptno <span class="keyword">from</span> dept <span class="keyword">where</span> dname=<span class="string">'sales'</span> <span class="keyword">or</span> dname=<span class="string">'accounting'</span>);</span>
    
<span class="comment">-- any: 在集合中的任意一个值比较</span>
<span class="comment">-- 查询工资比30号部门任意一个员工高的部门( &gt; ( min() ))</span>
<span class="operator"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> sal &gt; <span class="keyword">any</span> (<span class="keyword">select</span> sal <span class="keyword">from</span> emp <span class="keyword">where</span> deptno=<span class="number">30</span>);</span>

<span class="comment">-- all: 和集合的所有值比较</span>
<span class="comment">-- 查询工资比30号部门所有工资高的员工信息( &gt; ( max() ))</span>
<span class="operator"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> sal &gt; <span class="keyword">all</span> (<span class="keyword">select</span> sal <span class="keyword">from</span> emp <span class="keyword">where</span> deptno=<span class="number">30</span>);</span>


<span class="comment">-- 10. 子查询中的null</span>
<span class="comment">-- 多行中的null</span>

<span class="comment">-- 是老板的员工</span>
<span class="operator"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> empno <span class="keyword">in</span> (<span class="keyword">select</span> mgr <span class="keyword">from</span> emp);</span>
<span class="comment">-- 不是老板的员工, not in (10, 20, null)</span>
<span class="comment">-- not in 意思是 不等于 所有, a!=null 永远为假</span>
<span class="comment">-- in 操作符 等同于 any</span>
<span class="operator"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> empno <span class="keyword">not</span> <span class="keyword">in</span> (<span class="keyword">select</span> mgr <span class="keyword">from</span> emp <span class="keyword">where</span> mgr <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span>);</span>
</pre></td></tr></table></figure>

<h1 id="-">集合运算</h1>
<p>操作两个或者多个集合</p>
<ul>
<li>并集: UNION/UNION ALL(相同的部分出现两次)</li>
<li>交集: INTERSECT</li>
<li>差集: MINUS</li>
</ul>
<p>注意问题</p>
<ol>
<li>参与运算的各个集合必须列数相同且类型一致</li>
<li>采用第一个集合的表头作为最后的表头</li>
<li>如果排序, 必须在每个排序后使用相同的 order by</li>
</ol>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="code"><pre><span class="operator"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> deptno=<span class="number">10</span>
<span class="keyword">union</span>
<span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> deptno=<span class="number">20</span>;</span>

<span class="operator"><span class="keyword">select</span> deptno, job, <span class="aggregate">sum</span>(sal) <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> rollup(deptno, job);</span>
<span class="comment">-- 等同于</span>
<span class="operator"><span class="keyword">select</span> deptno, job, <span class="aggregate">sum</span>(sal) <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> deptno, job
<span class="keyword">union</span>
<span class="keyword">select</span> deptno, to_char(<span class="keyword">null</span>), <span class="aggregate">sum</span>(sal) <span class="keyword">group</span> <span class="keyword">by</span> deptno
<span class="keyword">union</span>
<span class="keyword">select</span> to_number(<span class="keyword">null</span>), to_char(<span class="keyword">null</span>), <span class="aggregate">sum</span>(sal) <span class="keyword">from</span> deptno;</span>

break on deptno skip 2;

<span class="comment">-- 优化6, 尽量不要使用集合运算 </span>

<span class="comment">-- 打开记录语句执行时间</span>
<span class="operator"><span class="keyword">set</span> timing <span class="keyword">on</span></span>
</pre></td></tr></table></figure>

<h1 id="-">课堂练习</h1>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
</pre></td><td class="code"><pre><span class="comment">-- rownum 行号, 伪列</span>
<span class="comment">-- 1. 按照默认的顺序生成, 从小到达</span>
<span class="comment">-- 2. rownum 只能使用 &lt;=, &lt;, 不能使用 &gt;, &gt;=, 行号永远从1开始(像是 iterator )</span>
<span class="comment">-- 下面这条语句是错误的!!!!, 行号在 order by 后会乱序</span>
<span class="operator"><span class="keyword">select</span> rownum, empno, ename, sal <span class="keyword">from</span> emp <span class="keyword">where</span> rownum&lt;=<span class="number">3</span> <span class="keyword">order</span> <span class="keyword">by</span> sal <span class="keyword">desc</span>;</span>

<span class="comment">-- 一: 找到员工表中工资最高的前三名, 分页显示可以这样用, 可以把里层的 rownum 取别名</span>
<span class="operator"><span class="keyword">select</span> rownum, empno, ename, sal
     (<span class="keyword">select</span> empno, ename, sal <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> sal <span class="keyword">desc</span>) <span class="keyword">where</span> rownum&lt;=<span class="number">3</span> ;</span>

<span class="comment">-- 二: 找到员工表中薪水大于本部门的薪水员工</span>
<span class="operator"><span class="keyword">select</span> e.empno, e.ename, e.sal, d.avgsal
<span class="keyword">from</span> emp e, (<span class="keyword">select</span> deptno, <span class="aggregate">avg</span>(sal) avgsal <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> deptno) d
<span class="keyword">where</span> e.deptno=d.deptno <span class="keyword">and</span> s.sal&gt;d.avgsal;</span>

<span class="comment">-- 相关子查询, 将主查询中的某个值, 作为参数传递给子查询</span>
<span class="operator"><span class="keyword">select</span> empno, ename, sal, (<span class="keyword">select</span> <span class="aggregate">avg</span>(sal) <span class="keyword">from</span> emp <span class="keyword">where</span> deptno=e.deptno) avgsal
<span class="keyword">from</span> emp e
<span class="keyword">where</span> sal &gt; (<span class="keyword">select</span> <span class="aggregate">avg</span>(sal) <span class="keyword">from</span> emp <span class="keyword">where</span> deptno=e.deptno);</span>

<span class="comment">-- 三, 统计每年入职的员工个数(不使用子查询)</span>

<span class="operator"><span class="keyword">select</span> <span class="aggregate">count</span>(*) Total, <span class="aggregate">sum</span>(decode(to_char(hiredate, <span class="string">'RR'</span>), <span class="string">'81'</span>),<span class="number">1</span>,<span class="number">0</span>),
<span class="aggregate">sum</span>(decode(to_char(hiredate, <span class="string">'RR'</span>), <span class="string">'82'</span>),<span class="number">1</span>,<span class="number">0</span>) <span class="keyword">from</span> emp;</span>

<span class="comment">-- 四. 相关子查询</span>


<span class="comment">-- 五 1 =&gt; 1,2,3,4; 1 =&gt;张三, 2=&gt; 李四..; 1 =&gt; 张三, 李四</span>
<span class="comment">-- 组函数 wm_concat</span>
<span class="comment">-- select deptno, wm_concat(ename) names from emp group by deptno;</span>
<span class="operator"><span class="keyword">set</span> linesize <span class="number">200</span>;</span>

<span class="operator"><span class="keyword">select</span> ci_id, wm_concat(stu_name) <span class="keyword">names</span>
<span class="keyword">from</span> (
    <span class="keyword">select</span> ci_id, stu_name
    <span class="keyword">from</span> pm_stu s, pm_ci c
    <span class="keyword">where</span> instr(c.stu_ids, s.stu_id) &gt; <span class="number">0</span>
) <span class="keyword">group</span> <span class="keyword">by</span> ci_id;</span>
</pre></td></tr></table></figure>

<h1 id="-">处理数据</h1>
<p>SQL 的类型</p>
<ol>
<li>DML(数据操作语句) : insert update delete select</li>
<li>DDL(数据定义语句) : create alter drop truncate </li>
<li>DCL(数据控制语言) : grant revoke</li>
</ol>
<h2 id="insert">insert</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td><td class="code"><pre><span class="operator"><span class="keyword">insert</span> <span class="keyword">into</span> emp(empno, ename, sal, dptno) <span class="keyword">values</span> (<span class="number">100</span>, <span class="string">'finance'</span>, <span class="keyword">NULL</span>, <span class="keyword">NULL</span>);</span>

<span class="comment">-- 地址符 &, PreparedStatement</span>
<span class="operator"><span class="keyword">insert</span> <span class="keyword">into</span> emp(empno, ename, sal, deptno) <span class="keyword">values</span> (&empno, &ename, &sal, &deptno);</span>

<span class="operator"><span class="keyword">select</span> empno, ename, &t <span class="keyword">from</span> emp;</span>

<span class="operator"><span class="keyword">select</span> * <span class="keyword">from</span> &t;</span>

<span class="comment">-- 批处理</span>
<span class="operator"><span class="keyword">create</span> <span class="keyword">table</span> emp10 <span class="keyword">as</span> <span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> <span class="number">1</span>=<span class="number">2</span>;</span>
<span class="comment">-- 一次性将emp中所有10号部门的员工插入到emp10</span>
<span class="comment">-- 将insert中加入子查询</span>
<span class="operator"><span class="keyword">insert</span> <span class="keyword">into</span> emp10
  <span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> deptno=<span class="number">10</span>;</span>

<span class="comment">-- 如果插入海量数据, 如何</span>
<span class="comment">-- 1. 数据bang (data dump)</span>
<span class="comment">-- 2. SQL*LOADER</span>
<span class="comment">-- 3. 外部表(External table)</span>
</pre></td></tr></table></figure>

<h2 id="update">update</h2>
<h2 id="delete-truncate">delete &amp; truncate</h2>
<p>delete和truncate区别</p>
<ol>
<li>delete 逐条删除; truncate先摧毁表, 再重建</li>
<li>delete是DML(可以回滚), truncate是DDL(不可以回滚)</li>
<li>delete不会释放空间, truncate 会</li>
<li>delete会产生碎片, truncate不会; 碎片会影响查询数据<pre><code> 去掉碎片
 1. alter table &lt;表名&gt; move; -- 如果数据庞大, 会消耗大量时间
 2. 数据导入和导出
</code></pre></li>
<li>delete可以闪回(被提交了,反悔), truncate不可以</li>
</ol>
<p>Oracle 中 delete 比 truncate 快</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
</pre></td><td class="code"><pre><span class="comment">-- 导入外部数据</span>
<span class="operator"><span class="keyword">set</span> feedback off;</span> <span class="comment">-- 关闭回显</span>
@d:\test.sql      <span class="comment">-- 导入</span>
<span class="comment">-- 开启运行时间回显</span>
<span class="operator"><span class="keyword">set</span> timing <span class="keyword">on</span>;</span>
</pre></td></tr></table></figure>

<h1 id="oracle-">Oracle 中的事务</h1>
<ol>
<li>起始标志: 该事务中的第一条DML语句</li>
<li>结束标志<pre><code> 提交: 
   1. 显式, commit
   2. 隐式, 正常退出exit或DDL, DCL
 回滚:
   1. 显式, rollback
   2. 隐式, 非正常退出
</code></pre></li>
</ol>
<h2 id="-">控制事务</h2>
<p>保存点(savepoint)</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
</pre></td><td class="code"><pre><span class="operator"><span class="keyword">create</span> <span class="keyword">table</span> testsavepoint
(tid <span class="keyword">number</span>
tname varchar2(<span class="number">20</span>));</span>
<span class="operator"><span class="keyword">set</span> feedback <span class="keyword">on</span>;</span>
<span class="operator"><span class="keyword">insert</span> <span class="keyword">into</span> testsavepoint <span class="keyword">values</span>(<span class="number">1</span>, <span class="string">'tom'</span>);</span>
<span class="operator"><span class="keyword">insert</span> <span class="keyword">into</span> testsavepoint <span class="keyword">values</span>(<span class="number">2</span>, mary<span class="string">');
-- 定义保存点
savepoint a;
-- some operator
rollback to savepoint a;</span></span>
</pre></td></tr></table></figure>

<h2 id="-">数据的隔离级别</h2>
<p>Oracle 只支持四个隔离级别中的两个</p>
<ol>
<li>READ COMMITED, 读已经提交事务</li>
<li>SERIALIZABLE, 串行化</li>
</ol>
<p>额外提供级别: <code>READONLY</code></p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
</pre></td><td class="code"><pre><span class="comment">-- 设置只读</span>
<span class="operator"><span class="keyword">set</span> <span class="keyword">transaction</span> <span class="keyword">read</span> <span class="keyword">only</span>;</span>
</pre></td></tr></table></figure>

<h1 id="ddl-">DDL 语句</h1>
<p>管理数据库的对象</p>
<p>必须条件:</p>
<ol>
<li><code>create table</code> 权限</li>
<li>存储空间</li>
</ol>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
</pre></td><td class="code"><pre><span class="operator"><span class="keyword">create</span> <span class="keyword">table</span> test1(
    tid <span class="keyword">number</span>,
    tname varchar2(<span class="number">20</span>),
    hiredate <span class="keyword">date</span> <span class="keyword">default</span> sysdate
);</span>

<span class="comment">-- rowid 行地址, 伪列, 相当于指针(指向数据)</span>
<span class="operator"><span class="keyword">select</span> rowid, empno, ename <span class="keyword">from</span> emp;</span>

<span class="comment">-- 用子查询创建表</span>
<span class="comment">-- 用一个永远为假的条件创建一个新的空表</span>
<span class="operator"><span class="keyword">create</span> <span class="keyword">table</span> emp10
<span class="keyword">as</span>
<span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> <span class="number">1</span>=<span class="number">2</span>;</span>

<span class="comment">-- 修改表</span>
<span class="comment">-- 追加新列</span>
<span class="operator"><span class="keyword">alter</span> talbe test1 <span class="keyword">add</span> photo blob;</span>
<span class="comment">-- 修改列</span>
<span class="operator"><span class="keyword">alter</span> <span class="keyword">table</span> test1 modify tname varchar2(<span class="number">40</span>);</span>
<span class="comment">-- 删除列</span>
<span class="operator"><span class="keyword">alter</span> <span class="keyword">table</span> test1 <span class="keyword">drop</span> <span class="keyword">column</span> tname;</span>
<span class="comment">-- 重命名列</span>
<span class="operator"><span class="keyword">alter</span> <span class="keyword">table</span> test1 rename <span class="keyword">column</span> tname <span class="keyword">to</span> username;</span>

<span class="comment">-- 重命名表</span>
<span class="operator">rename test1 <span class="keyword">to</span> test2;</span>

<span class="comment">-- 删除表</span>
<span class="operator"><span class="keyword">select</span> * <span class="keyword">from</span> tab;</span>
<span class="operator"><span class="keyword">drop</span> <span class="keyword">table</span> test2;</span>  <span class="comment">-- 并不是真的删除, 只是放到回收站</span>

<span class="comment">-- oracle的回收站</span>
<span class="comment">-- 查看</span>
<span class="operator"><span class="keyword">show</span> recyclebin;</span>
<span class="comment">-- 清空</span>
purge recyclebin;

<span class="comment">-- 不是每个用户都由回收站, 管理员没有回收站</span>

<span class="comment">-- 以管理员方式登陆</span>
<span class="comment">-- 以密码认证登陆</span>
sqlpus sys/password as sysdba;
<span class="comment">-- 主机认证登陆</span>
sqlplus / as sysdba
</pre></td></tr></table></figure>

<h2 id="-">约束</h2>
<p>类型</p>
<ul>
<li><p>CHECK, 检查性约束</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
</pre></td><td class="code"><pre><span class="operator"><span class="keyword">create</span> <span class="keyword">table</span> test3 (
tid <span class="keyword">number</span>,
tname varchar2(<span class="number">20</span>),
-- 给约束起名字
gender varchar2(<span class="number">2</span>)
    <span class="keyword">constraint</span> emp_gender 
    <span class="keyword">check</span> (gender <span class="keyword">in</span>(<span class="string">'男'</span>, 女)),
salary <span class="keyword">number</span> <span class="keyword">check</span> (salary &gt; <span class="number">0</span>) 
);</span>
</pre></td></tr></table></figure>
</li>
<li><p>NOT NULL,</p>
</li>
<li>UNIQUE,</li>
<li>PRIMARY KEY,</li>
<li>FOREIGN KEY, 主表的外键必须是附表的主键<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
</pre></td><td class="code"><pre>on <span class="operator"><span class="keyword">delete</span> <span class="keyword">cascade</span>;</span> 删除父表时, 级联删除子表记录
on <span class="operator"><span class="keyword">delete</span> <span class="keyword">set</span> <span class="keyword">null</span>;</span> 删除父表时, 相关外键记录设子为 null
</pre></td></tr></table></figure>

</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
</pre></td><td class="code"><pre><span class="operator"><span class="keyword">create</span> <span class="keyword">table</span> student(
    sid <span class="keyword">number</span> <span class="keyword">constraint</span> student_PK <span class="keyword">primary</span> <span class="keyword">key</span>,
    sname varchar2(<span class="number">20</span>) <span class="keyword">constraint</span> studnet_namenotnull <span class="keyword">not</span> <span class="keyword">null</span>,
    gender varcher2(<span class="number">2</span>) <span class="keyword">constraint</span> student_gender_check (gender <span class="keyword">in</span>(<span class="string">'男'</span>, <span class="string">'女'</span>)),
    email varchar2(<span class="number">40</span>) <span class="keyword">constraint</span> student_email_unique <span class="keyword">unique</span>
                       <span class="keyword">constraint</span> student_email_notnull <span class="keyword">not</span> <span class="keyword">null</span>,
    deptno <span class="keyword">number</span> <span class="keyword">constraint</span> student_FK refereces dept(deptno) <span class="keyword">on</span> <span class="keyword">delete</span> <span class="keyword">set</span> <span class="keyword">null</span>;</span>
);
<span class="comment">-- 可以把约束和表的创建分开</span>
</pre></td></tr></table></figure>

<h2 id="-view-">视图(view)</h2>
<p>从表中抽出的逻辑上相关的数据集合,
视图是基于表创建, 理解为存储起来的 select 语句,
<em>为了简化复杂查询</em>, 但是不能提高性能</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="code"><pre><span class="comment">-- 需要 create view 权限</span>
<span class="operator"><span class="keyword">grant</span> <span class="keyword">create</span> <span class="keyword">view</span> <span class="keyword">to</span> scott;</span>

<span class="comment">-- 创建视图</span>
<span class="operator"><span class="keyword">create</span> <span class="keyword">view</span> empinfo
<span class="keyword">as</span>
<span class="keyword">select</span> * <span class="keyword">from</span> emp

<span class="keyword">create</span> <span class="keyword">or</span> <span class="keyword">replace</span> <span class="keyword">view</span>  empinfo
<span class="keyword">as</span>
<span class="keyword">select</span> * <span class="keyword">from</span> emp
<span class="keyword">with</span> <span class="keyword">read</span> <span class="keyword">only</span>;</span>

<span class="operator"><span class="keyword">create</span> <span class="keyword">view</span> view10
<span class="keyword">as</span>
<span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> deptno=<span class="number">10</span>
<span class="keyword">with</span> <span class="keyword">check</span> <span class="keyword">option</span>;</span>
<span class="comment">-- with check option 会使下面语句不成功</span>
<span class="operator"><span class="keyword">insert</span> <span class="keyword">into</span> view10 <span class="keyword">values</span>(****, <span class="number">20</span>);</span>

<span class="comment">-- 不建议通过视图对表进行修改</span>
<span class="comment">-- 通过视图修改数据有限制!!!!</span>

<span class="comment">-- 删除视图, 只是删除视图的定义, 不会删除表的数据</span>
<span class="operator"><span class="keyword">drop</span> <span class="keyword">view</span> viewname;</span>
</pre></td></tr></table></figure>

<h2 id="-sequence-">序列(sequence)</h2>
<p>可供多个用户用来产生唯一数值的数据库对象
(内存中的数组,默认长度20), 可以提高访问效率</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="code"><pre><span class="operator"><span class="keyword">create</span> sequence myseq
increment <span class="keyword">by</span> <span class="number">2</span>
<span class="keyword">start</span> <span class="keyword">with</span> <span class="number">2</span>
maxvalue <span class="number">10000</span>
minvalue <span class="number">1</span>
[cycle|nocycle]
[cache <span class="number">20</span> | nocache];</span>

<span class="operator"><span class="keyword">create</span> sequence myseql increment <span class="keyword">by</span> <span class="number">5</span> nochace;</span>
<span class="operator"><span class="keyword">create</span> <span class="keyword">table</span> testseq(
    tid <span class="keyword">number</span>,
    tname varchar2(<span class="number">20</span>)
);</span>
<span class="comment">-- nextval 必须在 currval 之前</span>
<span class="operator"><span class="keyword">select</span> myseql.nextval <span class="keyword">from</span> dual;</span>
<span class="operator"><span class="keyword">select</span> myseql.currval <span class="keyword">from</span> dual;</span>

<span class="operator"><span class="keyword">insert</span> <span class="keyword">into</span> testseq <span class="keyword">values</span>(myseq.nextval, <span class="string">'aa'</span>);</span>

<span class="comment">-- 修改序列</span>
<span class="comment">-- alter sequence ....;</span>
</pre></td></tr></table></figure>

<p>序列在某些情况下会出现裂缝</p>
<ul>
<li>回滚</li>
<li>系统异常</li>
<li>多个表同时使用同一序列</li>
</ul>
<h2 id="-index-">索引(index)</h2>
<p>通过指针加速查询</p>
<p>Oracle中的索引</p>
<ol>
<li>B树索引, 默认</li>
<li>位图索引</li>
</ol>
<p>什么时候建立索引</p>
<ol>
<li>列中数据值分布范围很广</li>
<li>列经常在where子句或连接条件中出现</li>
<li>表经常被访问且数据量很大</li>
</ol>
<p>不适合建立索引</p>
<ol>
<li>经常更新</li>
<li>表非常小</li>
</ol>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
</pre></td><td class="code"><pre><span class="comment">-- 基于部门号创建索引表, 存储 rowid</span>
<span class="operator"><span class="keyword">create</span> index myindex <span class="keyword">on</span> emp(deptno);</span>

<span class="comment">-- 删除</span>
<span class="operator"><span class="keyword">drop</span> index myindex;</span>
</pre></td></tr></table></figure>

<h2 id="-">同义词, 别名</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="code"><pre><span class="operator"><span class="keyword">select</span> <span class="aggregate">count</span>(*) <span class="keyword">from</span> hr.employees;</span>

<span class="operator"><span class="keyword">grant</span> <span class="keyword">select</span> <span class="keyword">on</span> hr.employees <span class="keyword">to</span> scott;</span>

<span class="comment">-- 为 hr.employees 取别名</span>
<span class="operator"><span class="keyword">grant</span> <span class="keyword">create</span> synonym <span class="keyword">to</span> scott;</span>
<span class="operator"><span class="keyword">create</span> synonym hremp <span class="keyword">for</span> hr.employees;</span>
<span class="comment">-- 共有同义词</span>
<span class="operator"><span class="keyword">create</span> <span class="keyword">public</span> synonym hremp <span class="keyword">for</span> hr.employees;</span>

<span class="operator"><span class="keyword">select</span> * <span class="keyword">from</span> hremp;</span>
</pre></td></tr></table></figure>

<h1 id="-">触发器</h1>
<p>数据库触发器是一个表相关的, 存储的 PL/SQL程序,
每当一个特定你的数据操作语句(Insert, update, delete)在指定的表上发出时,
Oracle 在动地执行触发器中定义的语句序列</p>
<p>触发器可用于:</p>
<ul>
<li>数据确认</li>
<li>实施复杂的安全性检查</li>
<li>做审计(日志), 跟踪表上所作的数据操作等</li>
<li>数据的备份和同步</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="code"><pre><span class="comment">-- 每当插入语句之后, 打印一条语句</span>
<span class="operator"><span class="keyword">create</span> <span class="keyword">or</span> <span class="keyword">replace</span> <span class="keyword">trigger</span> sayNewEmp
<span class="keyword">after</span> <span class="keyword">insert</span> <span class="keyword">on</span> emp
<span class="keyword">declare</span>
<span class="keyword">begin</span>
    dbms_output.put_line(<span class="string">'成功插入语句'</span>);</span>
<span class="operator"><span class="keyword">end</span>;</span>

<span class="operator"><span class="keyword">create</span> [<span class="keyword">or</span> <span class="keyword">replace</span>] <span class="keyword">trigger</span>
{<span class="keyword">before</span> | <span class="keyword">after</span>}
{<span class="keyword">delete</span> | <span class="keyword">insert</span> | <span class="keyword">update</span> [<span class="keyword">of</span> 列名]}
<span class="keyword">on</span> 表名
[<span class="keyword">for</span> <span class="keyword">each</span> <span class="keyword">row</span> [<span class="keyword">when</span> 条件]] -- 开始行级触发器
<span class="keyword">end</span></span>
</pre></td></tr></table></figure>

<p>触发器的类型</p>
<ul>
<li>语句级触发器, 针对的是表</li>
<li>行级触发器, 针对的是行, 提供伪列 :new :old</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre><span class="comment">-- 语句级触发一次</span>
<span class="comment">-- 行级触发器触发n次</span>
<span class="operator"><span class="keyword">insert</span> <span class="keyword">into</span> emp10 <span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> emp=<span class="number">10</span>;</span>
</pre></td></tr></table></figure>

<h2 id="-">触发器应用</h2>
<p>实施复杂安全性检查:
禁止在非工作时间插入新员工</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="code"><pre><span class="comment">-- 周末: to_char(sysdate, 'day') in ('星期六', '星期日')</span>
<span class="comment">-- 上班前,  to_number(to_char(sysdate, 'hh24')) not between 9 and 18;</span>
<span class="operator"><span class="keyword">create</span> <span class="keyword">or</span> <span class="keyword">replace</span> <span class="keyword">trigger</span> securityemp
<span class="keyword">before</span> <span class="keyword">insert</span>
<span class="keyword">on</span> emp
<span class="keyword">begin</span>
    <span class="keyword">if</span> to_char(sysdate, <span class="string">'day'</span>) <span class="keyword">in</span> (<span class="string">'星期六'</span>, <span class="string">'星期日'</span>) <span class="keyword">or</span>
       to_number(to_char(sysdate, <span class="string">'hh24'</span>)) <span class="keyword">not</span> between <span class="number">9</span> <span class="keyword">and</span> <span class="number">18</span> <span class="keyword">then</span>
       -- 错误代码必须在 <span class="number">20000</span> - <span class="number">50000</span>
       raize_application_error(-<span class="number">20001</span>, <span class="string">'不能在非工作时间插入新员工'</span>)
    <span class="keyword">end</span> <span class="keyword">if</span>;</span>
<span class="operator"><span class="keyword">end</span>;</span>
</pre></td></tr></table></figure>

<p>数据确认: 涨后的工资不能少于涨前的工资</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
</pre></td><td class="code"><pre><span class="operator"><span class="keyword">create</span> <span class="keyword">or</span> <span class="keyword">replace</span> <span class="keyword">trigger</span> checksal
<span class="keyword">before</span> <span class="keyword">update</span>
<span class="keyword">on</span> emp
<span class="keyword">for</span> <span class="keyword">each</span> <span class="keyword">row</span> 
<span class="keyword">begin</span>
    <span class="keyword">if</span> :new.sal &lt; :old.sal <span class="keyword">then</span>
        raise_application_error(-<span class="number">20002</span>, <span class="string">' 涨后的工资不能少于涨前的工资'</span>);</span>
    <span class="operator"><span class="keyword">end</span> <span class="keyword">if</span>;</span>
<span class="operator"><span class="keyword">end</span>;</span>
</pre></td></tr></table></figure>

<h1 id="-">数据字典</h1>
<p>需要知道自己的权限, 自己的信息, 数据库本身的信息, 这些信息被放在 数据字典</p>
<ul>
<li>基本表: 描述数据库信息</li>
<li>用户表: 用户自定义信息</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre><span class="operator"><span class="keyword">select</span> * <span class="keyword">from</span> dictionary;</span> <span class="comment">-- 描述基本表的信息</span>

<span class="operator"><span class="keyword">select</span> * <span class="keyword">from</span> user_tables;</span>
</pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>数据字典的命名规则</th>
</tr>
</thead>
<tbody>
<tr>
<td>USER</td>
<td>用户自己的</td>
</tr>
<tr>
<td>ALL</td>
<td>用户可以访问到的</td>
</tr>
<tr>
<td>DBA</td>
<td>管理员视图</td>
</tr>
<tr>
<td>V$</td>
<td>性能相关数据</td>
</tr>
</tbody>
</table>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
</pre></td><td class="code"><pre><span class="comment">-- 加注释</span>
comment on table emp is '这是员工信息表'
<span class="comment">-- 查看注释</span>
<span class="operator"><span class="keyword">select</span> * <span class="keyword">from</span> user_tab_comments <span class="keyword">where</span> table_name=<span class="string">'EMP'</span>;</span>
</pre></td></tr></table></figure>

<!-- 老师号码: 13488899975 -->
  
	</div>
		<footer class="article-footer clearfix">

  <div class="article-tags">
  
  <span></span> <a href="/tags/传智播客/">传智播客</a>
  </div>




<div class="article-share" id="share">

  <div data-url="http://zhpooer.github.io/2014/07/08/传智播客day53-oracle-2/" data-title="传智播客day53-oracle 2 | Poe&#39;s World" data-tsina="null" class="share clearfix">
  </div>

</div>
</footer>   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2014/07/10/传智播客day54-plsql/" title="传智播客day54-PL/SQL">
  <strong>PREVIOUS:</strong><br/>
  <span>
  传智播客day54-PL/SQL</span>
</a>
</div>


<div class="next">
<a href="/2014/07/08/传智播客day52-oracle/"  title="传智播客day52-oracle">
 <strong>NEXT:</strong><br/> 
 <span>传智播客day52-oracle
</span>
</a>
</div>

</nav>

	
<section class="comment">
	<div class="ds-thread"></div>
</section>

</div>  
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">文章目录</strong>
  <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#-"><span class="toc-number">1.</span> <span class="toc-text">子查询</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#-"><span class="toc-number">2.</span> <span class="toc-text">集合运算</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#-"><span class="toc-number">3.</span> <span class="toc-text">课堂练习</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#-"><span class="toc-number">4.</span> <span class="toc-text">处理数据</span></a></li><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#insert"><span class="toc-number">4.1.</span> <span class="toc-text">insert</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#update"><span class="toc-number">4.2.</span> <span class="toc-text">update</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#delete-truncate"><span class="toc-number">4.3.</span> <span class="toc-text">delete &amp; truncate</span></a></li></ol><li class="toc-item toc-level-1"><a class="toc-link" href="#oracle-"><span class="toc-number">5.</span> <span class="toc-text">Oracle 中的事务</span></a></li><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#-"><span class="toc-number">5.1.</span> <span class="toc-text">控制事务</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#-"><span class="toc-number">5.2.</span> <span class="toc-text">数据的隔离级别</span></a></li></ol><li class="toc-item toc-level-1"><a class="toc-link" href="#ddl-"><span class="toc-number">6.</span> <span class="toc-text">DDL 语句</span></a></li><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#-"><span class="toc-number">6.1.</span> <span class="toc-text">约束</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#-view-"><span class="toc-number">6.2.</span> <span class="toc-text">视图(view)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#-sequence-"><span class="toc-number">6.3.</span> <span class="toc-text">序列(sequence)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#-index-"><span class="toc-number">6.4.</span> <span class="toc-text">索引(index)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#-"><span class="toc-number">6.5.</span> <span class="toc-text">同义词, 别名</span></a></li></ol><li class="toc-item toc-level-1"><a class="toc-link" href="#-"><span class="toc-number">7.</span> <span class="toc-text">触发器</span></a></li><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#-"><span class="toc-number">7.1.</span> <span class="toc-text">触发器应用</span></a></li></ol><li class="toc-item toc-level-1"><a class="toc-link" href="#-"><span class="toc-number">8.</span> <span class="toc-text">数据字典</span></a></li></ol>
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  

  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			<li><a href="/tags/AJAX/" title="AJAX">AJAX<sup>1</sup></a></li>
		
			<li><a href="/tags/Akka/" title="Akka">Akka<sup>1</sup></a></li>
		
			<li><a href="/tags/Android/" title="Android">Android<sup>1</sup></a></li>
		
			<li><a href="/tags/DOM/" title="DOM">DOM<sup>2</sup></a></li>
		
			<li><a href="/tags/EL表达式/" title="EL表达式">EL表达式<sup>1</sup></a></li>
		
			<li><a href="/tags/HBase/" title="HBase">HBase<sup>1</sup></a></li>
		
			<li><a href="/tags/Hadoop/" title="Hadoop">Hadoop<sup>1</sup></a></li>
		
			<li><a href="/tags/Hibernate/" title="Hibernate">Hibernate<sup>2</sup></a></li>
		
			<li><a href="/tags/HttpSession/" title="HttpSession">HttpSession<sup>1</sup></a></li>
		
			<li><a href="/tags/IO/" title="IO">IO<sup>1</sup></a></li>
		
			<li><a href="/tags/Illustrator/" title="Illustrator">Illustrator<sup>3</sup></a></li>
		
			<li><a href="/tags/JSP/" title="JSP">JSP<sup>1</sup></a></li>
		
			<li><a href="/tags/JavaBean/" title="JavaBean">JavaBean<sup>1</sup></a></li>
		
			<li><a href="/tags/JavaScript/" title="JavaScript">JavaScript<sup>1</sup></a></li>
		
			<li><a href="/tags/Mybatis/" title="Mybatis">Mybatis<sup>1</sup></a></li>
		
			<li><a href="/tags/NoSql/" title="NoSql">NoSql<sup>1</sup></a></li>
		
			<li><a href="/tags/SASS/" title="SASS">SASS<sup>1</sup></a></li>
		
			<li><a href="/tags/SAX/" title="SAX">SAX<sup>1</sup></a></li>
		
			<li><a href="/tags/ServletRequest/" title="ServletRequest">ServletRequest<sup>1</sup></a></li>
		
			<li><a href="/tags/ServletResponse/" title="ServletResponse">ServletResponse<sup>1</sup></a></li>
		
		</ul>
</div>


  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 订阅</a>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<div class="social-font" class="clearfix">
		
		
		
		
	</div>
		<p class="copyright">Powered by <a href="http://zespia.tw/hexo/" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/A-limon/pacman" target="_blank" title="Pacman">Pacman</a> © 2014 
		
		<a href="http://zhpooer.github.io" target="_blank" title="zhpooer">zhpooer</a>
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.1.0.min.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else
    {
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      h  = $('article h2')
      ah = $('article h2'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  if(ah.length==0){
    t.css('display','none');
  }else{
    c.click(function(){
      ta.css('display', 'block').addClass('fadeIn');
    });
    o.click(function(){
      ta.css('display', 'none');
    });
    $(window).scroll(function(){
      ta.css("top",Math.max(140,320-$(this).scrollTop()));
    });
  };
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina');
  var html = [
  '<a href="#" class="overlay" id="qrcode"></a>',
  '<div class="qrcode clearfix"><span>扫描二维码分享到微信朋友圈</span><a class="qrclose" href="#share"></a><strong>Loading...Please wait</strong><img id="qrcode-pic" data-src="http://s.jiathis.com/qrcode.php?url=' + encodedUrl + '"/></div>',
  '<a href="#textlogo" class="article-back-to-top" title="Top"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="QRcode"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="Weibo"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);
  $('.article-share-qrcode').click(function(){
    var imgSrc = $('#qrcode-pic').attr('data-src');
    $('#qrcode-pic').attr('src', imgSrc);
    $('#qrcode-pic').load(function(){
        $('.qrcode strong').text(' ');
    });
  });
});     
</script>


<script type="text/javascript">
  var duoshuoQuery = {short_name:"zhpoooer"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script> 





  </body>
</html>
