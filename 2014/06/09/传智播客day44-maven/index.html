
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  
    <title>传智播客day44-maven | Poe&#39;s World</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=3, minimum-scale=1">
    
    <meta name="author" content="zhpooer">
    
    <meta name="description" content="Maven技术简介
项目管理工具, 包含一个项目对象模型(Project Object Model), 一组标准集合,
一个项目生命周期(Lifecycle), 一个依赖管理系统(Dependency Managerment)
和用来运行定义在色和那个吗周期阶段(Phase)中的插件(Plugin)">
    
    
    
    
    <link rel="alternative" href="/atom.xml" title="Poe&#39;s World" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/pacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/pacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>

  <body>
    <header>
      <div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.svg" alt="Poe&#39;s World" title="Poe&#39;s World"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="Poe&#39;s World">Poe&#39;s World</a></h1>
				<h2 class="blog-motto">竹杖芒鞋轻胜马，一蓑烟雨任平生</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">主页</a></li>
					
						<li><a href="/english-monthly">英语角</a></li>
					
						<li><a href="/about">关于</a></li>
					
						<li><a href="/archives">归档</a></li>
					
					<li>
					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="text" id="search" name="q" autocomplete="off" maxlength="20" placeholder="搜索" />
						<input type="hidden" name="q" value="site:zhpooer.github.io">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>

    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2014/06/09/传智播客day44-maven/" title="传智播客day44-maven" itemprop="url">传智播客day44-maven</a>
  </h1>
  <p class="article-author">By
    
      <a href="http://zhpooer.github.io" title="zhpooer">zhpooer</a>
    </p>
  <p class="article-time">
    <time datetime="2014-06-09T01:04:08.000Z" itemprop="datePublished">6月 9 2014</time>
    更新日期:<time datetime="2014-06-10T12:31:22.000Z" itemprop="dateModified">6月 10 2014</time>
    
  </p>
</header>
	<div class="article-content">
		
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">文章目录</strong>
		<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#maven-"><span class="toc-number">1.</span> <span class="toc-text">Maven技术简介</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#maven-"><span class="toc-number">2.</span> <span class="toc-text">maven快速入门</span></a></li><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#-"><span class="toc-number">2.1.</span> <span class="toc-text">安装配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#-"><span class="toc-number">2.2.</span> <span class="toc-text">常用命令</span></a></li><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#-"><span class="toc-number">2.2.1.</span> <span class="toc-text">转换其他工程项目</span></a></li></ol></ol><li class="toc-item toc-level-1"><a class="toc-link" href="#eclipse-maven-"><span class="toc-number">3.</span> <span class="toc-text">Eclipse基于maven构建</span></a></li><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#-web-"><span class="toc-number">3.1.</span> <span class="toc-text">建立web项目</span></a></li></ol><li class="toc-item toc-level-1"><a class="toc-link" href="#maven-"><span class="toc-number">4.</span> <span class="toc-text">maven 配置详解</span></a></li><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#-"><span class="toc-number">4.1.</span> <span class="toc-text">仓库</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pom-"><span class="toc-number">4.2.</span> <span class="toc-text">POM 配置详解</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#-"><span class="toc-number">4.3.</span> <span class="toc-text">构建依赖</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#-"><span class="toc-number">4.4.</span> <span class="toc-text">传递性依赖</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#-"><span class="toc-number">4.5.</span> <span class="toc-text">统一维护版本</span></a></li></ol><li class="toc-item toc-level-1"><a class="toc-link" href="#-maven"><span class="toc-number">5.</span> <span class="toc-text">重构maven</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#-"><span class="toc-number">6.</span> <span class="toc-text">多模块和继承</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#-"><span class="toc-number">7.</span> <span class="toc-text">生命周期和插件使用</span></a></li><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#-"><span class="toc-number">7.1.</span> <span class="toc-text">插件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#profile-"><span class="toc-number">7.2.</span> <span class="toc-text">profile 使用</span></a></li></ol><li class="toc-item toc-level-1"><a class="toc-link" href="#maven-nexus-"><span class="toc-number">8.</span> <span class="toc-text">maven的私服(Nexus)搭建</span></a></li><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#-"><span class="toc-number">8.1.</span> <span class="toc-text">私服安装后配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#-"><span class="toc-number">8.2.</span> <span class="toc-text">将本地项目发布到私服</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#-"><span class="toc-number">8.3.</span> <span class="toc-text">从私服下载文件</span></a></li></ol>
		</div>
		
		<h1 id="maven-">Maven技术简介</h1>
<p>项目管理工具, 包含一个项目对象模型(Project Object Model), 一组标准集合,
一个项目生命周期(Lifecycle), 一个依赖管理系统(Dependency Managerment)
和用来运行定义在色和那个吗周期阶段(Phase)中的插件(Plugin)目标(goal)的逻辑</p>
<ul>
<li>Pom 项目管理周期</li>
<li>标准集合</li>
<li>项目生命周期</li>
<li>依赖管理系统</li>
<li>插件</li>
</ul>
<p>开发思想: 约定优于配置</p>
<p>针对Java开发项目管理工具, 提供构建工具所提供功能的超集, 除了构建功能之外,
Maven还可以管理项目结构, 管理依赖关系</p>
<p>maven管理项目: 清理, 编译, 测试, 报告, 打包, 部署, 清理</p>
<h1 id="maven-">maven快速入门</h1>
<p>目录结构</p>
<ul>
<li><code>bin</code> 提供mvn命令</li>
<li><code>conf/setting.xml</code>, 提供核心配置文件</li>
</ul>
<h2 id="-">安装配置</h2>
<p>仓库, 用来管理打包后的项目</p>
<p>修改 <code>conf/settings.xml</code>, 配置maven</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
</pre></td><td class="code"><pre><span class="comment">&lt;!-- 自定义本地仓库位置 --&gt;</span>
<span class="tag">&lt;<span class="title">localRepository</span>&gt;</span> <span class="tag">&lt;/<span class="title">localRepository</span>&gt;</span>
</pre></td></tr></table></figure>

<p>名词解释</p>
<table>
<thead>
<tr>
<th>名词</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>Project</td>
<td>何您想build的事物，Maven都可以认为它们是工程。这些工程被定义为工程对象模型(POM，Poject Object Model)</td>
</tr>
<tr>
<td>Pom</td>
<td>它是指示Maven如何工作的元数据文件,位于每个工程的根目录中</td>
</tr>
<tr>
<td>GroupId</td>
<td>组名(工程名), groupId是一个工程的在全局中唯一的标识符</td>
</tr>
<tr>
<td>ArtifactId</td>
<td>项目名称, artifact 是工程将要产生或需要使用的文件，它可以是jar文件, 每个artifact都由groupId和 artifactId组合的标识符唯一识别</td>
</tr>
<tr>
<td>Dependency</td>
<td>依赖</td>
</tr>
<tr>
<td>plug-in</td>
<td>插件</td>
</tr>
<tr>
<td>Repository</td>
<td>仓库</td>
</tr>
</tbody>
</table>
<figure class="highlight shell"><table><tr><td class="gutter"><pre>1
2
</pre></td><td class="code"><pre><span class="subst">&gt;</span> mvn archetype:create <span class="attribute">-DgroupId</span><span class="subst">=</span><span class="literal">cn</span><span class="built_in">.</span>itcast<span class="built_in">.</span>maven<span class="built_in">.</span>quickstart <span class="subst">\</span>
<span class="attribute">-DaritifactId</span><span class="subst">=</span>simple <span class="attribute">-DarichetypeArtifactId</span><span class="subst">=</span>maven<span class="attribute">-archetype</span><span class="attribute">-quickstart</span>
</pre></td></tr></table></figure>

<p>项目目录结构</p>
<ul>
<li><code>pom.xml</code>, 位于工程根目录, 对项目进行配置</li>
<li><code>src/main/java</code>, 存放项目源码</li>
<li><code>src/test/java</code>, 存放测试源码</li>
</ul>
<h2 id="-">常用命令</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
</pre></td><td class="code"><pre><span class="blockquote">&gt; mvn compile  ;; 编译, 在工程目录生成target目录</span>
<span class="blockquote">&gt; mvn test     ;; 运行测试</span>
<span class="blockquote">&gt; mvn test -Dtest=${classname} ;; 测试运行单个类</span>
<span class="blockquote">&gt; mvn clean    ;; 清除编译的结果, 删除target</span>
<span class="blockquote">&gt; mvn package  ;; 打包</span>
<span class="blockquote">&gt; mvn package –Dmaven.test.skip=true ;; 打包时不执行测试</span>
<span class="blockquote">&gt; mvn install  ;; 打包后, 安装到本地仓库中 ${仓库根目录}/groupid/artifact/version/</span>
<span class="blockquote">&gt; mvn deploy   ;; 发布到本地仓库或服务器(例如Tomcat、Jboss)</span>
</pre></td></tr></table></figure>

<p>生命周期，从上到下执行， 如果执行后面的命令，自动执行之前项目构建步骤</p>
<pre><code>validate
generate-sources
process-sources
generate-resources
process-resources     复制并处理资源文件，至目标目录，准备打包。
compile     编译项目的源代码。
process-classes
generate-test-sources 
process-test-sources
generate-test-resources
process-test-resources     复制并处理资源文件，至目标测试目录。
test-compile     编译测试源代码。
process-test-classes
test     使用合适的单元测试框架运行测试。这些测试代码不会被打包或部署。
prepare-package
package     接受编译好的代码，打包成可发布的格式，如 JAR 。
pre-integration-test
integration-test
post-integration-test
verify
install     将包安装至本地仓库，以让其它项目依赖。
deploy     将最终的包复制到远程的仓库，以让其它开发人员与项目共享。
</code></pre><h3 id="-">转换其他工程项目</h3>
<p>转换Eclipse工程</p>
<blockquote>
<p>mvn eclipse:eclipse<br>mvn eclipse:clean  ;; 清除Eclipse设置信息</p>
</blockquote>
<p>转换成IDEA工程</p>
<blockquote>
<p>mvn idea:idea<br>mvn idea:clean //清除idea设置信息</p>
</blockquote>
<p>显示一个插件的详细信息(configuration, goals等):</p>
<blockquote>
<p>mvn help:describe -Dplugin=pluginName -Ddetail</p>
</blockquote>
<h1 id="eclipse-maven-">Eclipse基于maven构建</h1>
<p>安装 m2eclipse, 更新配置文件, 点击 reindex对仓库中的项目重建索引</p>
<ul>
<li>新建maven项目,选择archetype:maven-archetype-quickstart</li>
</ul>
<h2 id="-web-">建立web项目</h2>
<p>方式一: 选择archetype:maven-archetype-webapp,</p>
<ul>
<li>需要在<code>src</code>下手动建立 <code>src/main/java</code></li>
<li>使用 <code>tomcat-maven-plugin</code>, <code>mvn tomcat:run</code>, 运行tomcat</li>
</ul>
<p>方式二: 跳过骨架选择, 使用默认的骨架, package 设置为 war</p>
<ul>
<li>需要在 <code>src/main/webapp</code> 下建立 WEB-INF/web.xml</li>
<li><p>推荐： 跳过骨架选择方式，生成目录结构最完整</p>
</li>
<li><p><code>src/main/java</code> 存放项目源码</p>
</li>
<li><code>src/main/resources</code> 存放项目配置文件</li>
<li><code>src/test/java</code> 存放测试源码</li>
<li><code>src/test/resources</code> 存放测试配置文件</li>
<li><code>src/main/webapp</code> 存放页面代码 </li>
</ul>
<h1 id="maven-">maven 配置详解</h1>
<h2 id="-">仓库</h2>
<p>maven项目管理, 依赖于三种仓库</p>
<ul>
<li>本地仓库, 根据 settings.xml 配置, 可以缓存网络上的项目, 也可以自己的应用安装到仓库</li>
<li>远程仓库(网络上的仓库), 公司内部搭建服务器(私服)</li>
<li>中心仓库, 当本地项目 依赖其它项目, 而依赖的项目本地没有, 去网络上中央仓库找<ul>
<li>Maven内置了远程公用仓库：<a href="http://repo1.maven.org/maven2" target="_blank">http://repo1.maven.org/maven2</a></li>
<li>这个公共仓库是由Maven自己维护, 里面有大量的常用类库,
并包含了世界上大部分流行的开源项目构件.目前是以java为主.</li>
</ul>
</li>
</ul>
<p>中央仓库是最大网络远程仓库, 里面管理jar包,
也并不是企业开发全部(有些jar包需要到私服下载JBOSS私服、Spring 私服)</p>
<h2 id="pom-">POM 配置详解</h2>
<p>全景图</p>
<ul>
<li>坐标: groupId、artifactId、version</li>
<li>聚合: modules 分模块</li>
<li>继承: parent、 dependencyManagement</li>
<li>依赖: dependences</li>
<li>工程信息： name、description、url</li>
<li>构建配置： properties、 packaging、 build 、reporting</li>
</ul>
<p>用户编写maven项目，自定义 pom.xml 默认继承 &quot;超级POM文件&quot;</p>
<pre><code>自定义POM + 超级POM = 有效POM
</code></pre><figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="code"><pre><span class="tag">&lt;<span class="title">project</span>&gt;</span>
    <span class="comment">&lt;!-- 使用Pom对象版本4.0.0 --&gt;</span>
    <span class="tag">&lt;<span class="title">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="title">modelVersion</span>&gt;</span>
    
    <span class="comment">&lt;!-- 当前项目的坐标, 唯一的锁定项目在仓库中的位置  --&gt;</span>
    <span class="comment">&lt;!-- 如果要寻找项目, 先要获得项目的坐标, 可以是 jar 或 war --&gt;</span>
    <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>io.zhpooer<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span>
    <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>mavendemo3<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span>
    <span class="tag">&lt;<span class="title">version</span>&gt;</span>0.0.1-snapshot<span class="tag">&lt;/<span class="title">version</span>&gt;</span>
    
    <span class="comment">&lt;!-- Maven 构建项目默认提供常见的三种打包项目 --&gt;</span>
    <span class="comment">&lt;!-- * jar包, 简单java项目 --&gt;</span>
    <span class="comment">&lt;!-- * war包, web项目 --&gt;</span>
    <span class="comment">&lt;!-- * pom, 父项目，提供pom被子项目继承  --&gt;</span>
    <span class="tag">&lt;<span class="title">packageing</span>&gt;</span>war<span class="tag">&lt;/<span class="title">packageing</span>&gt;</span>
    
    <span class="comment">&lt;!-- 如果使用tomcat:run 运行项目，访问项目通过 artifactId 属性 --&gt;</span>
    <span class="comment">&lt;!-- 在项目编译打包、安装部署，使用artifactId 属性 --&gt;</span>
    <span class="comment">&lt;!-- name属性用于生成文档  --&gt;</span>
    <span class="tag">&lt;<span class="title">name</span>&gt;</span>demo<span class="tag">&lt;/<span class="title">name</span>&gt;</span>
<span class="tag">&lt;/<span class="title">project</span>&gt;</span>
</pre></td></tr></table></figure>

<h2 id="-">构建依赖</h2>
<p>在一个项目可以在 pom.xml 中 通过 <code>&lt;dependencies&gt;</code> 引入对其它项目的依赖</p>
<pre><code>坐标决定项目在仓库中唯一位置.
通过坐标导入项目, 通过坐标导入jar包.
</code></pre><figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre></td><td class="code"><pre><span class="tag">&lt;<span class="title">dependencies</span>&gt;</span>
    <span class="tag">&lt;<span class="title">dependency</span>&gt;</span>
        <span class="comment">&lt;!-- 坐标： groupId、artifactId、version, 找到jar位置 --&gt;</span>
        <span class="tag">&lt;<span class="title">groupId</span>&gt;</span><span class="tag">&lt;/<span class="title">groupId</span>&gt;</span>
        <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span><span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span>
        <span class="tag">&lt;<span class="title">version</span>&gt;</span><span class="tag">&lt;/<span class="title">version</span>&gt;</span>
        <span class="tag">&lt;<span class="title">classifier</span>&gt;</span><span class="tag">&lt;/<span class="title">classifier</span>&gt;</span>
        
        <span class="comment">&lt;!-- compile:编译范围,默认scope,在classpath中存在 --&gt;</span>
        <span class="comment">&lt;!-- provided:已提供范围,编译需要, 不会被打包, 比如容器提供Servlet API --&gt;</span>
        <span class="comment">&lt;!-- runtime:运行时范围,编译不需要,接口与实现分离 --&gt;</span>
        <span class="comment">&lt;!-- test:测试范围,单元测试环境需要 --&gt;</span>
        <span class="comment">&lt;!-- system:系统范围,自定义构件，指定systemPath --&gt;</span>
        <span class="tag">&lt;<span class="title">scope</span>&gt;</span><span class="tag">&lt;/<span class="title">scope</span>&gt;</span>
        
        <span class="comment">&lt;!-- 导入项目类型：type 默认值 jar  --&gt;</span>
        <span class="tag">&lt;<span class="title">type</span>&gt;</span><span class="tag">&lt;/<span class="title">type</span>&gt;</span>
        <span class="tag">&lt;<span class="title">systemPath</span>&gt;</span><span class="tag">&lt;/<span class="title">systemPath</span>&gt;</span>
        
        <span class="comment">&lt;!-- 标记依赖是否可选, A-&gt;B-&gt;C，那么当A依赖于C时就可以设为可选 --&gt;</span>
        <span class="tag">&lt;<span class="title">optional</span>&gt;</span><span class="tag">&lt;/<span class="title">optional</span>&gt;</span>
        
        <span class="comment">&lt;!-- 排除依赖： exclusions 某些依赖项目不想导入 --&gt;</span>
        <span class="tag">&lt;<span class="title">exclusions</span>&gt;</span>
            <span class="tag">&lt;<span class="title">exclusion</span>&gt;</span>
                <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span> <span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span>
                <span class="tag">&lt;<span class="title">groupId</span>&gt;</span> <span class="tag">&lt;/<span class="title">groupId</span>&gt;</span>
            <span class="tag">&lt;/<span class="title">exclusion</span>&gt;</span>
        <span class="tag">&lt;/<span class="title">exclusions</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">dependency</span>&gt;</span>
<span class="tag">&lt;/<span class="title">dependencies</span>&gt;</span>
</pre></td></tr></table></figure>

<h2 id="-">传递性依赖</h2>
<p>如果两个jar包, 依赖不同版本的jar包, 传递依赖倒置jar版本冲突问题</p>
<ul>
<li>第一原则：路径近者优先原则, x2.0传递给A最近</li>
<li>第二原则：第一声明者优先原则, 当路径相等时，则由POM声明的依赖顺序决定</li>
</ul>
<p>解决方法</p>
<ul>
<li>解决间接依赖最好方式就是直接依赖(直接声明)</li>
<li>锁定版本<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
</pre></td><td class="code"><pre><span class="tag">&lt;<span class="title">dependencyManagement</span>&gt;</span>
    <span class="tag">&lt;<span class="title">dependencies</span>&gt;</span>
        <span class="tag">&lt;<span class="title">dependency</span>&gt;</span>
            <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.apache.struts <span class="tag">&lt;/<span class="title">groupId</span>&gt;</span>
            <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>struts2-core <span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span>
            <span class="tag">&lt;<span class="title">version</span>&gt;</span>${struts2.version} <span class="tag">&lt;/<span class="title">version</span>&gt;</span>
        <span class="tag">&lt;/<span class="title">dependency</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">dependencies</span>&gt;</span>
<span class="tag">&lt;/<span class="title">dependencyManagement</span>&gt;</span>
</pre></td></tr></table></figure>

</li>
</ul>
<h2 id="-">统一维护版本</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="code"><pre><span class="tag">&lt;<span class="title">properties</span>&gt;</span>
    <span class="tag">&lt;<span class="title">spring.version</span>&gt;</span> 3.2.0.RELEASE <span class="tag">&lt;/<span class="title">spring.version</span>&gt;</span>
    <span class="tag">&lt;<span class="title">struts2.version</span>&gt;</span> 2.3.15.2 <span class="tag">&lt;/<span class="title">struts2.version</span>&gt;</span>
<span class="tag">&lt;/<span class="title">properties</span>&gt;</span>
<span class="tag">&lt;<span class="title">dependencies</span>&gt;</span>
    <span class="tag">&lt;<span class="title">dependency</span>&gt;</span>
        <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.apache.struts <span class="tag">&lt;/<span class="title">groupId</span>&gt;</span>
        <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>struts2-core <span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span>
        <span class="tag">&lt;<span class="title">version</span>&gt;</span>${struts2.version} <span class="tag">&lt;/<span class="title">version</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">dependency</span>&gt;</span>
<span class="tag">&lt;/<span class="title">dependencies</span>&gt;</span>
</pre></td></tr></table></figure>

<h1 id="-maven">重构maven</h1>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
</pre></td><td class="code"><pre><span class="tag">&lt;<span class="title">project</span> <span class="attribute">xmlns</span>=<span class="value">"http://maven.apache.org/POM/4.0.0"</span> <span class="attribute">xmlns:xsi</span>=<span class="value">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="attribute">xsi:schemaLocation</span>=<span class="value">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span>
  <span class="tag">&lt;<span class="title">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="title">modelVersion</span>&gt;</span>
  <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>cn.itcast.maven<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span>
  <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>mavenstore<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span>
  <span class="tag">&lt;<span class="title">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="title">version</span>&gt;</span>
  <span class="tag">&lt;<span class="title">packaging</span>&gt;</span>war<span class="tag">&lt;/<span class="title">packaging</span>&gt;</span>
  <span class="tag">&lt;<span class="title">name</span>&gt;</span>mavenstore<span class="tag">&lt;/<span class="title">name</span>&gt;</span>
  <span class="tag">&lt;<span class="title">description</span>&gt;</span>仓库管理系统<span class="tag">&lt;/<span class="title">description</span>&gt;</span>
  <span class="tag">&lt;<span class="title">build</span>&gt;</span>
    <span class="tag">&lt;<span class="title">plugins</span>&gt;</span>
      <span class="tag">&lt;<span class="title">plugin</span>&gt;</span>
        <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>maven-compiler-plugin<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span>
        <span class="tag">&lt;<span class="title">configuration</span>&gt;</span>
          <span class="tag">&lt;<span class="title">source</span>&gt;</span>1.6<span class="tag">&lt;/<span class="title">source</span>&gt;</span>
          <span class="tag">&lt;<span class="title">target</span>&gt;</span>1.6<span class="tag">&lt;/<span class="title">target</span>&gt;</span>
        <span class="tag">&lt;/<span class="title">configuration</span>&gt;</span>
      <span class="tag">&lt;/<span class="title">plugin</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">plugins</span>&gt;</span>
  <span class="tag">&lt;/<span class="title">build</span>&gt;</span>
  <span class="comment">&lt;!-- 统一维护版本 --&gt;</span>
  <span class="tag">&lt;<span class="title">properties</span>&gt;</span>
  	<span class="tag">&lt;<span class="title">spring.version</span>&gt;</span>3.2.0.RELEASE<span class="tag">&lt;/<span class="title">spring.version</span>&gt;</span>
  	<span class="tag">&lt;<span class="title">struts2.version</span>&gt;</span>2.3.15.2<span class="tag">&lt;/<span class="title">struts2.version</span>&gt;</span>
  	<span class="tag">&lt;<span class="title">hibernate.version</span>&gt;</span>3.6.10.Final<span class="tag">&lt;/<span class="title">hibernate.version</span>&gt;</span>
  	<span class="tag">&lt;<span class="title">mysql.version</span>&gt;</span>5.1.6<span class="tag">&lt;/<span class="title">mysql.version</span>&gt;</span>
  	<span class="tag">&lt;<span class="title">ehcache.version</span>&gt;</span>2.6.6<span class="tag">&lt;/<span class="title">ehcache.version</span>&gt;</span>
  	<span class="tag">&lt;<span class="title">c3p0.version</span>&gt;</span>0.9.1.2<span class="tag">&lt;/<span class="title">c3p0.version</span>&gt;</span>
  <span class="tag">&lt;/<span class="title">properties</span>&gt;</span>
  
  <span class="tag">&lt;<span class="title">dependencies</span>&gt;</span>
  	<span class="comment">&lt;!-- spring --&gt;</span>
  	<span class="tag">&lt;<span class="title">dependency</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">version</span>&gt;</span>${spring.version}<span class="tag">&lt;/<span class="title">version</span>&gt;</span>
  	<span class="tag">&lt;/<span class="title">dependency</span>&gt;</span>
  	<span class="tag">&lt;<span class="title">dependency</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>spring-aspects<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">version</span>&gt;</span>${spring.version}<span class="tag">&lt;/<span class="title">version</span>&gt;</span>
  	<span class="tag">&lt;/<span class="title">dependency</span>&gt;</span>
  	<span class="tag">&lt;<span class="title">dependency</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>spring-web<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">version</span>&gt;</span>${spring.version}<span class="tag">&lt;/<span class="title">version</span>&gt;</span>
  	<span class="tag">&lt;/<span class="title">dependency</span>&gt;</span>
  	<span class="tag">&lt;<span class="title">dependency</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>spring-test<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">version</span>&gt;</span>${spring.version}<span class="tag">&lt;/<span class="title">version</span>&gt;</span>
  	<span class="tag">&lt;/<span class="title">dependency</span>&gt;</span>
  	<span class="tag">&lt;<span class="title">dependency</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>spring-orm<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">version</span>&gt;</span>${spring.version}<span class="tag">&lt;/<span class="title">version</span>&gt;</span>
  	<span class="tag">&lt;/<span class="title">dependency</span>&gt;</span>
  	<span class="comment">&lt;!-- hibernate --&gt;</span>
  	<span class="tag">&lt;<span class="title">dependency</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.hibernate<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>hibernate-core<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">version</span>&gt;</span>${hibernate.version}<span class="tag">&lt;/<span class="title">version</span>&gt;</span>
  	<span class="tag">&lt;/<span class="title">dependency</span>&gt;</span>
  	<span class="comment">&lt;!-- struts2 --&gt;</span>
  	<span class="tag">&lt;<span class="title">dependency</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.apache.struts<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>struts2-core<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">version</span>&gt;</span>${struts2.version}<span class="tag">&lt;/<span class="title">version</span>&gt;</span>
  	<span class="tag">&lt;/<span class="title">dependency</span>&gt;</span>
  	<span class="tag">&lt;<span class="title">dependency</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.apache.struts<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>struts2-json-plugin<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">version</span>&gt;</span>${struts2.version}<span class="tag">&lt;/<span class="title">version</span>&gt;</span>
  	<span class="tag">&lt;/<span class="title">dependency</span>&gt;</span>
  	<span class="tag">&lt;<span class="title">dependency</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.apache.struts<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>struts2-spring-plugin<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">version</span>&gt;</span>${struts2.version}<span class="tag">&lt;/<span class="title">version</span>&gt;</span>
  	<span class="tag">&lt;/<span class="title">dependency</span>&gt;</span>
  	<span class="comment">&lt;!-- 日志 --&gt;</span>
  	<span class="tag">&lt;<span class="title">dependency</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>slf4j-log4j12<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">version</span>&gt;</span>1.7.2<span class="tag">&lt;/<span class="title">version</span>&gt;</span>
  	<span class="tag">&lt;/<span class="title">dependency</span>&gt;</span>
  	<span class="comment">&lt;!-- c3p0 --&gt;</span>
  	<span class="tag">&lt;<span class="title">dependency</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">groupId</span>&gt;</span>c3p0<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>c3p0<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">version</span>&gt;</span>${c3p0.version}<span class="tag">&lt;/<span class="title">version</span>&gt;</span>
  	<span class="tag">&lt;/<span class="title">dependency</span>&gt;</span>
  	<span class="comment">&lt;!-- mysql驱动 --&gt;</span>
  	<span class="tag">&lt;<span class="title">dependency</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">version</span>&gt;</span>${mysql.version}<span class="tag">&lt;/<span class="title">version</span>&gt;</span>
  	<span class="tag">&lt;/<span class="title">dependency</span>&gt;</span>
  	<span class="comment">&lt;!-- 缓存 --&gt;</span>
  	<span class="tag">&lt;<span class="title">dependency</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">groupId</span>&gt;</span>net.sf.ehcache<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>ehcache-core<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">version</span>&gt;</span>${ehcache.version}<span class="tag">&lt;/<span class="title">version</span>&gt;</span>
  	<span class="tag">&lt;/<span class="title">dependency</span>&gt;</span>
  	<span class="comment">&lt;!-- servlet jsp --&gt;</span>
  	<span class="tag">&lt;<span class="title">dependency</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>servlet-api<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">version</span>&gt;</span>2.5<span class="tag">&lt;/<span class="title">version</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="title">scope</span>&gt;</span>
  	<span class="tag">&lt;/<span class="title">dependency</span>&gt;</span>
  	<span class="tag">&lt;<span class="title">dependency</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>jsp-api<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">version</span>&gt;</span>2.0<span class="tag">&lt;/<span class="title">version</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="title">scope</span>&gt;</span>
  	<span class="tag">&lt;/<span class="title">dependency</span>&gt;</span>
  	<span class="comment">&lt;!-- junit4 --&gt;</span>
  	<span class="tag">&lt;<span class="title">dependency</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">version</span>&gt;</span>4.9<span class="tag">&lt;/<span class="title">version</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="title">scope</span>&gt;</span>
  	<span class="tag">&lt;/<span class="title">dependency</span>&gt;</span>
  	<span class="comment">&lt;!-- jstl --&gt;</span>
  	<span class="tag">&lt;<span class="title">dependency</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>jstl<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span>
  		<span class="tag">&lt;<span class="title">version</span>&gt;</span>1.2<span class="tag">&lt;/<span class="title">version</span>&gt;</span>
  	<span class="tag">&lt;/<span class="title">dependency</span>&gt;</span>
  <span class="tag">&lt;/<span class="title">dependencies</span>&gt;</span>
<span class="tag">&lt;/<span class="title">project</span>&gt;</span>
</pre></td></tr></table></figure>

<h1 id="-">多模块和继承</h1>
<p>多模块: 定义一组构建模块的聚集,
构建父模块的时候, 会自动构建子模块, 父模块的packaging必须为POM</p>
<p>继承: 复用配置, 子模块可以任意重写父模块的配置</p>
<ol>
<li><p>建立父工厂, 打包方式为 POM</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
</pre></td><td class="code"><pre><span class="comment">&lt;!-- parent.pom --&gt;</span>
<span class="tag">&lt;<span class="title">packaging</span>&gt;</span>pom<span class="tag">&lt;/<span class="title">packaging</span>&gt;</span>
</pre></td></tr></table></figure>
</li>
<li><p>新建两个子模块</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="code"><pre><span class="comment">&lt;!-- child.pom --&gt;</span>
<span class="tag">&lt;<span class="title">parent</span>&gt;</span>
    <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span><span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span>
    <span class="tag">&lt;<span class="title">groupId</span>&gt;</span><span class="tag">&lt;/<span class="title">groupId</span>&gt;</span>
    <span class="tag">&lt;<span class="title">version</span>&gt;</span><span class="tag">&lt;/<span class="title">version</span>&gt;</span>
    <span class="tag">&lt;<span class="title">relativePath</span>&gt;</span>..<span class="tag">&lt;/<span class="title">relativePath</span>&gt;</span>
<span class="tag">&lt;/<span class="title">parent</span>&gt;</span>

<span class="comment">&lt;!-- parent.pom  --&gt;</span>
<span class="comment">&lt;!-- 在父工程中指定子模块 --&gt;</span>
<span class="comment">&lt;!-- 父工程编译同时编译子工程 --&gt;</span>
<span class="tag">&lt;<span class="title">modules</span>&gt;</span>
    <span class="tag">&lt;<span class="title">module</span>&gt;</span>child<span class="tag">&lt;/<span class="title">module</span>&gt;</span>
<span class="tag">&lt;/<span class="title">modules</span>&gt;</span>
<span class="comment">&lt;!-- 父工程引用的包子工程也可以使用 --&gt;</span>
<span class="tag">&lt;<span class="title">dependencies</span>&gt;</span>
    <span class="tag">&lt;<span class="title">dependency</span>&gt;</span> <span class="tag">&lt;/<span class="title">dependency</span>&gt;</span>
<span class="tag">&lt;/<span class="title">dependencies</span>&gt;</span>
</pre></td></tr></table></figure>

</li>
</ol>
<h1 id="-">生命周期和插件使用</h1>
<p>Maven提供三套生命周期</p>
<ul>
<li><code>mvn clean</code> 清理生命周期</li>
<li><code>mvn install</code> 项目构建生命周期</li>
<li><code>mvn site</code> 生成站点生命周期</li>
</ul>
<h2 id="-">插件</h2>
<p>maven本身是一个框架, 三个生命周期每个环节都是依赖插件.</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre></td><td class="code"><pre><span class="tag">&lt;<span class="title">plugins</span>&gt;</span>
<span class="comment">&lt;!-- maven-compiler-plugin 编译插件 --&gt;</span>
<span class="tag">&lt;<span class="title">plugin</span>&gt;</span>
    <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span>
    <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>maven-compiler-plugin<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span>
    <span class="tag">&lt;<span class="title">configuration</span>&gt;</span>
        <span class="tag">&lt;<span class="title">source</span>&gt;</span>1.6<span class="tag">&lt;/<span class="title">source</span>&gt;</span>
        <span class="tag">&lt;<span class="title">target</span>&gt;</span>1.6<span class="tag">&lt;/<span class="title">target</span>&gt;</span>
        <span class="tag">&lt;<span class="title">encoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="title">encoding</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">configuration</span>&gt;</span>
<span class="tag">&lt;/<span class="title">plugin</span>&gt;</span>

<span class="comment">&lt;!-- maven-surefire-plugin 测试插件 --&gt;</span>
<span class="tag">&lt;<span class="title">plugin</span>&gt;</span>
    <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span>
    <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>maven-surefire-plugin<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span>
    <span class="tag">&lt;<span class="title">configuration</span>&gt;</span>
        <span class="comment">&lt;!-- 跳过测试 --&gt;</span>
        <span class="tag">&lt;<span class="title">skip</span>&gt;</span>true<span class="tag">&lt;/<span class="title">skip</span>&gt;</span>
        <span class="tag">&lt;<span class="title">testFailureIgnore</span>&gt;</span>true<span class="tag">&lt;/<span class="title">testFailureIgnore</span>&gt;</span>
        <span class="comment">&lt;!-- 解决中文输出乱码  --&gt;</span>
        <span class="tag">&lt;<span class="title">argline</span>&gt;</span>-Dfile.encoding=UTF-8 <span class="tag">&lt;/<span class="title">argline</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">configuration</span>&gt;</span>
<span class="tag">&lt;/<span class="title">plugin</span>&gt;</span>

<span class="comment">&lt;!-- 使用tomcat:run命令, tomcat插件  --&gt;</span>
<span class="tag">&lt;<span class="title">plugin</span>&gt;</span>
    <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>org.codehaus.mojo<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span>
    <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>tomcat-maven-plugin<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span>
    <span class="tag">&lt;<span class="title">configuration</span>&gt;</span>
        <span class="comment">&lt;!-- 可选，指定端口 --&gt;</span>
        <span class="tag">&lt;<span class="title">port</span>&gt;</span>8080<span class="tag">&lt;/<span class="title">port</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">configuration</span>&gt;</span>
<span class="tag">&lt;/<span class="title">plugin</span>&gt;</span>
<span class="tag">&lt;/<span class="title">plugins</span>&gt;</span>
</pre></td></tr></table></figure>

<h2 id="profile-">profile 使用</h2>
<p>自定义一组配置，在运行时指定，覆盖默认配置</p>
<ol>
<li><p>配置profile</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="code"><pre><span class="tag">&lt;<span class="title">profiles</span>&gt;</span>
    <span class="tag">&lt;<span class="title">profile</span>&gt;</span>
        <span class="tag">&lt;<span class="title">id</span>&gt;</span>dev<span class="tag">&lt;/<span class="title">id</span>&gt;</span>
        <span class="tag">&lt;<span class="title">properties</span>&gt;</span>
            <span class="tag">&lt;<span class="title">jdbc.url</span>&gt;</span>jdbc:mysql:///dev<span class="tag">&lt;/<span class="title">jdbc.url</span>&gt;</span>
        <span class="tag">&lt;/<span class="title">properties</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">profile</span>&gt;</span>
    <span class="tag">&lt;<span class="title">profile</span>&gt;</span>
        <span class="tag">&lt;<span class="title">id</span>&gt;</span>product<span class="tag">&lt;/<span class="title">id</span>&gt;</span>
        <span class="tag">&lt;<span class="title">properties</span>&gt;</span>
            <span class="tag">&lt;<span class="title">jdbc.url</span>&gt;</span>jdbc:mysql:///product<span class="tag">&lt;/<span class="title">jdbc.url</span>&gt;</span>
        <span class="tag">&lt;/<span class="title">properties</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">profile</span>&gt;</span>
<span class="tag">&lt;/<span class="title">profiles</span>&gt;</span>
</pre></td></tr></table></figure>
</li>
<li><p>db.properties</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>jdbc<span class="preprocessor">.url</span>=${jdbc<span class="preprocessor">.url</span>}
</pre></td></tr></table></figure>
</li>
<li><p>在项目构建时, 是pom生效</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
</pre></td><td class="code"><pre><span class="tag">&lt;<span class="title">build</span>&gt;</span>
    <span class="tag">&lt;<span class="title">resources</span>&gt;</span>
        <span class="tag">&lt;<span class="title">resource</span>&gt;</span>
            <span class="tag">&lt;<span class="title">directory</span>&gt;</span>src/main/resources<span class="tag">&lt;/<span class="title">directory</span>&gt;</span>
            <span class="tag">&lt;<span class="title">filtering</span>&gt;</span>true<span class="tag">&lt;/<span class="title">filtering</span>&gt;</span>
        <span class="tag">&lt;/<span class="title">resource</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">resources</span>&gt;</span>
<span class="tag">&lt;/<span class="title">build</span>&gt;</span>
</pre></td></tr></table></figure>
</li>
<li><p>运行</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
</pre></td><td class="code"><pre><span class="blockquote">&gt; mvn -Pdev  ;; 或</span>
<span class="blockquote">&gt; mvn -Pproduct</span>
</pre></td></tr></table></figure>

</li>
</ol>
<h1 id="maven-nexus-">maven的私服(Nexus)搭建</h1>
<p>maven仓库分为三种: 本地仓库, 远程仓库(私服【第三方仓库】、 中央仓库)</p>
<ul>
<li>如果需要项目依赖, 优先从本地仓库下载</li>
<li>如果本地仓库没有项目依赖, 自动去中央仓库下载, 在本地仓库缓存</li>
</ul>
<p>安装nexus</p>
<ul>
<li>下载 <code>nexus.war</code>, 解压到 <code>tomcat/webapp</code>目录</li>
<li>启动tomcat访问, 用<code>user=admin;password=admin123</code>登陆</li>
<li>配置 <code>repository</code>(仓库列表), 具有七个仓库配置, 四种类型<ul>
<li>group(仓库组), 一组仓库， 当使用坐标，按照组内顺序查找 </li>
<li>hosted(宿主), 私服<ul>
<li>Releases: 指公司内部已经发布正式版本的项目</li>
<li>Snapshorts: 指公司内部项目还处于测试版本的项目</li>
<li>3rd party: 私服配置指向第三方仓库, 由其它公司私服</li>
</ul>
</li>
<li>proxy(代理): 通过私服去连接 apache或者 中央仓库</li>
<li>virtual(虚拟): 兼容maven1格式</li>
</ul>
</li>
</ul>
<h2 id="-">私服安装后配置</h2>
<p>在运行私服后, 自动在 <code>$HOME/sonatype-work</code> 目录, 创建私服目录结构</p>
<ul>
<li>设置 <code>downloadRemoteIndex=true</code>, 下载中央库索引</li>
<li><code>sonatype-work/storage/central</code>下放置中央仓库下载的包</li>
</ul>
<h2 id="-">将本地项目发布到私服</h2>
<ol>
<li><p>在本地maven的 <code>settings.xml</code> 配置连接私服用户名和密码,
<code>sonatype-work\nexus\conf\security.xml</code> 提供私服内部用户名和密码</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="code"><pre><span class="comment">&lt;!-- 正式发行仓库账号 --&gt;</span>
<span class="tag">&lt;<span class="title">server</span>&gt;</span> 
    <span class="tag">&lt;<span class="title">id</span>&gt;</span> releases <span class="tag">&lt;/<span class="title">id</span>&gt;</span>
    <span class="tag">&lt;<span class="title">username</span>&gt;</span> admin <span class="tag">&lt;/<span class="title">username</span>&gt;</span>
    <span class="tag">&lt;<span class="title">password</span>&gt;</span> admin123 <span class="tag">&lt;/<span class="title">password</span>&gt;</span>
<span class="tag">&lt;/<span class="title">server</span>&gt;</span>
<span class="comment">&lt;!-- 快照发行仓库账号 --&gt;</span>
<span class="tag">&lt;<span class="title">server</span>&gt;</span> 
    <span class="tag">&lt;<span class="title">id</span>&gt;</span> Snapshots <span class="tag">&lt;/<span class="title">id</span>&gt;</span>
    <span class="tag">&lt;<span class="title">username</span>&gt;</span> admin <span class="tag">&lt;/<span class="title">username</span>&gt;</span>
    <span class="tag">&lt;<span class="title">password</span>&gt;</span> admin123 <span class="tag">&lt;/<span class="title">password</span>&gt;</span>
<span class="tag">&lt;/<span class="title">server</span>&gt;</span>
</pre></td></tr></table></figure>
</li>
<li><p>修改本地pom.xml</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="code"><pre><span class="comment">&lt;!-- 发布到私服 --&gt;</span>
<span class="tag">&lt;<span class="title">distributionManagement</span>&gt;</span>
    <span class="tag">&lt;<span class="title">repository</span>&gt;</span>
        <span class="tag">&lt;<span class="title">id</span>&gt;</span>releases<span class="tag">&lt;/<span class="title">id</span>&gt;</span><span class="comment">&lt;!--此处ID以上页server中的一致--&gt;</span>
        <span class="tag">&lt;<span class="title">name</span>&gt;</span>Internal Releases<span class="tag">&lt;/<span class="title">name</span>&gt;</span>
        <span class="tag">&lt;<span class="title">url</span>&gt;</span>releases仓库地址<span class="tag">&lt;/<span class="title">url</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">repository</span>&gt;</span>
    <span class="tag">&lt;<span class="title">snapshotRepository</span>&gt;</span>
        <span class="tag">&lt;<span class="title">id</span>&gt;</span>Snapshots<span class="tag">&lt;/<span class="title">id</span>&gt;</span><span class="comment">&lt;!--此处ID以上页server中的一致--&gt;</span>
        <span class="tag">&lt;<span class="title">name</span>&gt;</span>Internal Snapshots<span class="tag">&lt;/<span class="title">name</span>&gt;</span>
        <span class="tag">&lt;<span class="title">url</span>&gt;</span>snapshots仓库地址<span class="tag">&lt;/<span class="title">url</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">snapshotRepository</span>&gt;</span>
<span class="tag">&lt;/<span class="title">distributionManagement</span>&gt;</span>
</pre></td></tr></table></figure>
</li>
<li><p>发布, 根据版本自动发布到 snapshot 或 release</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre><span class="blockquote">&gt; mvn deploy</span>
</pre></td></tr></table></figure>

</li>
</ol>
<h2 id="-">从私服下载文件</h2>
<p>默认情况下, 如果本地仓库没有,
去中央仓库找, 不会去私服找, 需要配置去私服下载项目</p>
<ol>
<li><p>配置镜像, setting.xml</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
</pre></td><td class="code"><pre><span class="tag">&lt;<span class="title">mirrors</span>&gt;</span>
    <span class="tag">&lt;<span class="title">mirror</span>&gt;</span>
      	<span class="tag">&lt;<span class="title">id</span>&gt;</span>nexus<span class="tag">&lt;/<span class="title">id</span>&gt;</span>
     	<span class="tag">&lt;<span class="title">mirrorOf</span>&gt;</span>*<span class="tag">&lt;/<span class="title">mirrorOf</span>&gt;</span>
        <span class="tag">&lt;<span class="title">url</span>&gt;</span>内部公共仓库地址<span class="tag">&lt;/<span class="title">url</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">mirror</span>&gt;</span>
<span class="tag">&lt;/<span class="title">mirrors</span>&gt;</span>
</pre></td></tr></table></figure>
</li>
<li><p>激活</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre></td><td class="code"><pre><span class="comment">&lt;!-- setting.xml --&gt;</span>
<span class="tag">&lt;<span class="title">profiles</span>&gt;</span>
    <span class="comment">&lt;!-- id: nexus 和 mirror的id一致 --&gt;</span>
    <span class="tag">&lt;<span class="title">profile</span>&gt;</span>
        <span class="tag">&lt;<span class="title">id</span>&gt;</span>nexus<span class="tag">&lt;/<span class="title">id</span>&gt;</span>
        <span class="tag">&lt;<span class="title">repositories</span>&gt;</span>
            <span class="tag">&lt;<span class="title">repository</span>&gt;</span>
                <span class="tag">&lt;<span class="title">id</span>&gt;</span>central<span class="tag">&lt;/<span class="title">id</span>&gt;</span>
                <span class="tag">&lt;<span class="title">url</span>&gt;</span>http://repo1.maven.org/maven2/<span class="tag">&lt;/<span class="title">url</span>&gt;</span>
                <span class="tag">&lt;<span class="title">releases</span>&gt;</span><span class="tag">&lt;<span class="title">enabled</span>&gt;</span>true<span class="tag">&lt;/<span class="title">enabled</span>&gt;</span><span class="tag">&lt;/<span class="title">releases</span>&gt;</span>
                <span class="tag">&lt;<span class="title">snapshots</span>&gt;</span><span class="tag">&lt;<span class="title">enabled</span>&gt;</span>true<span class="tag">&lt;/<span class="title">enabled</span>&gt;</span><span class="tag">&lt;/<span class="title">snapshots</span>&gt;</span>
            <span class="tag">&lt;/<span class="title">repository</span>&gt;</span>
        <span class="tag">&lt;/<span class="title">repositories</span>&gt;</span>
        <span class="tag">&lt;<span class="title">pluginRepositories</span>&gt;</span>
            <span class="tag">&lt;<span class="title">pluginRepository</span>&gt;</span>
                <span class="tag">&lt;<span class="title">id</span>&gt;</span>central<span class="tag">&lt;/<span class="title">id</span>&gt;</span>
                <span class="tag">&lt;<span class="title">url</span>&gt;</span>http://repo1.maven.org/maven2/<span class="tag">&lt;/<span class="title">url</span>&gt;</span>
                <span class="tag">&lt;<span class="title">releases</span>&gt;</span><span class="tag">&lt;<span class="title">enabled</span>&gt;</span>true<span class="tag">&lt;/<span class="title">enabled</span>&gt;</span><span class="tag">&lt;/<span class="title">releases</span>&gt;</span>
                <span class="tag">&lt;<span class="title">snapshots</span>&gt;</span><span class="tag">&lt;<span class="title">enabled</span>&gt;</span>true<span class="tag">&lt;/<span class="title">enabled</span>&gt;</span><span class="tag">&lt;/<span class="title">snapshots</span>&gt;</span>
            <span class="tag">&lt;/<span class="title">pluginRepository</span>&gt;</span>
        <span class="tag">&lt;/<span class="title">pluginRepositories</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">profile</span>&gt;</span>
<span class="tag">&lt;/<span class="title">profiles</span>&gt;</span>
<span class="comment">&lt;!-- profile要使用, 必须要激活 --&gt;</span>
<span class="tag">&lt;<span class="title">activeProfiles</span>&gt;</span>
    <span class="tag">&lt;<span class="title">activeProfile</span>&gt;</span>nexus<span class="tag">&lt;/<span class="title">activeProfile</span>&gt;</span>
<span class="tag">&lt;/<span class="title">activeProfiles</span>&gt;</span>
</pre></td></tr></table></figure>
</li>
<li><p>使程序更新 settings.xml</p>
</li>
</ol>
  
	</div>
		<footer class="article-footer clearfix">

  <div class="article-tags">
  
  <span></span> <a href="/tags/传智播客/">传智播客</a><a href="/tags/maven/">maven</a>
  </div>




<div class="article-share" id="share">

  <div data-url="http://zhpooer.github.io/2014/06/09/传智播客day44-maven/" data-title="传智播客day44-maven | Poe&#39;s World" data-tsina="null" class="share clearfix">
  </div>

</div>
</footer>   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2014/06/10/传智播客day45-svn/" title="传智播客day45 SVN">
  <strong>PREVIOUS:</strong><br/>
  <span>
  传智播客day45 SVN</span>
</a>
</div>


<div class="next">
<a href="/2014/06/08/scala-thoughtworks培训/"  title="scala thoughtworks培训">
 <strong>NEXT:</strong><br/> 
 <span>scala thoughtworks培训
</span>
</a>
</div>

</nav>

	
<section class="comment">
	<div class="ds-thread"></div>
</section>

</div>  
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">文章目录</strong>
  <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#maven-"><span class="toc-number">1.</span> <span class="toc-text">Maven技术简介</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#maven-"><span class="toc-number">2.</span> <span class="toc-text">maven快速入门</span></a></li><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#-"><span class="toc-number">2.1.</span> <span class="toc-text">安装配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#-"><span class="toc-number">2.2.</span> <span class="toc-text">常用命令</span></a></li><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#-"><span class="toc-number">2.2.1.</span> <span class="toc-text">转换其他工程项目</span></a></li></ol></ol><li class="toc-item toc-level-1"><a class="toc-link" href="#eclipse-maven-"><span class="toc-number">3.</span> <span class="toc-text">Eclipse基于maven构建</span></a></li><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#-web-"><span class="toc-number">3.1.</span> <span class="toc-text">建立web项目</span></a></li></ol><li class="toc-item toc-level-1"><a class="toc-link" href="#maven-"><span class="toc-number">4.</span> <span class="toc-text">maven 配置详解</span></a></li><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#-"><span class="toc-number">4.1.</span> <span class="toc-text">仓库</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pom-"><span class="toc-number">4.2.</span> <span class="toc-text">POM 配置详解</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#-"><span class="toc-number">4.3.</span> <span class="toc-text">构建依赖</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#-"><span class="toc-number">4.4.</span> <span class="toc-text">传递性依赖</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#-"><span class="toc-number">4.5.</span> <span class="toc-text">统一维护版本</span></a></li></ol><li class="toc-item toc-level-1"><a class="toc-link" href="#-maven"><span class="toc-number">5.</span> <span class="toc-text">重构maven</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#-"><span class="toc-number">6.</span> <span class="toc-text">多模块和继承</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#-"><span class="toc-number">7.</span> <span class="toc-text">生命周期和插件使用</span></a></li><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#-"><span class="toc-number">7.1.</span> <span class="toc-text">插件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#profile-"><span class="toc-number">7.2.</span> <span class="toc-text">profile 使用</span></a></li></ol><li class="toc-item toc-level-1"><a class="toc-link" href="#maven-nexus-"><span class="toc-number">8.</span> <span class="toc-text">maven的私服(Nexus)搭建</span></a></li><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#-"><span class="toc-number">8.1.</span> <span class="toc-text">私服安装后配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#-"><span class="toc-number">8.2.</span> <span class="toc-text">将本地项目发布到私服</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#-"><span class="toc-number">8.3.</span> <span class="toc-text">从私服下载文件</span></a></li></ol>
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  

  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			<li><a href="/tags/AJAX/" title="AJAX">AJAX<sup>1</sup></a></li>
		
			<li><a href="/tags/Akka/" title="Akka">Akka<sup>1</sup></a></li>
		
			<li><a href="/tags/Android/" title="Android">Android<sup>1</sup></a></li>
		
			<li><a href="/tags/DOM/" title="DOM">DOM<sup>2</sup></a></li>
		
			<li><a href="/tags/EL表达式/" title="EL表达式">EL表达式<sup>1</sup></a></li>
		
			<li><a href="/tags/HBase/" title="HBase">HBase<sup>1</sup></a></li>
		
			<li><a href="/tags/Hadoop/" title="Hadoop">Hadoop<sup>1</sup></a></li>
		
			<li><a href="/tags/Hibernate/" title="Hibernate">Hibernate<sup>2</sup></a></li>
		
			<li><a href="/tags/HttpSession/" title="HttpSession">HttpSession<sup>1</sup></a></li>
		
			<li><a href="/tags/IO/" title="IO">IO<sup>1</sup></a></li>
		
			<li><a href="/tags/Illustrator/" title="Illustrator">Illustrator<sup>3</sup></a></li>
		
			<li><a href="/tags/JSP/" title="JSP">JSP<sup>1</sup></a></li>
		
			<li><a href="/tags/JavaBean/" title="JavaBean">JavaBean<sup>1</sup></a></li>
		
			<li><a href="/tags/JavaScript/" title="JavaScript">JavaScript<sup>1</sup></a></li>
		
			<li><a href="/tags/Mybatis/" title="Mybatis">Mybatis<sup>1</sup></a></li>
		
			<li><a href="/tags/NoSql/" title="NoSql">NoSql<sup>1</sup></a></li>
		
			<li><a href="/tags/SASS/" title="SASS">SASS<sup>1</sup></a></li>
		
			<li><a href="/tags/SAX/" title="SAX">SAX<sup>1</sup></a></li>
		
			<li><a href="/tags/ServletRequest/" title="ServletRequest">ServletRequest<sup>1</sup></a></li>
		
			<li><a href="/tags/ServletResponse/" title="ServletResponse">ServletResponse<sup>1</sup></a></li>
		
		</ul>
</div>


  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 订阅</a>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<div class="social-font" class="clearfix">
		
		
		
		
	</div>
		<p class="copyright">Powered by <a href="http://zespia.tw/hexo/" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/A-limon/pacman" target="_blank" title="Pacman">Pacman</a> © 2015 
		
		<a href="http://zhpooer.github.io" target="_blank" title="zhpooer">zhpooer</a>
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.1.0.min.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else
    {
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      h  = $('article h2')
      ah = $('article h2'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  if(ah.length==0){
    t.css('display','none');
  }else{
    c.click(function(){
      ta.css('display', 'block').addClass('fadeIn');
    });
    o.click(function(){
      ta.css('display', 'none');
    });
    $(window).scroll(function(){
      ta.css("top",Math.max(140,320-$(this).scrollTop()));
    });
  };
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina');
  var html = [
  '<a href="#" class="overlay" id="qrcode"></a>',
  '<div class="qrcode clearfix"><span>扫描二维码分享到微信朋友圈</span><a class="qrclose" href="#share"></a><strong>Loading...Please wait</strong><img id="qrcode-pic" data-src="http://s.jiathis.com/qrcode.php?url=' + encodedUrl + '"/></div>',
  '<a href="#textlogo" class="article-back-to-top" title="Top"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="QRcode"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="Weibo"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);
  $('.article-share-qrcode').click(function(){
    var imgSrc = $('#qrcode-pic').attr('data-src');
    $('#qrcode-pic').attr('src', imgSrc);
    $('#qrcode-pic').load(function(){
        $('.qrcode strong').text(' ');
    });
  });
});     
</script>


<script type="text/javascript">
  var duoshuoQuery = {short_name:"zhpoooer"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script> 





  </body>
</html>
